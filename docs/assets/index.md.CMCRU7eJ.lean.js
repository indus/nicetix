import{d as bu,a0 as Tt,_ as fu,a1 as _u,p as Zr,v as wu,c as gu,a2 as Cu,j as Oe,G as Jr,k as Qr,a as to,o as yu}from"./chunks/framework.CxEjJP9j.js";/*! Tweakpane 4.0.4 (c) 2016 cocopon, licensed under the MIT license. */function I(n){return n==null}function Ai(n){return n!==null&&typeof n=="object"}function di(n){return n!==null&&typeof n=="object"}function xu(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function ye(n,t){return Array.from(new Set([...Object.keys(n),...Object.keys(t)])).reduce((s,i)=>{const r=n[i],o=t[i];return di(r)&&di(o)?Object.assign(Object.assign({},s),{[i]:ye(r,o)}):Object.assign(Object.assign({},s),{[i]:i in t?o:r})},{})}function Ti(n){return Ai(n)?"target"in n:!1}const Pu={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>`Invalid parameters for '${n.name}'`,nomatchingcontroller:n=>`No matching controller for '${n.key}'`,nomatchingview:n=>`No matching view for '${JSON.stringify(n.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:n=>`Not compatible with  plugin '${n.id}'`,propertynotfound:n=>`Property '${n.name}' not found`,shouldneverhappen:()=>"This error should never happen"};let it=class Ke{static alreadyDisposed(){return new Ke({type:"alreadydisposed"})}static notBindable(){return new Ke({type:"notbindable"})}static notCompatible(t,e){return new Ke({type:"notcompatible",context:{id:`${t}.${e}`}})}static propertyNotFound(t){return new Ke({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new Ke({type:"shouldneverhappen"})}constructor(t){var e;this.message=(e=Pu[t.type](t.context))!==null&&e!==void 0?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}toString(){return this.message}},eo=class Cl{constructor(t,e){this.obj_=t,this.key=e}static isBindable(t){return!(t===null||typeof t!="object"&&typeof t!="function")}read(){return this.obj_[this.key]}write(t){this.obj_[this.key]=t}writeProperty(t,e){const s=this.read();if(!Cl.isBindable(s))throw it.notBindable();if(!(t in s))throw it.propertyNotFound(t);s[t]=e}},Q=class{constructor(){this.observers_={}}on(t,e,s){var i;let r=this.observers_[t];return r||(r=this.observers_[t]=[]),r.push({handler:e,key:(i=s==null?void 0:s.key)!==null&&i!==void 0?i:e}),this}off(t,e){const s=this.observers_[t];return s&&(this.observers_[t]=s.filter(i=>i.key!==e)),this}emit(t,e){const s=this.observers_[t];s&&s.forEach(i=>{i.handler(e)})}},Eu=class{constructor(t,e){var s;this.constraint_=e==null?void 0:e.constraint,this.equals_=(s=e==null?void 0:e.equals)!==null&&s!==void 0?s:(i,r)=>i===r,this.emitter=new Q,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const s=e??{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(t):t,r=this.rawValue_;this.equals_(r,i)&&!s.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:s,previousRawValue:r,rawValue:i,sender:this}))}},ku=class{constructor(t){this.emitter=new Q,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const s=e??{forceEmit:!1,last:!0},i=this.value_;i===t&&!s.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:s,previousRawValue:i,rawValue:this.value_,sender:this}))}},Vu=class{constructor(t){this.emitter=new Q,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=t,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(t){this.emitter.emit("beforechange",Object.assign(Object.assign({},t),{sender:this}))}onValueChange_(t){this.emitter.emit("change",Object.assign(Object.assign({},t),{sender:this}))}};function U(n,t){const e=t==null?void 0:t.constraint,s=t==null?void 0:t.equals;return!e&&!s?new ku(n):new Eu(n,t)}function $u(n){return[new Vu(n),(t,e)=>{n.setRawValue(t,e)}]}let O=class yl{constructor(t){this.emitter=new Q,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",()=>{this.emitter.emit("change",{key:e,sender:this})})}static createCore(t){return Object.keys(t).reduce((s,i)=>Object.assign(s,{[i]:U(t[i])}),{})}static fromObject(t){const e=this.createCore(t);return new yl(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}},Tn=class{constructor(t){this.values=O.fromObject({max:t.max,min:t.min})}constrain(t){const e=this.values.get("max"),s=this.values.get("min");return Math.min(Math.max(t,s),e)}},Su=class{constructor(t){this.values=O.fromObject({max:t.max,min:t.min})}constrain(t){const e=this.values.get("max"),s=this.values.get("min");let i=t;return I(s)||(i=Math.max(i,s)),I(e)||(i=Math.min(i,e)),i}},Lu=class{constructor(t,e=0){this.step=t,this.origin=e}constrain(t){const e=this.origin%this.step,s=Math.round((t-e)/this.step);return e+s*this.step}},Mu=class{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}};const Au={"**":(n,t)=>Math.pow(n,t),"*":(n,t)=>n*t,"/":(n,t)=>n/t,"%":(n,t)=>n%t,"+":(n,t)=>n+t,"-":(n,t)=>n-t,"<<":(n,t)=>n<<t,">>":(n,t)=>n>>t,">>>":(n,t)=>n>>>t,"&":(n,t)=>n&t,"^":(n,t)=>n^t,"|":(n,t)=>n|t};let Tu=class{constructor(t,e,s){this.left=e,this.operator=t,this.right=s}evaluate(){const t=Au[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}};const Ou={"+":n=>n,"-":n=>-n,"~":n=>~n};let Ru=class{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=Ou[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}};function Oi(n){return(t,e)=>{for(let s=0;s<n.length;s++){const i=n[s](t,e);if(i!=="")return i}return""}}function yn(n,t){var e;const s=n.substr(t).match(/^\s+/);return(e=s&&s[0])!==null&&e!==void 0?e:""}function Du(n,t){const e=n.substr(t,1);return e.match(/^[1-9]$/)?e:""}function xn(n,t){var e;const s=n.substr(t).match(/^[0-9]+/);return(e=s&&s[0])!==null&&e!==void 0?e:""}function Bu(n,t){const e=xn(n,t);if(e!=="")return e;const s=n.substr(t,1);if(t+=1,s!=="-"&&s!=="+")return"";const i=xn(n,t);return i===""?"":s+i}function Ri(n,t){const e=n.substr(t,1);if(t+=1,e.toLowerCase()!=="e")return"";const s=Bu(n,t);return s===""?"":e+s}function xl(n,t){const e=n.substr(t,1);if(e==="0")return e;const s=Du(n,t);return t+=s.length,s===""?"":s+xn(n,t)}function Nu(n,t){const e=xl(n,t);if(t+=e.length,e==="")return"";const s=n.substr(t,1);if(t+=s.length,s!==".")return"";const i=xn(n,t);return t+=i.length,e+s+i+Ri(n,t)}function ju(n,t){const e=n.substr(t,1);if(t+=e.length,e!==".")return"";const s=xn(n,t);return t+=s.length,s===""?"":e+s+Ri(n,t)}function Iu(n,t){const e=xl(n,t);return t+=e.length,e===""?"":e+Ri(n,t)}const Fu=Oi([Nu,ju,Iu]);function zu(n,t){var e;const s=n.substr(t).match(/^[01]+/);return(e=s&&s[0])!==null&&e!==void 0?e:""}function Ku(n,t){const e=n.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0b")return"";const s=zu(n,t);return s===""?"":e+s}function Uu(n,t){var e;const s=n.substr(t).match(/^[0-7]+/);return(e=s&&s[0])!==null&&e!==void 0?e:""}function qu(n,t){const e=n.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0o")return"";const s=Uu(n,t);return s===""?"":e+s}function Hu(n,t){var e;const s=n.substr(t).match(/^[0-9a-f]+/i);return(e=s&&s[0])!==null&&e!==void 0?e:""}function Gu(n,t){const e=n.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0x")return"";const s=Hu(n,t);return s===""?"":e+s}const Yu=Oi([Ku,qu,Gu]),Xu=Oi([Yu,Fu]);function Wu(n,t){const e=Xu(n,t);return t+=e.length,e===""?null:{evaluable:new Mu(e),cursor:t}}function Zu(n,t){const e=n.substr(t,1);if(t+=e.length,e!=="(")return null;const s=El(n,t);if(!s)return null;t=s.cursor,t+=yn(n,t).length;const i=n.substr(t,1);return t+=i.length,i!==")"?null:{evaluable:s.evaluable,cursor:t}}function Ju(n,t){var e;return(e=Wu(n,t))!==null&&e!==void 0?e:Zu(n,t)}function Pl(n,t){const e=Ju(n,t);if(e)return e;const s=n.substr(t,1);if(t+=s.length,s!=="+"&&s!=="-"&&s!=="~")return null;const i=Pl(n,t);return i?(t=i.cursor,{cursor:t,evaluable:new Ru(s,i.evaluable)}):null}function Qu(n,t,e){e+=yn(t,e).length;const s=n.filter(i=>t.startsWith(i,e))[0];return s?(e+=s.length,e+=yn(t,e).length,{cursor:e,operator:s}):null}function tp(n,t){return(e,s)=>{const i=n(e,s);if(!i)return null;s=i.cursor;let r=i.evaluable;for(;;){const o=Qu(t,e,s);if(!o)break;s=o.cursor;const l=n(e,s);if(!l)return null;s=l.cursor,r=new Tu(o.operator,r,l.evaluable)}return r?{cursor:s,evaluable:r}:null}}const ep=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,t)=>tp(n,t),Pl);function El(n,t){return t+=yn(n,t).length,ep(n,t)}function np(n){const t=El(n,0);return!t||t.cursor+yn(n,t.cursor).length!==n.length?null:t.evaluable}function Xt(n){var t;const e=np(n);return(t=e==null?void 0:e.evaluate())!==null&&t!==void 0?t:null}function kl(n){if(typeof n=="number")return n;if(typeof n=="string"){const t=Xt(n);if(!I(t))return t}return 0}function sp(n){return String(n)}function dt(n){return t=>t.toFixed(Math.max(Math.min(n,20),0))}function B(n,t,e,s,i){const r=(n-t)/(e-t);return s+r*(i-s)}function no(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function tt(n,t,e){return Math.min(Math.max(n,t),e)}function Vl(n,t){return(n%t+t)%t}function ip(n,t){return I(n.step)?Math.max(no(t),2):no(n.step)}function $l(n){var t;return(t=n.step)!==null&&t!==void 0?t:1}function Sl(n,t){var e;const s=Math.abs((e=n.step)!==null&&e!==void 0?e:t);return s===0?.1:Math.pow(10,Math.floor(Math.log10(s))-1)}function Ll(n,t){return I(n.step)?null:new Lu(n.step,t)}function Ml(n){return!I(n.max)&&!I(n.min)?new Tn({max:n.max,min:n.min}):!I(n.max)||!I(n.min)?new Su({max:n.max,min:n.min}):null}function Al(n,t){var e,s,i;return{formatter:(e=n.format)!==null&&e!==void 0?e:dt(ip(n,t)),keyScale:(s=n.keyScale)!==null&&s!==void 0?s:$l(n),pointerScale:(i=n.pointerScale)!==null&&i!==void 0?i:Sl(n,t)}}function Tl(n){return{format:n.optional.function,keyScale:n.optional.number,max:n.optional.number,min:n.optional.number,pointerScale:n.optional.number,step:n.optional.number}}function Di(n){return{constraint:n.constraint,textProps:O.fromObject(Al(n.params,n.initialValue))}}let $e=class{constructor(t){this.controller=t}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(t){this.controller.viewProps.set("disabled",t)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(t){this.controller.viewProps.set("hidden",t)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(t){return this.controller.importState(t)}exportState(){return this.controller.exportState()}},ws=class{constructor(t){this.target=t}},On=class extends ws{constructor(t,e,s){super(t),this.value=e,this.last=s??!0}},rp=class extends ws{constructor(t,e){super(t),this.expanded=e}},op=class extends ws{constructor(t,e){super(t),this.index=e}};class lp extends ws{constructor(t,e){super(t),this.native=e}}let Pn=class extends $e{constructor(t){super(t),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new Q,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(t){this.controller.labelController.props.set("label",t)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(t){this.controller.tag=t}on(t,e){const s=e.bind(this);return this.emitter_.on(t,i=>{s(i)},{key:e}),this}off(t,e){return this.emitter_.off(t,e),this}refresh(){this.controller.value.fetch()}onValueChange_(t){const e=this.controller.value;this.emitter_.emit("change",new On(this,e.binding.target.read(),t.options.last))}};class ap{constructor(t,e){this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.binding=e,this.value_=t,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_),this.emitter=new Q}get rawValue(){return this.value_.rawValue}set rawValue(t){this.value_.rawValue=t}setRawValue(t,e){this.value_.setRawValue(t,e)}fetch(){this.value_.rawValue=this.binding.read()}push(){this.binding.write(this.value_.rawValue)}onValueBeforeChange_(t){this.emitter.emit("beforechange",Object.assign(Object.assign({},t),{sender:this}))}onValueChange_(t){this.push(),this.emitter.emit("change",Object.assign(Object.assign({},t),{sender:this}))}}function cp(n){if(!("binding"in n))return!1;const t=n.binding;return Ti(t)&&"read"in t&&"write"in t}function up(n,t){const s=Object.keys(t).reduce((i,r)=>{if(i===void 0)return;const o=t[r],l=o(n[r]);return l.succeeded?Object.assign(Object.assign({},i),{[r]:l.value}):void 0},{});return s}function pp(n,t){return n.reduce((e,s)=>{if(e===void 0)return;const i=t(s);if(!(!i.succeeded||i.value===void 0))return[...e,i.value]},[])}function hp(n){return n===null?!1:typeof n=="object"}function It(n){return t=>e=>{if(!t&&e===void 0)return{succeeded:!1,value:void 0};if(t&&e===void 0)return{succeeded:!0,value:void 0};const s=n(e);return s!==void 0?{succeeded:!0,value:s}:{succeeded:!1,value:void 0}}}function so(n){return{custom:t=>It(t)(n),boolean:It(t=>typeof t=="boolean"?t:void 0)(n),number:It(t=>typeof t=="number"?t:void 0)(n),string:It(t=>typeof t=="string"?t:void 0)(n),function:It(t=>typeof t=="function"?t:void 0)(n),constant:t=>It(e=>e===t?t:void 0)(n),raw:It(t=>t)(n),object:t=>It(e=>{if(hp(e))return up(e,t)})(n),array:t=>It(e=>{if(Array.isArray(e))return pp(e,t)})(n)}}const mi={optional:so(!0),required:so(!1)};function G(n,t){const e=t(mi),s=mi.required.object(e)(n);return s.succeeded?s.value:void 0}function vt(n,t,e,s){if(t&&!t(n))return!1;const i=G(n,e);return i?s(i):!1}function bt(n,t){var e;return ye((e=n==null?void 0:n())!==null&&e!==void 0?e:{},t)}function ge(n){return"value"in n}function Ol(n){if(!Ai(n)||!("binding"in n))return!1;const t=n.binding;return Ti(t)}const Rt="http://www.w3.org/2000/svg";function os(n){n.offsetHeight}function dp(n,t){const e=n.style.transition;n.style.transition="none",t(),n.style.transition=e}function Bi(n){return n.ontouchstart!==void 0}function mp(){return globalThis}function vp(){return mp().document}function bp(n){const t=n.ownerDocument.defaultView;return t&&"document"in t?n.getContext("2d",{willReadFrequently:!0}):null}const fp={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function gs(n,t){const e=n.createElementNS(Rt,"svg");return e.innerHTML=fp[t],e}function Rl(n,t,e){n.insertBefore(t,n.children[e])}function Ni(n){n.parentElement&&n.parentElement.removeChild(n)}function Dl(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function _p(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function Bl(n){return n.relatedTarget?n.relatedTarget:"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}function Gt(n,t){n.emitter.on("change",e=>{t(e.rawValue)}),t(n.rawValue)}function Bt(n,t,e){Gt(n.value(t),e)}const wp="tp";function R(n){return(e,s)=>[wp,"-",n,"v",e?`_${e}`:"",s?`-${s}`:""].join("")}const hn=R("lbl");function gp(n,t){const e=n.createDocumentFragment();return t.split(`
`).map(i=>n.createTextNode(i)).forEach((i,r)=>{r>0&&e.appendChild(n.createElement("br")),e.appendChild(i)}),e}let Nl=class{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(hn()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(hn("l")),Bt(e.props,"label",r=>{I(r)?this.element.classList.add(hn(void 0,"nol")):(this.element.classList.remove(hn(void 0,"nol")),_p(s),s.appendChild(gp(t,r)))}),this.element.appendChild(s),this.labelElement=s;const i=t.createElement("div");i.classList.add(hn("v")),this.element.appendChild(i),this.valueElement=i}},jl=class{constructor(t,e){this.props=e.props,this.valueController=e.valueController,this.viewProps=e.valueController.viewProps,this.view=new Nl(t,{props:e.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(t){return vt(t,null,e=>({label:e.optional.string}),e=>(this.props.set("label",e.label),!0))}exportProps(){return bt(null,{label:this.props.get("label")})}};function Cp(){return["veryfirst","first","last","verylast"]}const io=R(""),ro={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};let Cs=class{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",()=>{Cp().forEach(s=>{e.classList.remove(io(void 0,ro[s]))}),this.blade.get("positions").forEach(s=>{e.classList.add(io(void 0,ro[s]))})}),this.viewProps.handleDispose(()=>{Ni(e)})}get parent(){return this.parent_}set parent(t){this.parent_=t,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(t){return vt(t,null,e=>({disabled:e.required.boolean,hidden:e.required.boolean}),e=>(this.viewProps.importState(e),!0))}exportState(){return bt(null,Object.assign({},this.viewProps.exportState()))}},xe=class extends Cs{constructor(t,e){if(e.value!==e.valueController.value)throw it.shouldNeverHappen();const s=e.valueController.viewProps,i=new jl(t,{blade:e.blade,props:e.props,valueController:e.valueController});super(Object.assign(Object.assign({},e),{view:new Nl(t,{props:e.props,viewProps:s}),viewProps:s})),this.labelController=i,this.value=e.value,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}importState(t){return vt(t,e=>{var s,i,r;return super.importState(e)&&this.labelController.importProps(e)&&((r=(i=(s=this.valueController).importProps)===null||i===void 0?void 0:i.call(s,t))!==null&&r!==void 0?r:!0)},e=>({value:e.optional.raw}),e=>(e.value&&(this.value.rawValue=e.value),!0))}exportState(){var t,e,s;return bt(()=>super.exportState(),Object.assign(Object.assign({value:this.value.rawValue},this.labelController.exportProps()),(s=(e=(t=this.valueController).exportProps)===null||e===void 0?void 0:e.call(t))!==null&&s!==void 0?s:{}))}};function oo(n){const t=Object.assign({},n);return delete t.value,t}class Il extends xe{constructor(t,e){super(t,e),this.tag=e.tag}importState(t){return vt(t,e=>super.importState(oo(t)),e=>({tag:e.optional.string}),e=>(this.tag=e.tag,!0))}exportState(){return bt(()=>oo(super.exportState()),{binding:{key:this.value.binding.target.key,value:this.value.binding.target.read()},tag:this.tag})}}function yp(n){return ge(n)&&Ol(n.value)}class xp extends Il{importState(t){return vt(t,e=>super.importState(e),e=>({binding:e.required.object({value:e.required.raw})}),e=>(this.value.binding.inject(e.binding.value),this.value.fetch(),!0))}}function Pp(n){return ge(n)&&cp(n.value)}function Fl(n,t){for(;n.length<t;)n.push(void 0)}function Ep(n){const t=[];return Fl(t,n),t}function kp(n){const t=n.indexOf(void 0);return t<0?n:n.slice(0,t)}function Vp(n,t){const e=[...kp(n),t];return e.length>n.length?e.splice(0,e.length-n.length):Fl(e,n.length),e}class $p{constructor(t){this.emitter=new Q,this.onTick_=this.onTick_.bind(this),this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.binding=t.binding,this.value_=U(Ep(t.bufferSize)),this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_),this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.fetch()}get rawValue(){return this.value_.rawValue}set rawValue(t){this.value_.rawValue=t}setRawValue(t,e){this.value_.setRawValue(t,e)}fetch(){this.value_.rawValue=Vp(this.value_.rawValue,this.binding.read())}onTick_(){this.fetch()}onValueBeforeChange_(t){this.emitter.emit("beforechange",Object.assign(Object.assign({},t),{sender:this}))}onValueChange_(t){this.emitter.emit("change",Object.assign(Object.assign({},t),{sender:this}))}}function Sp(n){if(!("binding"in n))return!1;const t=n.binding;return Ti(t)&&"read"in t&&!("write"in t)}class Lp extends Il{exportState(){return bt(()=>super.exportState(),{binding:{readonly:!0}})}}function Mp(n){return ge(n)&&Sp(n.value)}let Ap=class extends $e{get label(){return this.controller.labelController.props.get("label")}set label(t){this.controller.labelController.props.set("label",t)}get title(){var t;return(t=this.controller.buttonController.props.get("title"))!==null&&t!==void 0?t:""}set title(t){this.controller.buttonController.props.set("title",t)}on(t,e){const s=e.bind(this);return this.controller.buttonController.emitter.on(t,r=>{s(new lp(this,r.nativeEvent))}),this}off(t,e){return this.controller.buttonController.emitter.off(t,e),this}};function Tp(n,t,e){e?n.classList.add(t):n.classList.remove(t)}function Qe(n,t){return e=>{Tp(n,t,e)}}function ji(n,t){Gt(n,e=>{t.textContent=e??""})}const Ds=R("btn");let Op=class{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Ds()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("button");s.classList.add(Ds("b")),e.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;const i=t.createElement("div");i.classList.add(Ds("t")),ji(e.props.value("title"),i),this.buttonElement.appendChild(i)}},Rp=class{constructor(t,e){this.emitter=new Q,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new Op(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(t){return vt(t,null,e=>({title:e.optional.string}),e=>(this.props.set("title",e.title),!0))}exportProps(){return bt(null,{title:this.props.get("title")})}onClick_(t){this.emitter.emit("click",{nativeEvent:t,sender:this})}},lo=class extends Cs{constructor(t,e){const s=new Rp(t,{props:e.buttonProps,viewProps:e.viewProps}),i=new jl(t,{blade:e.blade,props:e.labelProps,valueController:s});super({blade:e.blade,view:i.view,viewProps:e.viewProps}),this.buttonController=s,this.labelController=i}importState(t){return vt(t,e=>super.importState(e)&&this.buttonController.importProps(e)&&this.labelController.importProps(e),()=>({}),()=>!0)}exportState(){return bt(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}},zl=class{constructor(t){const[e,s]=t.split("-"),i=e.split(".");this.major=parseInt(i[0],10),this.minor=parseInt(i[1],10),this.patch=parseInt(i[2],10),this.prerelease=s??null}toString(){const t=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[t,this.prerelease].join("-"):t}};const tn=new zl("2.0.4");function pt(n){return Object.assign({core:tn},n)}const Dp=pt({id:"button",type:"blade",accept(n){const t=G(n,e=>({title:e.required.string,view:e.required.constant("button"),label:e.optional.string}));return t?{params:t}:null},controller(n){return new lo(n.document,{blade:n.blade,buttonProps:O.fromObject({title:n.params.title}),labelProps:O.fromObject({label:n.params.label}),viewProps:n.viewProps})},api(n){return n.controller instanceof lo?new Ap(n.controller):null}});function Bp(n,t){return n.addBlade(Object.assign(Object.assign({},t),{view:"button"}))}function Np(n,t){return n.addBlade(Object.assign(Object.assign({},t),{view:"folder"}))}function jp(n,t){return n.addBlade(Object.assign(Object.assign({},t),{view:"tab"}))}function Ip(n){return Ai(n)?"refresh"in n&&typeof n.refresh=="function":!1}function Fp(n,t){if(!eo.isBindable(n))throw it.notBindable();return new eo(n,t)}let zp=class{constructor(t,e){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=t,this.emitter_=new Q,this.pool_=e,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(t=>this.pool_.createApi(t))}addBinding(t,e,s){const i=s??{},r=this.controller_.element.ownerDocument,o=this.pool_.createBinding(r,Fp(t,e),i),l=this.pool_.createBindingApi(o);return this.add(l,i.index)}addFolder(t){return Np(this,t)}addButton(t){return Bp(this,t)}addTab(t){return jp(this,t)}add(t,e){const s=t.controller;return this.controller_.rack.add(s,e),t}remove(t){this.controller_.rack.remove(t.controller)}addBlade(t){const e=this.controller_.element.ownerDocument,s=this.pool_.createBlade(e,t),i=this.pool_.createApi(s);return this.add(i,t.index)}on(t,e){const s=e.bind(this);return this.emitter_.on(t,i=>{s(i)},{key:e}),this}off(t,e){return this.emitter_.off(t,e),this}refresh(){this.children.forEach(t=>{Ip(t)&&t.refresh()})}onRackValueChange_(t){const e=t.bladeController,s=this.pool_.createApi(e),i=Ol(e.value)?e.value.binding:null;this.emitter_.emit("change",new On(s,i?i.target.read():e.value.rawValue,t.options.last))}},Ii=class extends $e{constructor(t,e){super(t),this.rackApi_=new zp(t.rackController,e)}refresh(){this.rackApi_.refresh()}},Fi=class extends Cs{constructor(t){super({blade:t.blade,view:t.view,viewProps:t.rackController.viewProps}),this.rackController=t.rackController}importState(t){return vt(t,e=>super.importState(e),e=>({children:e.required.array(e.required.raw)}),e=>this.rackController.rack.children.every((s,i)=>s.importState(e.children[i])))}exportState(){return bt(()=>super.exportState(),{children:this.rackController.rack.children.map(t=>t.exportState())})}};function vi(n){return"rackController"in n}let Kp=class{constructor(t){this.emitter=new Q,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=t}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(t){for(const e of this.allItems())if(t(e))return e;return null}includes(t){return this.cache_.has(t)}add(t,e){if(this.includes(t))throw it.shouldNeverHappen();const s=e!==void 0?e:this.items_.length;this.items_.splice(s,0,t),this.cache_.add(t);const i=this.extract_(t);i&&(i.emitter.on("add",this.onSubListAdd_),i.emitter.on("remove",this.onSubListRemove_),i.allItems().forEach(r=>{this.cache_.add(r)})),this.emitter.emit("add",{index:s,item:t,root:this,target:this})}remove(t){const e=this.items_.indexOf(t);if(e<0)return;this.items_.splice(e,1),this.cache_.delete(t);const s=this.extract_(t);s&&(s.allItems().forEach(i=>{this.cache_.delete(i)}),s.emitter.off("add",this.onSubListAdd_),s.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}onSubListAdd_(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})}onSubListRemove_(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})}};function Up(n,t){for(let e=0;e<n.length;e++){const s=n[e];if(ge(s)&&s.value===t)return s}return null}function qp(n){return vi(n)?n.rackController.rack.bcSet_:null}let Hp=class{constructor(t){var e,s;this.emitter=new Q,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(e=t.blade)!==null&&e!==void 0?e:null,(s=this.blade_)===null||s===void 0||s.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=t.viewProps,this.bcSet_=new Kp(qp),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(t,e){var s;(s=t.parent)===null||s===void 0||s.remove(t),t.parent=this,this.bcSet_.add(t,e)}remove(t){t.parent=null,this.bcSet_.remove(t)}find(t){return this.bcSet_.allItems().filter(t)}onSetAdd_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("add",{bladeController:t.item,index:t.index,root:e,sender:this}),!e)return;const s=t.item;if(s.viewProps.emitter.on("change",this.onChildViewPropsChange_),s.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),s.viewProps.handleDispose(this.onChildDispose_),ge(s))s.value.emitter.on("change",this.onChildValueChange_);else if(vi(s)){const i=s.rackController.rack;if(i){const r=i.emitter;r.on("layout",this.onRackLayout_),r.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("remove",{bladeController:t.item,root:e,sender:this}),!e)return;const s=t.item;if(ge(s))s.value.emitter.off("change",this.onChildValueChange_);else if(vi(s)){const i=s.rackController.rack;if(i){const r=i.emitter;r.off("layout",this.onRackLayout_),r.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const t=this.bcSet_.items.filter(i=>!i.viewProps.get("hidden")),e=t[0],s=t[t.length-1];this.bcSet_.items.forEach(i=>{const r=[];i===e&&(r.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&r.push("veryfirst")),i===s&&(r.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&r.push("verylast")),i.blade.set("positions",r)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(e=>e.viewProps.get("disposed")).forEach(e=>{this.bcSet_.remove(e)})}onChildValueChange_(t){const e=Up(this.find(ge),t.sender);if(!e)throw it.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:e,options:t.options,sender:this})}onRackLayout_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(t){this.emitter.emit("valuechange",{bladeController:t.bladeController,options:t.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}},zi=class{constructor(t){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=t.element,this.viewProps=t.viewProps;const e=new Hp({blade:t.root?void 0:t.blade,viewProps:t.viewProps});e.emitter.on("add",this.onRackAdd_),e.emitter.on("remove",this.onRackRemove_),this.rack=e,this.viewProps.handleDispose(()=>{for(let s=this.rack.children.length-1;s>=0;s--)this.rack.children[s].viewProps.set("disposed",!0)})}onRackAdd_(t){t.root&&Rl(this.element,t.bladeController.view.element,t.index)}onRackRemove_(t){t.root&&Ni(t.bladeController.view.element)}};function en(){return new O({positions:U([],{equals:xu})})}let Ki=class Kl extends O{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},s=O.createCore(e);return new Kl(s)}get styleExpanded(){var t;return(t=this.get("temporaryExpanded"))!==null&&t!==void 0?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!I(t)?`${t}px`:"auto"}bindExpandedClass(t,e){const s=()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)};Bt(this,"expanded",s),Bt(this,"temporaryExpanded",s)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}};function Gp(n,t){let e=0;return dp(t,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),os(t),e=t.clientHeight,n.set("temporaryExpanded",null),os(t)}),e}function ao(n,t){t.style.height=n.styleHeight}function Ui(n,t){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),I(n.get("expandedHeight"))){const e=Gp(n,t);e>0&&n.set("expandedHeight",e)}n.set("shouldFixHeight",!0),os(t)}),n.emitter.on("change",()=>{ao(n,t)}),ao(n,t),t.addEventListener("transitionend",e=>{e.propertyName==="height"&&n.cleanUpTransition()})}let Ul=class extends Ii{constructor(t,e){super(t,e),this.emitter_=new Q,this.controller.foldable.value("expanded").emitter.on("change",s=>{this.emitter_.emit("fold",new rp(this,s.sender.rawValue))}),this.rackApi_.on("change",s=>{this.emitter_.emit("change",s)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(t){this.controller.foldable.set("expanded",t)}get title(){return this.controller.props.get("title")}set title(t){this.controller.props.set("title",t)}get children(){return this.rackApi_.children}addBinding(t,e,s){return this.rackApi_.addBinding(t,e,s)}addFolder(t){return this.rackApi_.addFolder(t)}addButton(t){return this.rackApi_.addButton(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){return this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addBlade(t){return this.rackApi_.addBlade(t)}on(t,e){const s=e.bind(this);return this.emitter_.on(t,i=>{s(i)},{key:e}),this}off(t,e){return this.emitter_.off(t,e),this}};const ql=R("cnt");let Yp=class{constructor(t,e){var s;this.className_=R((s=e.viewName)!==null&&s!==void 0?s:"fld"),this.element=t.createElement("div"),this.element.classList.add(this.className_(),ql()),e.viewProps.bindClassModifiers(this.element),this.foldable_=e.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),Bt(this.foldable_,"completed",Qe(this.element,this.className_(void 0,"cpl")));const i=t.createElement("button");i.classList.add(this.className_("b")),Bt(e.props,"title",c=>{I(c)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const r=t.createElement("div");r.classList.add(this.className_("i")),this.element.appendChild(r);const o=t.createElement("div");o.classList.add(this.className_("t")),ji(e.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const l=t.createElement("div");l.classList.add(this.className_("m")),this.buttonElement.appendChild(l);const a=t.createElement("div");a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}},bi=class extends Fi{constructor(t,e){var s;const i=Ki.create((s=e.expanded)!==null&&s!==void 0?s:!0),r=new Yp(t,{foldable:i,props:e.props,viewName:e.root?"rot":void 0,viewProps:e.viewProps});super(Object.assign(Object.assign({},e),{rackController:new zi({blade:e.blade,element:r.containerElement,root:e.root,viewProps:e.viewProps}),view:r})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=e.props,this.foldable=i,Ui(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(t){return vt(t,e=>super.importState(e),e=>({expanded:e.required.boolean,title:e.optional.string}),e=>(this.foldable.set("expanded",e.expanded),this.props.set("title",e.title),!0))}exportState(){return bt(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}};const Xp=pt({id:"folder",type:"blade",accept(n){const t=G(n,e=>({title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean}));return t?{params:t}:null},controller(n){return new bi(n.document,{blade:n.blade,expanded:n.params.expanded,props:O.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof bi?new Ul(n.controller,n.pool):null}}),Wp=R("");function co(n,t){return Qe(n,Wp(void 0,t))}let Se=class Hl extends O{constructor(t){var e;super(t),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=$u(U(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(e=this.get("parent"))===null||e===void 0||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(t){var e,s,i;const r=t??{};return new Hl(O.createCore({disabled:(e=r.disabled)!==null&&e!==void 0?e:!1,disposed:!1,hidden:(s=r.hidden)!==null&&s!==void 0?s:!1,parent:(i=r.parent)!==null&&i!==void 0?i:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(t){Gt(this.globalDisabled_,co(t,"disabled")),Bt(this,"hidden",co(t,"hidden"))}bindDisabled(t){Gt(this.globalDisabled_,e=>{t.disabled=e})}bindTabIndex(t){Gt(this.globalDisabled_,e=>{t.tabIndex=e?-1:0})}handleDispose(t){this.value("disposed").emitter.on("change",e=>{e&&t()})}importState(t){this.set("disabled",t.disabled),this.set("hidden",t.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const t=this.get("parent");return(t?t.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(t){var e;const s=t.previousRawValue;s==null||s.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(e=this.get("parent"))===null||e===void 0||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}};const uo=R("tbp");let Zp=class{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(uo()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(uo("c")),this.element.appendChild(s),this.containerElement=s}};const dn=R("tbi");let Jp=class{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(dn()),e.viewProps.bindClassModifiers(this.element),Bt(e.props,"selected",r=>{r?this.element.classList.add(dn(void 0,"sel")):this.element.classList.remove(dn(void 0,"sel"))});const s=t.createElement("button");s.classList.add(dn("b")),e.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;const i=t.createElement("div");i.classList.add(dn("t")),ji(e.props.value("title"),i),this.buttonElement.appendChild(i),this.titleElement=i}},Qp=class{constructor(t,e){this.emitter=new Q,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new Jp(t,{props:e.props,viewProps:e.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}},fi=class extends Fi{constructor(t,e){const s=new Zp(t,{viewProps:e.viewProps});super(Object.assign(Object.assign({},e),{rackController:new zi({blade:e.blade,element:s.containerElement,viewProps:e.viewProps}),view:s})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Qp(t,{props:e.itemProps,viewProps:Se.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=e.props,Bt(this.props,"selected",i=>{this.itemController.props.set("selected",i),this.viewProps.set("hidden",!i)})}get itemController(){return this.ic_}importState(t){return vt(t,e=>super.importState(e),e=>({selected:e.required.boolean,title:e.required.string}),e=>(this.ic_.props.set("selected",e.selected),this.ic_.props.set("title",e.title),!0))}exportState(){return bt(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}},th=class extends Ii{constructor(t,e){super(t,e),this.emitter_=new Q,this.onSelect_=this.onSelect_.bind(this),this.pool_=e,this.rackApi_.on("change",s=>{this.emitter_.emit("change",s)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(t){const e=this.controller.view.element.ownerDocument,s=new fi(e,{blade:en(),itemProps:O.fromObject({selected:!1,title:t.title}),props:O.fromObject({selected:!1}),viewProps:Se.create()}),i=this.pool_.createApi(s);return this.rackApi_.add(i,t.index)}removePage(t){this.rackApi_.remove(this.rackApi_.children[t])}on(t,e){const s=e.bind(this);return this.emitter_.on(t,i=>{s(i)},{key:e}),this}off(t,e){return this.emitter_.off(t,e),this}onSelect_(t){this.emitter_.emit("select",new op(this,t.rawValue))}},eh=class extends Ii{get title(){var t;return(t=this.controller.itemController.props.get("title"))!==null&&t!==void 0?t:""}set title(t){this.controller.itemController.props.set("title",t)}get selected(){return this.controller.props.get("selected")}set selected(t){this.controller.props.set("selected",t)}get children(){return this.rackApi_.children}addButton(t){return this.rackApi_.addButton(t)}addFolder(t){return this.rackApi_.addFolder(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addBinding(t,e,s){return this.rackApi_.addBinding(t,e,s)}addBlade(t){return this.rackApi_.addBlade(t)}};const po=-1;let nh=class{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=U(!0),this.selectedIndex=U(po),this.items_=[]}add(t,e){const s=e??this.items_.length;this.items_.splice(s,0,t),t.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(t){const e=this.items_.indexOf(t);e<0||(this.items_.splice(e,1),t.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=po,this.empty.rawValue=!0;return}const t=this.items_.findIndex(e=>e.rawValue);t<0?(this.items_.forEach((e,s)=>{e.rawValue=s===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((e,s)=>{e.rawValue=s===t}),this.selectedIndex.rawValue=t),this.empty.rawValue=!1}onItemSelectedChange_(t){if(t.rawValue){const e=this.items_.findIndex(s=>s===t.sender);this.items_.forEach((s,i)=>{s.rawValue=i===e}),this.selectedIndex.rawValue=e}else this.keepSelection_()}};const mn=R("tab");let sh=class{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(mn(),ql()),e.viewProps.bindClassModifiers(this.element),Gt(e.empty,Qe(this.element,mn(void 0,"nop")));const s=t.createElement("div");s.classList.add(mn("t")),this.element.appendChild(s),this.itemsElement=s;const i=t.createElement("div");i.classList.add(mn("i")),this.element.appendChild(i);const r=t.createElement("div");r.classList.add(mn("c")),this.element.appendChild(r),this.contentsElement=r}},ho=class extends Fi{constructor(t,e){const s=new nh,i=new sh(t,{empty:s.empty,viewProps:e.viewProps});super({blade:e.blade,rackController:new zi({blade:e.blade,element:i.contentsElement,viewProps:e.viewProps}),view:i}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const r=this.rackController.rack;r.emitter.on("add",this.onRackAdd_),r.emitter.on("remove",this.onRackRemove_),this.tab=s}add(t,e){this.rackController.rack.add(t,e)}remove(t){this.rackController.rack.remove(this.rackController.rack.children[t])}onRackAdd_(t){if(!t.root)return;const e=t.bladeController;Rl(this.view.itemsElement,e.itemController.view.element,t.index),e.itemController.viewProps.set("parent",this.viewProps),this.tab.add(e.props.value("selected"))}onRackRemove_(t){if(!t.root)return;const e=t.bladeController;Ni(e.itemController.view.element),e.itemController.viewProps.set("parent",null),this.tab.remove(e.props.value("selected"))}};const Gl=pt({id:"tab",type:"blade",accept(n){const t=G(n,e=>({pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")}));return!t||t.pages.length===0?null:{params:t}},controller(n){const t=new ho(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(e=>{const s=new fi(n.document,{blade:en(),itemProps:O.fromObject({selected:!1,title:e.title}),props:O.fromObject({selected:!1}),viewProps:Se.create()});t.add(s)}),t},api(n){return n.controller instanceof ho?new th(n.controller,n.pool):n.controller instanceof fi?new eh(n.controller,n.pool):null}});function ih(n,t){const e=n.accept(t.params);if(!e)return null;const s=G(t.params,i=>({disabled:i.optional.boolean,hidden:i.optional.boolean}));return n.controller({blade:en(),document:t.document,params:Object.assign(Object.assign({},e.params),{disabled:s==null?void 0:s.disabled,hidden:s==null?void 0:s.hidden}),viewProps:Se.create({disabled:s==null?void 0:s.disabled,hidden:s==null?void 0:s.hidden})})}let qi=class extends Pn{get options(){return this.controller.valueController.props.get("options")}set options(t){this.controller.valueController.props.set("options",t)}},rh=class{constructor(){this.disabled=!1,this.emitter=new Q}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}},oh=class{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new Q,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}},Rn=class{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce((e,s)=>s.constrain(e),t)}};function ls(n,t){if(n instanceof t)return n;if(n instanceof Rn){const e=n.constraints.reduce((s,i)=>s||(i instanceof t?i:null),null);if(e)return e}return null}let Dn=class{constructor(t){this.values=O.fromObject({options:t})}constrain(t){const e=this.values.get("options");return e.length===0||e.filter(i=>i.value===t).length>0?t:e[0].value}};function Bn(n){var t;const e=mi;if(Array.isArray(n))return(t=G({items:n},s=>({items:s.required.array(s.required.object({text:s.required.string,value:s.required.raw}))})))===null||t===void 0?void 0:t.items;if(typeof n=="object")return e.required.raw(n).value}function Hi(n){if(Array.isArray(n))return n;const t=[];return Object.keys(n).forEach(e=>{t.push({text:e,value:n[e]})}),t}function Gi(n){return I(n)?null:new Dn(Hi(n))}const Bs=R("lst");let lh=class{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.element=t.createElement("div"),this.element.classList.add(Bs()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("select");s.classList.add(Bs("s")),e.viewProps.bindDisabled(s),this.element.appendChild(s),this.selectElement=s;const i=t.createElement("div");i.classList.add(Bs("m")),i.appendChild(gs(t,"dropdown")),this.element.appendChild(i),e.value.emitter.on("change",this.onValueChange_),this.value_=e.value,Bt(this.props_,"options",r=>{Dl(this.selectElement),r.forEach(o=>{const l=t.createElement("option");l.textContent=o.text,this.selectElement.appendChild(l)}),this.update_()})}update_(){const t=this.props_.get("options").map(e=>e.value);this.selectElement.selectedIndex=t.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}},ue=class{constructor(t,e){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new lh(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(t){const e=t.currentTarget;this.value.rawValue=this.props.get("options")[e.selectedIndex].value}importProps(t){return vt(t,null,e=>({options:e.required.custom(Bn)}),e=>(this.props.set("options",Hi(e.options)),!0))}exportProps(){return bt(null,{options:this.props.get("options")})}};const mo=R("pop");let ah=class{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(mo()),e.viewProps.bindClassModifiers(this.element),Gt(e.shows,Qe(this.element,mo(void 0,"v")))}},Yl=class{constructor(t,e){this.shows=U(!1),this.viewProps=e.viewProps,this.view=new ah(t,{shows:this.shows,viewProps:this.viewProps})}};const vo=R("txt");let ch=class{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(vo()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const s=t.createElement("input");s.classList.add(vo("i")),s.type="text",e.viewProps.bindDisabled(s),this.element.appendChild(s),this.inputElement=s,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}},En=class{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new ch(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const s=t.currentTarget.value,i=this.parser_(s);I(i)||(this.value.rawValue=i),this.view.refresh()}};function uh(n){return String(n)}function Xl(n){return n==="false"?!1:!!n}function bo(n){return uh(n)}function ph(n){return t=>n.reduce((e,s)=>e!==null?e:s(t),null)}const hh=dt(0);function as(n){return hh(n)+"%"}function Wl(n){return String(n)}function _i(n){return n}function nn({primary:n,secondary:t,forward:e,backward:s}){let i=!1;function r(o){i||(i=!0,o(),i=!1)}n.emitter.on("change",o=>{r(()=>{t.setRawValue(e(n.rawValue,t.rawValue),o.options)})}),t.emitter.on("change",o=>{r(()=>{n.setRawValue(s(n.rawValue,t.rawValue),o.options)}),r(()=>{t.setRawValue(e(n.rawValue,t.rawValue),o.options)})}),r(()=>{t.setRawValue(e(n.rawValue,t.rawValue),{forceEmit:!1,last:!0})})}function ht(n,t){const e=n*(t.altKey?.1:1)*(t.shiftKey?10:1);return t.upKey?+e:t.downKey?-e:0}function kn(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function Wt(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function dh(n){return n==="ArrowUp"||n==="ArrowDown"}function Zl(n){return dh(n)||n==="ArrowLeft"||n==="ArrowRight"}function Ns(n,t){var e,s;const i=t.ownerDocument.defaultView,r=t.getBoundingClientRect();return{x:n.pageX-(((e=i&&i.scrollX)!==null&&e!==void 0?e:0)+r.left),y:n.pageY-(((s=i&&i.scrollY)!==null&&s!==void 0?s:0)+r.top)}}let Le=class{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new Q,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),(e=t.currentTarget)===null||e===void 0||e.focus();const s=this.elem_.ownerDocument;s.addEventListener("mousemove",this.onDocumentMouseMove_),s.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(Ns(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(Ns(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(Ns(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),s=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-s.left,y:e.clientY-s.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),s=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-s.left,y:e.clientY-s.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const s=(e=t.targetTouches.item(0))!==null&&e!==void 0?e:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(s?{x:s.clientX-i.left,y:s.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}};const ft=R("txt");let mh=class{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(ft(),ft(void 0,"num")),e.arrayPosition&&this.element.classList.add(ft(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("input");s.classList.add(ft("i")),s.type="text",e.viewProps.bindDisabled(s),this.element.appendChild(s),this.inputElement=s,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(ft()),this.inputElement.classList.add(ft("i"));const i=t.createElement("div");i.classList.add(ft("k")),this.element.appendChild(i),this.knobElement=i;const r=t.createElementNS(Rt,"svg");r.classList.add(ft("g")),this.knobElement.appendChild(r);const o=t.createElementNS(Rt,"path");o.classList.add(ft("gb")),r.appendChild(o),this.guideBodyElem_=o;const l=t.createElementNS(Rt,"path");l.classList.add(ft("gh")),r.appendChild(l),this.guideHeadElem_=l;const a=t.createElement("div");a.classList.add(R("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(t.rawValue===null){this.element.classList.remove(ft(void 0,"drg"));return}this.element.classList.add(ft(void 0,"drg"));const e=t.rawValue/this.props_.get("pointerScale"),s=e+(e>0?-1:e<0?1:0),i=tt(-s,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${s+i},0 L${s},4 L${s+i},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}},Nn=class{constructor(t,e){var s;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=e.parser,this.props=e.props,this.sliderProps_=(s=e.sliderProps)!==null&&s!==void 0?s:null,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=U(null),this.view=new mh(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const i=new Le(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}constrainValue_(t){var e,s;const i=(e=this.sliderProps_)===null||e===void 0?void 0:e.get("min"),r=(s=this.sliderProps_)===null||s===void 0?void 0:s.get("max");let o=t;return i!==void 0&&(o=Math.max(o,i)),r!==void 0&&(o=Math.min(o,r)),o}onInputChange_(t){const s=t.currentTarget.value,i=this.parser_(s);I(i)||(this.value.rawValue=this.constrainValue_(i)),this.view.refresh()}onInputKeyDown_(t){const e=ht(this.props.get("keyScale"),kn(t));e!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})}onInputKeyUp_(t){ht(this.props.get("keyScale"),kn(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("pointerScale"))}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);e!==null&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);e!==null&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}};const js=R("sld");let vh=class{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(js()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(js("t")),e.viewProps.bindTabIndex(s),this.element.appendChild(s),this.trackElement=s;const i=t.createElement("div");i.classList.add(js("k")),this.trackElement.appendChild(i),this.knobElement=i,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.update_()}update_(){const t=tt(B(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${t}%`}onChange_(){this.update_()}},bh=class{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.props=e.props,this.view=new vh(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Le(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){t.point&&this.value.setRawValue(B(tt(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("min"),this.props.get("max")),e)}onPointerDownOrMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=ht(this.props.get("keyScale"),Wt(t));e!==0&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onKeyUp_(t){ht(this.props.get("keyScale"),Wt(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const Is=R("sldtxt");let fh=class{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Is());const s=t.createElement("div");s.classList.add(Is("s")),this.sliderView_=e.sliderView,s.appendChild(this.sliderView_.element),this.element.appendChild(s);const i=t.createElement("div");i.classList.add(Is("t")),this.textView_=e.textView,i.appendChild(this.textView_.element),this.element.appendChild(i)}},cs=class{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sliderC_=new bh(t,{props:e.sliderProps,value:e.value,viewProps:this.viewProps}),this.textC_=new Nn(t,{parser:e.parser,props:e.textProps,sliderProps:e.sliderProps,value:e.value,viewProps:e.viewProps}),this.view=new fh(t,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(t){return vt(t,null,e=>({max:e.required.number,min:e.required.number}),e=>{const s=this.sliderC_.props;return s.set("max",e.max),s.set("min",e.min),!0})}exportProps(){const t=this.sliderC_.props;return bt(null,{max:t.get("max"),min:t.get("min")})}};function Jl(n){return{sliderProps:new O({keyScale:n.keyScale,max:n.max,min:n.min}),textProps:new O({formatter:U(n.formatter),keyScale:n.keyScale,pointerScale:U(n.pointerScale)})}}const _h={containerUnitSize:"cnt-usz"};function Ql(n){return`--${_h[n]}`}function Vn(n){return Tl(n)}function oe(n){if(di(n))return G(n,Vn)}function Ut(n,t){if(!n)return;const e=[],s=Ll(n,t);s&&e.push(s);const i=Ml(n);return i&&e.push(i),new Rn(e)}function wh(n){return n?n.major===tn.major:!1}function ta(n){if(n==="inline"||n==="popup")return n}function jn(n,t){n.write(t)}const Xn=R("ckb");let gh=class{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Xn()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("label");s.classList.add(Xn("l")),this.element.appendChild(s),this.labelElement=s;const i=t.createElement("input");i.classList.add(Xn("i")),i.type="checkbox",this.labelElement.appendChild(i),this.inputElement=i,e.viewProps.bindDisabled(this.inputElement);const r=t.createElement("div");r.classList.add(Xn("w")),this.labelElement.appendChild(r);const o=gs(t,"check");r.appendChild(o),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}},Ch=class{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.onLabelMouseDown_=this.onLabelMouseDown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new gh(t,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.labelElement.addEventListener("mousedown",this.onLabelMouseDown_)}onInputChange_(t){const e=t.currentTarget;this.value.rawValue=e.checked,t.preventDefault(),t.stopPropagation()}onLabelMouseDown_(t){t.preventDefault()}};function yh(n){const t=[],e=Gi(n.options);return e&&t.push(e),new Rn(t)}const xh=pt({id:"input-bool",type:"input",accept:(n,t)=>{if(typeof n!="boolean")return null;const e=G(t,s=>({options:s.optional.custom(Bn),readonly:s.optional.constant(!1)}));return e?{initialValue:n,params:e}:null},binding:{reader:n=>Xl,constraint:n=>yh(n.params),writer:n=>jn},controller:n=>{const t=n.document,e=n.value,s=n.constraint,i=s&&ls(s,Dn);return i?new ue(t,{props:new O({options:i.values.value("options")}),value:e,viewProps:n.viewProps}):new Ch(t,{value:e,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="boolean"?null:n.controller.valueController instanceof ue?new qi(n.controller):null}}),be=R("col");let Ph=class{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(be()),e.foldable.bindExpandedClass(this.element,be(void 0,"expanded")),Bt(e.foldable,"completed",Qe(this.element,be(void 0,"cpl")));const s=t.createElement("div");s.classList.add(be("h")),this.element.appendChild(s);const i=t.createElement("div");i.classList.add(be("s")),s.appendChild(i),this.swatchElement=i;const r=t.createElement("div");if(r.classList.add(be("t")),s.appendChild(r),this.textElement=r,e.pickerLayout==="inline"){const o=t.createElement("div");o.classList.add(be("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};function Eh(n,t,e){const s=tt(n/255,0,1),i=tt(t/255,0,1),r=tt(e/255,0,1),o=Math.max(s,i,r),l=Math.min(s,i,r),a=o-l;let c=0,u=0;const p=(l+o)/2;return a!==0&&(u=a/(1-Math.abs(o+l-1)),s===o?c=(i-r)/a:i===o?c=2+(r-s)/a:c=4+(s-i)/a,c=c/6+(c<0?1:0)),[c*360,u*100,p*100]}function kh(n,t,e){const s=(n%360+360)%360,i=tt(t/100,0,1),r=tt(e/100,0,1),o=(1-Math.abs(2*r-1))*i,l=o*(1-Math.abs(s/60%2-1)),a=r-o/2;let c,u,p;return s>=0&&s<60?[c,u,p]=[o,l,0]:s>=60&&s<120?[c,u,p]=[l,o,0]:s>=120&&s<180?[c,u,p]=[0,o,l]:s>=180&&s<240?[c,u,p]=[0,l,o]:s>=240&&s<300?[c,u,p]=[l,0,o]:[c,u,p]=[o,0,l],[(c+a)*255,(u+a)*255,(p+a)*255]}function Vh(n,t,e){const s=tt(n/255,0,1),i=tt(t/255,0,1),r=tt(e/255,0,1),o=Math.max(s,i,r),l=Math.min(s,i,r),a=o-l;let c;a===0?c=0:o===s?c=60*(((i-r)/a%6+6)%6):o===i?c=60*((r-s)/a+2):c=60*((s-i)/a+4);const u=o===0?0:a/o,p=o;return[c,u*100,p*100]}function ea(n,t,e){const s=Vl(n,360),i=tt(t/100,0,1),r=tt(e/100,0,1),o=r*i,l=o*(1-Math.abs(s/60%2-1)),a=r-o;let c,u,p;return s>=0&&s<60?[c,u,p]=[o,l,0]:s>=60&&s<120?[c,u,p]=[l,o,0]:s>=120&&s<180?[c,u,p]=[0,o,l]:s>=180&&s<240?[c,u,p]=[0,l,o]:s>=240&&s<300?[c,u,p]=[l,0,o]:[c,u,p]=[o,0,l],[(c+a)*255,(u+a)*255,(p+a)*255]}function $h(n,t,e){const s=e+t*(100-Math.abs(2*e-100))/200;return[n,s!==0?t*(100-Math.abs(2*e-100))/s:0,e+t*(100-Math.abs(2*e-100))/(2*100)]}function Sh(n,t,e){const s=100-Math.abs(e*(200-t)/100-100);return[n,s!==0?t*e/s:0,e*(200-t)/(2*100)]}function Nt(n){return[n[0],n[1],n[2]]}function ys(n,t){return[n[0],n[1],n[2],t]}const Lh={hsl:{hsl:(n,t,e)=>[n,t,e],hsv:$h,rgb:kh},hsv:{hsl:Sh,hsv:(n,t,e)=>[n,t,e],rgb:ea},rgb:{hsl:Eh,hsv:Vh,rgb:(n,t,e)=>[n,t,e]}};function Ye(n,t){return[t==="float"?1:n==="rgb"?255:360,t==="float"?1:n==="rgb"?255:100,t==="float"?1:n==="rgb"?255:100]}function Mh(n,t){return n===t?t:Vl(n,t)}function na(n,t,e){var s;const i=Ye(t,e);return[t==="rgb"?tt(n[0],0,i[0]):Mh(n[0],i[0]),tt(n[1],0,i[1]),tt(n[2],0,i[2]),tt((s=n[3])!==null&&s!==void 0?s:1,0,1)]}function fo(n,t,e,s){const i=Ye(t,e),r=Ye(t,s);return n.map((o,l)=>o/i[l]*r[l])}function sa(n,t,e){const s=fo(n,t.mode,t.type,"int"),i=Lh[t.mode][e.mode](...s);return fo(i,e.mode,"int",e.type)}let N=class ia{static black(){return new ia([0,0,0],"rgb")}constructor(t,e){this.type="int",this.mode=e,this.comps_=na(t,e,this.type)}getComponents(t){return ys(sa(Nt(this.comps_),{mode:this.mode,type:this.type},{mode:t??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const t=this.getComponents("rgb");return{r:t[0],g:t[1],b:t[2],a:t[3]}}};const Qt=R("colp");let Ah=class{constructor(t,e){this.alphaViews_=null,this.element=t.createElement("div"),this.element.classList.add(Qt()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(Qt("hsv"));const i=t.createElement("div");i.classList.add(Qt("sv")),this.svPaletteView_=e.svPaletteView,i.appendChild(this.svPaletteView_.element),s.appendChild(i);const r=t.createElement("div");r.classList.add(Qt("h")),this.hPaletteView_=e.hPaletteView,r.appendChild(this.hPaletteView_.element),s.appendChild(r),this.element.appendChild(s);const o=t.createElement("div");if(o.classList.add(Qt("rgb")),this.textsView_=e.textsView,o.appendChild(this.textsView_.element),this.element.appendChild(o),e.alphaViews){this.alphaViews_={palette:e.alphaViews.palette,text:e.alphaViews.text};const l=t.createElement("div");l.classList.add(Qt("a"));const a=t.createElement("div");a.classList.add(Qt("ap")),a.appendChild(this.alphaViews_.palette.element),l.appendChild(a);const c=t.createElement("div");c.classList.add(Qt("at")),c.appendChild(this.alphaViews_.text.element),l.appendChild(c),this.element.appendChild(l)}}get allFocusableElements(){const t=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(e=>e.inputElement)];return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t}};function Th(n){return n==="int"?"int":n==="float"?"float":void 0}function Yi(n){return G(n,t=>({color:t.optional.object({alpha:t.optional.boolean,type:t.optional.custom(Th)}),expanded:t.optional.boolean,picker:t.optional.custom(ta),readonly:t.optional.constant(!1)}))}function Pe(n){return n?.1:1}function ra(n){var t;return(t=n.color)===null||t===void 0?void 0:t.type}let Xi=class{constructor(t,e){this.type="float",this.mode=e,this.comps_=na(t,e,this.type)}getComponents(t){return ys(sa(Nt(this.comps_),{mode:this.mode,type:this.type},{mode:t??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const t=this.getComponents("rgb");return{r:t[0],g:t[1],b:t[2],a:t[3]}}};const Oh={int:(n,t)=>new N(n,t),float:(n,t)=>new Xi(n,t)};function Wi(n,t,e){return Oh[e](n,t)}function Rh(n){return n.type==="float"}function Dh(n){return n.type==="int"}function Bh(n){const t=n.getComponents(),e=Ye(n.mode,"int");return new N([Math.round(B(t[0],0,1,0,e[0])),Math.round(B(t[1],0,1,0,e[1])),Math.round(B(t[2],0,1,0,e[2])),t[3]],n.mode)}function Nh(n){const t=n.getComponents(),e=Ye(n.mode,"int");return new Xi([B(t[0],0,e[0],0,1),B(t[1],0,e[1],0,1),B(t[2],0,e[2],0,1),t[3]],n.mode)}function ct(n,t){if(n.type===t)return n;if(Dh(n)&&t==="float")return Nh(n);if(Rh(n)&&t==="int")return Bh(n);throw it.shouldNeverHappen()}function jh(n,t){return n.alpha===t.alpha&&n.mode===t.mode&&n.notation===t.notation&&n.type===t.type}function gt(n,t){const e=n.match(/^(.+)%$/);return Math.min(e?parseFloat(e[1])*.01*t:parseFloat(n),t)}const Ih={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function oa(n){const t=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!t)return parseFloat(n);const e=parseFloat(t[1]),s=t[2];return Ih[s](e)}function la(n){const t=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const e=[gt(t[1],255),gt(t[2],255),gt(t[3],255)];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])?null:e}function Fh(n){const t=la(n);return t?new N(t,"rgb"):null}function aa(n){const t=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const e=[gt(t[1],255),gt(t[2],255),gt(t[3],255),gt(t[4],1)];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])||isNaN(e[3])?null:e}function zh(n){const t=aa(n);return t?new N(t,"rgb"):null}function ca(n){const t=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const e=[oa(t[1]),gt(t[2],100),gt(t[3],100)];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])?null:e}function Kh(n){const t=ca(n);return t?new N(t,"hsl"):null}function ua(n){const t=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const e=[oa(t[1]),gt(t[2],100),gt(t[3],100),gt(t[4],1)];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])||isNaN(e[3])?null:e}function Uh(n){const t=ua(n);return t?new N(t,"hsl"):null}function pa(n){const t=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)];const e=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null}function qh(n){const t=pa(n);return t?new N(t,"rgb"):null}function ha(n){const t=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16),B(parseInt(t[4]+t[4],16),0,255,0,1)];const e=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),B(parseInt(e[4],16),0,255,0,1)]:null}function Hh(n){const t=ha(n);return t?new N(t,"rgb"):null}function da(n){const t=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const e=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])?null:e}function Gh(n){return t=>{const e=da(t);return e?Wi(e,"rgb",n):null}}function ma(n){const t=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const e=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])||isNaN(e[3])?null:e}function Yh(n){return t=>{const e=ma(t);return e?Wi(e,"rgb",n):null}}const Xh=[{parser:pa,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:ha,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:la,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:aa,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:ca,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:ua,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:da,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:ma,result:{alpha:!0,mode:"rgb",notation:"object"}}];function Wh(n){return Xh.reduce((t,{parser:e,result:s})=>t||(e(n)?s:null),null)}function Zh(n,t="int"){const e=Wh(n);return e?e.notation==="hex"&&t!=="float"?Object.assign(Object.assign({},e),{type:"int"}):e.notation==="func"?Object.assign(Object.assign({},e),{type:t}):null:null}function In(n){const t=[qh,Hh,Fh,zh,Kh,Uh];t.push(Gh("int"),Yh("int"));const e=ph(t);return s=>{const i=e(s);return i?ct(i,n):null}}function Jh(n){const t=In("int");if(typeof n!="string")return N.black();const e=t(n);return e??N.black()}function va(n){const t=tt(Math.floor(n),0,255).toString(16);return t.length===1?`0${t}`:t}function Zi(n,t="#"){const e=Nt(n.getComponents("rgb")).map(va).join("");return`${t}${e}`}function Ji(n,t="#"){const e=n.getComponents("rgb"),s=[e[0],e[1],e[2],e[3]*255].map(va).join("");return`${t}${s}`}function ba(n){const t=dt(0),e=ct(n,"int");return`rgb(${Nt(e.getComponents("rgb")).map(i=>t(i)).join(", ")})`}function es(n){const t=dt(2),e=dt(0);return`rgba(${ct(n,"int").getComponents("rgb").map((r,o)=>(o===3?t:e)(r)).join(", ")})`}function Qh(n){const t=[dt(0),as,as],e=ct(n,"int");return`hsl(${Nt(e.getComponents("hsl")).map((i,r)=>t[r](i)).join(", ")})`}function td(n){const t=[dt(0),as,as,dt(2)];return`hsla(${ct(n,"int").getComponents("hsl").map((i,r)=>t[r](i)).join(", ")})`}function fa(n,t){const e=dt(t==="float"?2:0),s=["r","g","b"],i=ct(n,t);return`{${Nt(i.getComponents("rgb")).map((o,l)=>`${s[l]}: ${e(o)}`).join(", ")}}`}function ed(n){return t=>fa(t,n)}function _a(n,t){const e=dt(2),s=dt(t==="float"?2:0),i=["r","g","b","a"];return`{${ct(n,t).getComponents("rgb").map((l,a)=>{const c=a===3?e:s;return`${i[a]}: ${c(l)}`}).join(", ")}}`}function nd(n){return t=>_a(t,n)}const sd=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:Zi},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:Ji},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:ba},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:es},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:Qh},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:td},...["int","float"].reduce((n,t)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"object",type:t},stringifier:ed(t)},{format:{alpha:!0,mode:"rgb",notation:"object",type:t},stringifier:nd(t)}],[])];function wa(n){return sd.reduce((t,e)=>t||(jh(e.format,n)?e.stringifier:null),null)}const vn=R("apl");let id=class{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(vn()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const s=t.createElement("div");s.classList.add(vn("b")),this.element.appendChild(s);const i=t.createElement("div");i.classList.add(vn("c")),s.appendChild(i),this.colorElem_=i;const r=t.createElement("div");r.classList.add(vn("m")),this.element.appendChild(r),this.markerElem_=r;const o=t.createElement("div");o.classList.add(vn("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const t=this.value.rawValue,e=t.getComponents("rgb"),s=new N([e[0],e[1],e[2],0],"rgb"),i=new N([e[0],e[1],e[2],255],"rgb"),r=["to right",es(s),es(i)];this.colorElem_.style.background=`linear-gradient(${r.join(",")})`,this.previewElem_.style.backgroundColor=es(t);const o=B(e[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}},rd=class{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new id(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Le(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const s=t.point.x/t.bounds.width,i=this.value.rawValue,[r,o,l]=i.getComponents("hsv");this.value.setRawValue(new N([r,o,l,s],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=ht(Pe(!0),Wt(t));if(e===0)return;const s=this.value.rawValue,[i,r,o,l]=s.getComponents("hsv");this.value.setRawValue(new N([i,r,o,l+e],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){ht(Pe(!0),Wt(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const Re=R("coltxt");function od(n){const t=n.createElement("select"),e=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return t.appendChild(e.reduce((s,i)=>{const r=n.createElement("option");return r.textContent=i.text,r.value=i.value,s.appendChild(r),s},n.createDocumentFragment())),t}let ld=class{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Re()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(Re("m")),this.modeElem_=od(t),this.modeElem_.classList.add(Re("ms")),s.appendChild(this.modeSelectElement),e.viewProps.bindDisabled(this.modeElem_);const i=t.createElement("div");i.classList.add(Re("mm")),i.appendChild(gs(t,"dropdown")),s.appendChild(i),this.element.appendChild(s);const r=t.createElement("div");r.classList.add(Re("w")),this.element.appendChild(r),this.inputsElem_=r,this.inputViews_=e.inputViews,this.applyInputViews_(),Gt(e.mode,o=>{this.modeElem_.value=o})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(t){this.inputViews_=t,this.applyInputViews_()}applyInputViews_(){Dl(this.inputsElem_);const t=this.element.ownerDocument;this.inputViews_.forEach(e=>{const s=t.createElement("div");s.classList.add(Re("c")),s.appendChild(e.element),this.inputsElem_.appendChild(s)})}};function ad(n){return dt(n==="float"?2:0)}function cd(n,t,e){const s=Ye(n,t)[e];return new Tn({min:0,max:s})}function ud(n,t,e){return new Nn(n,{arrayPosition:e===0?"fst":e===2?"lst":"mid",parser:t.parser,props:O.fromObject({formatter:ad(t.colorType),keyScale:Pe(!1),pointerScale:t.colorType==="float"?.01:1}),value:U(0,{constraint:cd(t.colorMode,t.colorType,e)}),viewProps:t.viewProps})}function pd(n,t){const e={colorMode:t.colorMode,colorType:t.colorType,parser:Xt,viewProps:t.viewProps};return[0,1,2].map(s=>{const i=ud(n,e,s);return nn({primary:t.value,secondary:i.value,forward(r){return ct(r,t.colorType).getComponents(t.colorMode)[s]},backward(r,o){const l=t.colorMode,c=ct(r,t.colorType).getComponents(l);c[s]=o;const u=Wi(ys(Nt(c),c[3]),l,t.colorType);return ct(u,"int")}}),i})}function hd(n,t){const e=new En(n,{parser:In("int"),props:O.fromObject({formatter:Zi}),value:U(N.black()),viewProps:t.viewProps});return nn({primary:t.value,secondary:e.value,forward:s=>new N(Nt(s.getComponents()),s.mode),backward:(s,i)=>new N(ys(Nt(i.getComponents(s.mode)),s.getComponents()[3]),s.mode)}),[e]}function dd(n){return n!=="hex"}let md=class{constructor(t,e){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=e.colorType,this.value=e.value,this.viewProps=e.viewProps,this.colorMode=U(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(t),this.view=new ld(t,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(t){const e=this.colorMode.rawValue;return dd(e)?pd(t,{colorMode:e,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):hd(t,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(t){const e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(s=>s.view)}};const Fs=R("hpl");let vd=class{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Fs()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const s=t.createElement("div");s.classList.add(Fs("c")),this.element.appendChild(s);const i=t.createElement("div");i.classList.add(Fs("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const t=this.value.rawValue,[e]=t.getComponents("hsv");this.markerElem_.style.backgroundColor=ba(new N([e,100,100],"hsv"));const s=B(e,0,360,0,100);this.markerElem_.style.left=`${s}%`}onValueChange_(){this.update_()}},bd=class{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new vd(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Le(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const s=B(tt(t.point.x,0,t.bounds.width),0,t.bounds.width,0,360),i=this.value.rawValue,[,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new N([s,r,o,l],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=ht(Pe(!1),Wt(t));if(e===0)return;const s=this.value.rawValue,[i,r,o,l]=s.getComponents("hsv");this.value.setRawValue(new N([i+e,r,o,l],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){ht(Pe(!1),Wt(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const zs=R("svp"),_o=64;let fd=class{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(zs()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const s=t.createElement("canvas");s.height=_o,s.width=_o,s.classList.add(zs("c")),this.element.appendChild(s),this.canvasElement=s;const i=t.createElement("div");i.classList.add(zs("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const t=bp(this.canvasElement);if(!t)return;const s=this.value.rawValue.getComponents("hsv"),i=this.canvasElement.width,r=this.canvasElement.height,o=t.getImageData(0,0,i,r),l=o.data;for(let u=0;u<r;u++)for(let p=0;p<i;p++){const d=B(p,0,i,0,100),v=B(u,0,r,100,0),b=ea(s[0],d,v),y=(u*i+p)*4;l[y]=b[0],l[y+1]=b[1],l[y+2]=b[2],l[y+3]=255}t.putImageData(o,0,0);const a=B(s[1],0,100,0,100);this.markerElem_.style.left=`${a}%`;const c=B(s[2],0,100,100,0);this.markerElem_.style.top=`${c}%`}onValueChange_(){this.update_()}},_d=class{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new fd(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Le(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const s=B(t.point.x,0,t.bounds.width,0,100),i=B(t.point.y,0,t.bounds.height,100,0),[r,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new N([r,s,i,o],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){Zl(t.key)&&t.preventDefault();const[e,s,i,r]=this.value.rawValue.getComponents("hsv"),o=Pe(!1),l=ht(o,Wt(t)),a=ht(o,kn(t));l===0&&a===0||this.value.setRawValue(new N([e,s+l,i+a,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){const e=Pe(!1),s=ht(e,Wt(t)),i=ht(e,kn(t));s===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},wd=class{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.hPaletteC_=new bd(t,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new _d(t,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=e.supportsAlpha?{palette:new rd(t,{value:this.value,viewProps:this.viewProps}),text:new Nn(t,{parser:Xt,props:O.fromObject({pointerScale:.01,keyScale:.1,formatter:dt(2)}),value:U(0,{constraint:new Tn({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&nn({primary:this.value,secondary:this.alphaIcs_.text.value,forward:s=>s.getComponents()[3],backward:(s,i)=>{const r=s.getComponents();return r[3]=i,new N(r,s.mode)}}),this.textsC_=new md(t,{colorType:e.colorType,value:this.value,viewProps:this.viewProps}),this.view=new Ah(t,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:e.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}};const Ks=R("colsw");let gd=class{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(Ks()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(Ks("sw")),this.element.appendChild(s),this.swatchElem_=s;const i=t.createElement("button");i.classList.add(Ks("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i,this.update_()}update_(){const t=this.value.rawValue;this.swatchElem_.style.backgroundColor=Ji(t)}onValueChange_(){this.update_()}},Cd=class{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new gd(t,{value:this.value,viewProps:this.viewProps})}},Qi=class{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=Ki.create(e.expanded),this.swatchC_=new Cd(t,{value:this.value,viewProps:this.viewProps});const s=this.swatchC_.view.buttonElement;s.addEventListener("blur",this.onButtonBlur_),s.addEventListener("click",this.onButtonClick_),this.textC_=new En(t,{parser:e.parser,props:O.fromObject({formatter:e.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new Ph(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=e.pickerLayout==="popup"?new Yl(t,{viewProps:this.viewProps}):null;const i=new wd(t,{colorType:e.colorType,supportsAlpha:e.supportsAlpha,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach(r=>{r.addEventListener("blur",this.onPopupChildBlur_),r.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(i.view.element),nn({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:r=>r,backward:(r,o)=>o})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Ui(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,s=t.relatedTarget;(!s||!e.contains(s))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,s=Bl(t);s&&e.contains(s)||s&&s===this.swatchC_.view.buttonElement&&!Bi(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?t.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&t.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}};function yd(n){return Nt(n.getComponents("rgb")).reduce((t,e)=>t<<8|Math.floor(e)&255,0)}function xd(n){return n.getComponents("rgb").reduce((t,e,s)=>{const i=Math.floor(s===3?e*255:e)&255;return t<<8|i},0)>>>0}function Pd(n){return new N([n>>16&255,n>>8&255,n&255],"rgb")}function Ed(n){return new N([n>>24&255,n>>16&255,n>>8&255,B(n&255,0,255,0,1)],"rgb")}function kd(n){return typeof n!="number"?N.black():Pd(n)}function Vd(n){return typeof n!="number"?N.black():Ed(n)}function ns(n,t){return typeof n!="object"||I(n)?!1:t in n&&typeof n[t]=="number"}function ga(n){return ns(n,"r")&&ns(n,"g")&&ns(n,"b")}function Ca(n){return ga(n)&&ns(n,"a")}function ya(n){return ga(n)}function tr(n,t){if(n.mode!==t.mode||n.type!==t.type)return!1;const e=n.getComponents(),s=t.getComponents();for(let i=0;i<e.length;i++)if(e[i]!==s[i])return!1;return!0}function wo(n){return"a"in n?[n.r,n.g,n.b,n.a]:[n.r,n.g,n.b]}function $d(n){const t=wa(n);return t?(e,s)=>{jn(e,t(s))}:null}function Sd(n){const t=n?xd:yd;return(e,s)=>{jn(e,t(s))}}function Ld(n,t,e){const i=ct(t,e).toRgbaObject();n.writeProperty("r",i.r),n.writeProperty("g",i.g),n.writeProperty("b",i.b),n.writeProperty("a",i.a)}function Md(n,t,e){const i=ct(t,e).toRgbaObject();n.writeProperty("r",i.r),n.writeProperty("g",i.g),n.writeProperty("b",i.b)}function Ad(n,t){return(e,s)=>{n?Ld(e,s,t):Md(e,s,t)}}function Td(n){var t;return!!(!((t=n==null?void 0:n.color)===null||t===void 0)&&t.alpha)}function Od(n){return n?t=>Ji(t,"0x"):t=>Zi(t,"0x")}function Rd(n){return"color"in n||n.view==="color"}const Dd=pt({id:"input-color-number",type:"input",accept:(n,t)=>{if(typeof n!="number"||!Rd(t))return null;const e=Yi(t);return e?{initialValue:n,params:Object.assign(Object.assign({},e),{supportsAlpha:Td(t)})}:null},binding:{reader:n=>n.params.supportsAlpha?Vd:kd,equals:tr,writer:n=>Sd(n.params.supportsAlpha)},controller:n=>{var t,e;return new Qi(n.document,{colorType:"int",expanded:(t=n.params.expanded)!==null&&t!==void 0?t:!1,formatter:Od(n.params.supportsAlpha),parser:In("int"),pickerLayout:(e=n.params.picker)!==null&&e!==void 0?e:"popup",supportsAlpha:n.params.supportsAlpha,value:n.value,viewProps:n.viewProps})}});function Bd(n,t){if(!ya(n))return ct(N.black(),t);if(t==="int"){const e=wo(n);return new N(e,"rgb")}if(t==="float"){const e=wo(n);return new Xi(e,"rgb")}return ct(N.black(),"int")}function Nd(n){return Ca(n)}function jd(n){return t=>{const e=Bd(t,n);return ct(e,"int")}}function Id(n,t){return e=>n?_a(e,t):fa(e,t)}const Fd=pt({id:"input-color-object",type:"input",accept:(n,t)=>{var e;if(!ya(n))return null;const s=Yi(t);return s?{initialValue:n,params:Object.assign(Object.assign({},s),{colorType:(e=ra(t))!==null&&e!==void 0?e:"int"})}:null},binding:{reader:n=>jd(n.params.colorType),equals:tr,writer:n=>Ad(Nd(n.initialValue),n.params.colorType)},controller:n=>{var t,e;const s=Ca(n.initialValue);return new Qi(n.document,{colorType:n.params.colorType,expanded:(t=n.params.expanded)!==null&&t!==void 0?t:!1,formatter:Id(s,n.params.colorType),parser:In("int"),pickerLayout:(e=n.params.picker)!==null&&e!==void 0?e:"popup",supportsAlpha:s,value:n.value,viewProps:n.viewProps})}}),zd=pt({id:"input-color-string",type:"input",accept:(n,t)=>{if(typeof n!="string"||t.view==="text")return null;const e=Zh(n,ra(t));if(!e)return null;const s=wa(e);if(!s)return null;const i=Yi(t);return i?{initialValue:n,params:Object.assign(Object.assign({},i),{format:e,stringifier:s})}:null},binding:{reader:()=>Jh,equals:tr,writer:n=>{const t=$d(n.params.format);if(!t)throw it.notBindable();return t}},controller:n=>{var t,e;return new Qi(n.document,{colorType:n.params.format.type,expanded:(t=n.params.expanded)!==null&&t!==void 0?t:!1,formatter:n.params.stringifier,parser:In("int"),pickerLayout:(e=n.params.picker)!==null&&e!==void 0?e:"popup",supportsAlpha:n.params.format.alpha,value:n.value,viewProps:n.viewProps})}});let er=class{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map((s,i)=>{var r,o;return(o=(r=this.components[i])===null||r===void 0?void 0:r.constrain(s))!==null&&o!==void 0?o:s});return this.asm_.fromComponents(e)}};const go=R("pndtxt");let Kd=class{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(go()),this.textViews.forEach(s=>{const i=t.createElement("div");i.classList.add(go("a")),i.appendChild(s.element),this.element.appendChild(i)})}};function Ud(n,t,e){return new Nn(n,{arrayPosition:e===0?"fst":e===t.axes.length-1?"lst":"mid",parser:t.parser,props:t.axes[e].textProps,value:U(0,{constraint:t.axes[e].constraint}),viewProps:t.viewProps})}let nr=class{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map((s,i)=>Ud(t,e,i)),this.acs_.forEach((s,i)=>{nn({primary:this.value,secondary:s.value,forward:r=>e.assembly.toComponents(r)[i],backward:(r,o)=>{const l=e.assembly.toComponents(r);return l[i]=o,e.assembly.fromComponents(l)}})}),this.view=new Kd(t,{textViews:this.acs_.map(s=>s.view)})}get textControllers(){return this.acs_}},qd=class extends Pn{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(t){this.controller.valueController.sliderController.props.set("max",t)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(t){this.controller.valueController.sliderController.props.set("min",t)}};function Hd(n,t){const e=[],s=Ll(n,t);s&&e.push(s);const i=Ml(n);i&&e.push(i);const r=Gi(n.options);return r&&e.push(r),new Rn(e)}const Gd=pt({id:"input-number",type:"input",accept:(n,t)=>{if(typeof n!="number")return null;const e=G(t,s=>Object.assign(Object.assign({},Tl(s)),{options:s.optional.custom(Bn),readonly:s.optional.constant(!1)}));return e?{initialValue:n,params:e}:null},binding:{reader:n=>kl,constraint:n=>Hd(n.params,n.initialValue),writer:n=>jn},controller:n=>{const t=n.value,e=n.constraint,s=e&&ls(e,Dn);if(s)return new ue(n.document,{props:new O({options:s.values.value("options")}),value:t,viewProps:n.viewProps});const i=Al(n.params,t.rawValue),r=e&&ls(e,Tn);return r?new cs(n.document,Object.assign(Object.assign({},Jl(Object.assign(Object.assign({},i),{keyScale:U(i.keyScale),max:r.values.value("max"),min:r.values.value("min")}))),{parser:Xt,value:t,viewProps:n.viewProps})):new Nn(n.document,{parser:Xt,props:O.fromObject(i),value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="number"?null:n.controller.valueController instanceof cs?new qd(n.controller):n.controller.valueController instanceof ue?new qi(n.controller):null}});let ae=class{constructor(t=0,e=0){this.x=t,this.y=e}getComponents(){return[this.x,this.y]}static isObject(t){if(I(t))return!1;const e=t.x,s=t.y;return!(typeof e!="number"||typeof s!="number")}static equals(t,e){return t.x===e.x&&t.y===e.y}toObject(){return{x:this.x,y:this.y}}};const xa={toComponents:n=>n.getComponents(),fromComponents:n=>new ae(...n)},De=R("p2d");let Yd=class{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(De()),e.viewProps.bindClassModifiers(this.element),Gt(e.expanded,Qe(this.element,De(void 0,"expanded")));const s=t.createElement("div");s.classList.add(De("h")),this.element.appendChild(s);const i=t.createElement("button");i.classList.add(De("b")),i.appendChild(gs(t,"p2dpad")),e.viewProps.bindDisabled(i),s.appendChild(i),this.buttonElement=i;const r=t.createElement("div");if(r.classList.add(De("t")),s.appendChild(r),this.textElement=r,e.pickerLayout==="inline"){const o=t.createElement("div");o.classList.add(De("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};const te=R("p2dp");let Xd=class{constructor(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=t.createElement("div"),this.element.classList.add(te()),e.layout==="popup"&&this.element.classList.add(te(void 0,"p")),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(te("p")),e.viewProps.bindTabIndex(s),this.element.appendChild(s),this.padElement=s;const i=t.createElementNS(Rt,"svg");i.classList.add(te("g")),this.padElement.appendChild(i),this.svgElem_=i;const r=t.createElementNS(Rt,"line");r.classList.add(te("ax")),r.setAttributeNS(null,"x1","0"),r.setAttributeNS(null,"y1","50%"),r.setAttributeNS(null,"x2","100%"),r.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(r);const o=t.createElementNS(Rt,"line");o.classList.add(te("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const l=t.createElementNS(Rt,"line");l.classList.add(te("l")),l.setAttributeNS(null,"x1","50%"),l.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(l),this.lineElem_=l;const a=t.createElement("div");a.classList.add(te("m")),this.padElement.appendChild(a),this.markerElem_=a,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[t,e]=this.value.rawValue.getComponents(),s=this.props_.get("max"),i=B(t,-s,+s,0,100),r=B(e,-s,+s,0,100),o=this.props_.get("invertsY")?100-r:r;this.lineElem_.setAttributeNS(null,"x2",`${i}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${i}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}};function Co(n,t,e){return[ht(t[0],Wt(n)),ht(t[1],kn(n))*(e?1:-1)]}let Wd=class{constructor(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new Xd(t,{layout:e.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Le(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const s=this.props.get("max"),i=B(t.point.x,0,t.bounds.width,-s,+s),r=B(this.props.get("invertsY")?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-s,+s);this.value.setRawValue(new ae(i,r),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onPadKeyDown_(t){Zl(t.key)&&t.preventDefault();const[e,s]=Co(t,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));e===0&&s===0||this.value.setRawValue(new ae(this.value.rawValue.x+e,this.value.rawValue.y+s),{forceEmit:!1,last:!1})}onPadKeyUp_(t){const[e,s]=Co(t,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));e===0&&s===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},Zd=class{constructor(t,e){var s,i;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=Ki.create(e.expanded),this.popC_=e.pickerLayout==="popup"?new Yl(t,{viewProps:this.viewProps}):null;const r=new Wd(t,{layout:e.pickerLayout,props:new O({invertsY:U(e.invertsY),max:U(e.max),xKeyScale:e.axes[0].textProps.value("keyScale"),yKeyScale:e.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach(o=>{o.addEventListener("blur",this.onPopupChildBlur_),o.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=r,this.textC_=new nr(t,{assembly:xa,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new Yd(t,{expanded:this.foldable_.value("expanded"),pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(s=this.view.buttonElement)===null||s===void 0||s.addEventListener("blur",this.onPadButtonBlur_),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),nn({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:o=>o,backward:(o,l)=>l})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Ui(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,s=t.relatedTarget;(!s||!e.contains(s))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,s=Bl(t);s&&e.contains(s)||s&&s===this.view.buttonElement&&!Bi(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?t.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&t.key==="Escape"&&this.view.buttonElement.focus()}};function Jd(n){return ae.isObject(n)?new ae(n.x,n.y):new ae}function Qd(n,t){n.writeProperty("x",t.x),n.writeProperty("y",t.y)}function tm(n,t){return new er({assembly:xa,components:[Ut(Object.assign(Object.assign({},n),n.x),t.x),Ut(Object.assign(Object.assign({},n),n.y),t.y)]})}function yo(n,t){var e,s;if(!I(n.min)||!I(n.max))return Math.max(Math.abs((e=n.min)!==null&&e!==void 0?e:0),Math.abs((s=n.max)!==null&&s!==void 0?s:0));const i=$l(n);return Math.max(Math.abs(i)*10,Math.abs(t)*10)}function em(n,t){var e,s;const i=yo(ye(n,(e=n.x)!==null&&e!==void 0?e:{}),t.x),r=yo(ye(n,(s=n.y)!==null&&s!==void 0?s:{}),t.y);return Math.max(i,r)}function nm(n){if(!("y"in n))return!1;const t=n.y;return t&&"inverted"in t?!!t.inverted:!1}const sm=pt({id:"input-point2d",type:"input",accept:(n,t)=>{if(!ae.isObject(n))return null;const e=G(t,s=>Object.assign(Object.assign({},Vn(s)),{expanded:s.optional.boolean,picker:s.optional.custom(ta),readonly:s.optional.constant(!1),x:s.optional.custom(oe),y:s.optional.object(Object.assign(Object.assign({},Vn(s)),{inverted:s.optional.boolean}))}));return e?{initialValue:n,params:e}:null},binding:{reader:()=>Jd,constraint:n=>tm(n.params,n.initialValue),equals:ae.equals,writer:()=>Qd},controller:n=>{var t,e;const s=n.document,i=n.value,r=n.constraint,o=[n.params.x,n.params.y];return new Zd(s,{axes:i.rawValue.getComponents().map((l,a)=>{var c;return Di({constraint:r.components[a],initialValue:l,params:ye(n.params,(c=o[a])!==null&&c!==void 0?c:{})})}),expanded:(t=n.params.expanded)!==null&&t!==void 0?t:!1,invertsY:nm(n.params),max:em(n.params,i.rawValue),parser:Xt,pickerLayout:(e=n.params.picker)!==null&&e!==void 0?e:"popup",value:i,viewProps:n.viewProps})}});let Ue=class{constructor(t=0,e=0,s=0){this.x=t,this.y=e,this.z=s}getComponents(){return[this.x,this.y,this.z]}static isObject(t){if(I(t))return!1;const e=t.x,s=t.y,i=t.z;return!(typeof e!="number"||typeof s!="number"||typeof i!="number")}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}toObject(){return{x:this.x,y:this.y,z:this.z}}};const Pa={toComponents:n=>n.getComponents(),fromComponents:n=>new Ue(...n)};function im(n){return Ue.isObject(n)?new Ue(n.x,n.y,n.z):new Ue}function rm(n,t){n.writeProperty("x",t.x),n.writeProperty("y",t.y),n.writeProperty("z",t.z)}function om(n,t){return new er({assembly:Pa,components:[Ut(Object.assign(Object.assign({},n),n.x),t.x),Ut(Object.assign(Object.assign({},n),n.y),t.y),Ut(Object.assign(Object.assign({},n),n.z),t.z)]})}const lm=pt({id:"input-point3d",type:"input",accept:(n,t)=>{if(!Ue.isObject(n))return null;const e=G(t,s=>Object.assign(Object.assign({},Vn(s)),{readonly:s.optional.constant(!1),x:s.optional.custom(oe),y:s.optional.custom(oe),z:s.optional.custom(oe)}));return e?{initialValue:n,params:e}:null},binding:{reader:n=>im,constraint:n=>om(n.params,n.initialValue),equals:Ue.equals,writer:n=>rm},controller:n=>{const t=n.value,e=n.constraint,s=[n.params.x,n.params.y,n.params.z];return new nr(n.document,{assembly:Pa,axes:t.rawValue.getComponents().map((i,r)=>{var o;return Di({constraint:e.components[r],initialValue:i,params:ye(n.params,(o=s[r])!==null&&o!==void 0?o:{})})}),parser:Xt,value:t,viewProps:n.viewProps})}});let qe=class{constructor(t=0,e=0,s=0,i=0){this.x=t,this.y=e,this.z=s,this.w=i}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(t){if(I(t))return!1;const e=t.x,s=t.y,i=t.z,r=t.w;return!(typeof e!="number"||typeof s!="number"||typeof i!="number"||typeof r!="number")}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}};const Ea={toComponents:n=>n.getComponents(),fromComponents:n=>new qe(...n)};function am(n){return qe.isObject(n)?new qe(n.x,n.y,n.z,n.w):new qe}function cm(n,t){n.writeProperty("x",t.x),n.writeProperty("y",t.y),n.writeProperty("z",t.z),n.writeProperty("w",t.w)}function um(n,t){return new er({assembly:Ea,components:[Ut(Object.assign(Object.assign({},n),n.x),t.x),Ut(Object.assign(Object.assign({},n),n.y),t.y),Ut(Object.assign(Object.assign({},n),n.z),t.z),Ut(Object.assign(Object.assign({},n),n.w),t.w)]})}const pm=pt({id:"input-point4d",type:"input",accept:(n,t)=>{if(!qe.isObject(n))return null;const e=G(t,s=>Object.assign(Object.assign({},Vn(s)),{readonly:s.optional.constant(!1),w:s.optional.custom(oe),x:s.optional.custom(oe),y:s.optional.custom(oe),z:s.optional.custom(oe)}));return e?{initialValue:n,params:e}:null},binding:{reader:n=>am,constraint:n=>um(n.params,n.initialValue),equals:qe.equals,writer:n=>cm},controller:n=>{const t=n.value,e=n.constraint,s=[n.params.x,n.params.y,n.params.z,n.params.w];return new nr(n.document,{assembly:Ea,axes:t.rawValue.getComponents().map((i,r)=>{var o;return Di({constraint:e.components[r],initialValue:i,params:ye(n.params,(o=s[r])!==null&&o!==void 0?o:{})})}),parser:Xt,value:t,viewProps:n.viewProps})}});function hm(n){const t=[],e=Gi(n.options);return e&&t.push(e),new Rn(t)}const dm=pt({id:"input-string",type:"input",accept:(n,t)=>{if(typeof n!="string")return null;const e=G(t,s=>({readonly:s.optional.constant(!1),options:s.optional.custom(Bn)}));return e?{initialValue:n,params:e}:null},binding:{reader:n=>Wl,constraint:n=>hm(n.params),writer:n=>jn},controller:n=>{const t=n.document,e=n.value,s=n.constraint,i=s&&ls(s,Dn);return i?new ue(t,{props:new O({options:i.values.value("options")}),value:e,viewProps:n.viewProps}):new En(t,{parser:r=>r,props:O.fromObject({formatter:_i}),value:e,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="string"?null:n.controller.valueController instanceof ue?new qi(n.controller):null}}),Fn={monitor:{defaultInterval:200,defaultRows:3}},xo=R("mll");let mm=class{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(xo()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("textarea");s.classList.add(xo("i")),s.style.height=`calc(var(${Ql("containerUnitSize")}) * ${e.rows})`,s.readOnly=!0,e.viewProps.bindDisabled(s),this.element.appendChild(s),this.textareaElem_=s,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.textareaElem_,e=t.scrollTop===t.scrollHeight-t.clientHeight,s=[];this.value.rawValue.forEach(i=>{i!==void 0&&s.push(this.formatter_(i))}),t.textContent=s.join(`
`),e&&(t.scrollTop=t.scrollHeight)}onValueUpdate_(){this.update_()}},sr=class{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new mm(t,{formatter:e.formatter,rows:e.rows,value:this.value,viewProps:this.viewProps})}};const Po=R("sgl");let vm=class{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(Po()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("input");s.classList.add(Po("i")),s.readOnly=!0,s.type="text",e.viewProps.bindDisabled(s),this.element.appendChild(s),this.inputElement=s,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=e!==void 0?this.formatter_(e):""}onValueUpdate_(){this.update_()}},ir=class{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new vm(t,{formatter:e.formatter,value:this.value,viewProps:this.viewProps})}};const bm=pt({id:"monitor-bool",type:"monitor",accept:(n,t)=>{if(typeof n!="boolean")return null;const e=G(t,s=>({readonly:s.required.constant(!0),rows:s.optional.number}));return e?{initialValue:n,params:e}:null},binding:{reader:n=>Xl},controller:n=>{var t;return n.value.rawValue.length===1?new ir(n.document,{formatter:bo,value:n.value,viewProps:n.viewProps}):new sr(n.document,{formatter:bo,rows:(t=n.params.rows)!==null&&t!==void 0?t:Fn.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}});let fm=class extends Pn{get max(){return this.controller.valueController.props.get("max")}set max(t){this.controller.valueController.props.set("max",t)}get min(){return this.controller.valueController.props.get("min")}set min(t){this.controller.valueController.props.set("min",t)}};const ee=R("grl");let _m=class{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(ee()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.props_=e.props,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const s=t.createElementNS(Rt,"svg");s.classList.add(ee("g")),s.style.height=`calc(var(${Ql("containerUnitSize")}) * ${e.rows})`,this.element.appendChild(s),this.svgElem_=s;const i=t.createElementNS(Rt,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;const r=t.createElement("div");r.classList.add(ee("t"),R("tt")()),this.element.appendChild(r),this.tooltipElem_=r,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const{clientWidth:t,clientHeight:e}=this.element,s=this.value.rawValue.length-1,i=this.props_.get("min"),r=this.props_.get("max"),o=[];this.value.rawValue.forEach((p,d)=>{if(p===void 0)return;const v=B(d,0,s,0,t),b=B(p,i,r,e,0);o.push([v,b].join(","))}),this.lineElem_.setAttributeNS(null,"points",o.join(" "));const l=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(a===void 0){l.classList.remove(ee("t","a"));return}const c=B(this.cursor_.rawValue,0,s,0,t),u=B(a,i,r,e,0);l.style.left=`${c}px`,l.style.top=`${u}px`,l.textContent=`${this.formatter_(a)}`,l.classList.contains(ee("t","a"))||(l.classList.add(ee("t","a"),ee("t","in")),os(l),l.classList.remove(ee("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}},ka=class{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.cursor_=U(-1),this.view=new _m(t,{cursor:this.cursor_,formatter:e.formatter,rows:e.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!Bi(t))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const s=new Le(this.view.element);s.emitter.on("down",this.onGraphPointerDown_),s.emitter.on("move",this.onGraphPointerMove_),s.emitter.on("up",this.onGraphPointerUp_)}}importProps(t){return vt(t,null,e=>({max:e.required.number,min:e.required.number}),e=>(this.props.set("max",e.max),this.props.set("min",e.min),!0))}exportProps(){return bt(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(t){const{clientWidth:e}=this.view.element;this.cursor_.rawValue=Math.floor(B(t.offsetX,0,e,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){if(!t.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(B(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}};function wi(n){return I(n.format)?dt(2):n.format}function wm(n){var t;return n.value.rawValue.length===1?new ir(n.document,{formatter:wi(n.params),value:n.value,viewProps:n.viewProps}):new sr(n.document,{formatter:wi(n.params),rows:(t=n.params.rows)!==null&&t!==void 0?t:Fn.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}function gm(n){var t,e,s;return new ka(n.document,{formatter:wi(n.params),rows:(t=n.params.rows)!==null&&t!==void 0?t:Fn.monitor.defaultRows,props:O.fromObject({max:(e=n.params.max)!==null&&e!==void 0?e:100,min:(s=n.params.min)!==null&&s!==void 0?s:0}),value:n.value,viewProps:n.viewProps})}function Eo(n){return n.view==="graph"}const Cm=pt({id:"monitor-number",type:"monitor",accept:(n,t)=>{if(typeof n!="number")return null;const e=G(t,s=>({format:s.optional.function,max:s.optional.number,min:s.optional.number,readonly:s.required.constant(!0),rows:s.optional.number,view:s.optional.string}));return e?{initialValue:n,params:e}:null},binding:{defaultBufferSize:n=>Eo(n)?64:1,reader:n=>kl},controller:n=>Eo(n.params)?gm(n):wm(n),api:n=>n.controller.valueController instanceof ka?new fm(n.controller):null}),ym=pt({id:"monitor-string",type:"monitor",accept:(n,t)=>{if(typeof n!="string")return null;const e=G(t,s=>({multiline:s.optional.boolean,readonly:s.required.constant(!0),rows:s.optional.number}));return e?{initialValue:n,params:e}:null},binding:{reader:n=>Wl},controller:n=>{var t;const e=n.value;return e.rawValue.length>1||n.params.multiline?new sr(n.document,{formatter:_i,rows:(t=n.params.rows)!==null&&t!==void 0?t:Fn.monitor.defaultRows,value:e,viewProps:n.viewProps}):new ir(n.document,{formatter:_i,value:e,viewProps:n.viewProps})}});class xm{constructor(){this.map_=new Map}get(t){var e;return(e=this.map_.get(t))!==null&&e!==void 0?e:null}has(t){return this.map_.has(t)}add(t,e){return this.map_.set(t,e),t.viewProps.handleDispose(()=>{this.map_.delete(t)}),e}}class Pm{constructor(t){this.target=t.target,this.reader_=t.reader,this.writer_=t.writer}read(){return this.reader_(this.target.read())}write(t){this.writer_(this.target,t)}inject(t){this.write(this.reader_(t))}}function Em(n,t){var e;const s=n.accept(t.target.read(),t.params);if(I(s))return null;const i={target:t.target,initialValue:s.initialValue,params:s.params},r=G(t.params,p=>({disabled:p.optional.boolean,hidden:p.optional.boolean,label:p.optional.string,tag:p.optional.string})),o=n.binding.reader(i),l=n.binding.constraint?n.binding.constraint(i):void 0,a=new Pm({reader:o,target:t.target,writer:n.binding.writer(i)}),c=new ap(U(o(s.initialValue),{constraint:l,equals:n.binding.equals}),a),u=n.controller({constraint:l,document:t.document,initialValue:s.initialValue,params:s.params,value:c,viewProps:Se.create({disabled:r==null?void 0:r.disabled,hidden:r==null?void 0:r.hidden})});return new xp(t.document,{blade:en(),props:O.fromObject({label:"label"in t.params?(e=r==null?void 0:r.label)!==null&&e!==void 0?e:null:t.target.key}),tag:r==null?void 0:r.tag,value:c,valueController:u})}class km{constructor(t){this.target=t.target,this.reader_=t.reader}read(){return this.reader_(this.target.read())}}function Vm(n,t){return t===0?new rh:new oh(n,t??Fn.monitor.defaultInterval)}function $m(n,t){var e,s,i;const r=n.accept(t.target.read(),t.params);if(I(r))return null;const o={target:t.target,initialValue:r.initialValue,params:r.params},l=G(t.params,d=>({bufferSize:d.optional.number,disabled:d.optional.boolean,hidden:d.optional.boolean,interval:d.optional.number,label:d.optional.string})),a=n.binding.reader(o),c=(s=(e=l==null?void 0:l.bufferSize)!==null&&e!==void 0?e:n.binding.defaultBufferSize&&n.binding.defaultBufferSize(r.params))!==null&&s!==void 0?s:1,u=new $p({binding:new km({reader:a,target:t.target}),bufferSize:c,ticker:Vm(t.document,l==null?void 0:l.interval)}),p=n.controller({document:t.document,params:r.params,value:u,viewProps:Se.create({disabled:l==null?void 0:l.disabled,hidden:l==null?void 0:l.hidden})});return p.viewProps.bindDisabled(u.ticker),p.viewProps.handleDispose(()=>{u.ticker.dispose()}),new Lp(t.document,{blade:en(),props:O.fromObject({label:"label"in t.params?(i=l==null?void 0:l.label)!==null&&i!==void 0?i:null:t.target.key}),value:u,valueController:p})}class Sm{constructor(t){this.pluginsMap_={blades:[],inputs:[],monitors:[]},this.apiCache_=t}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(t,e){if(!wh(e.core))throw it.notCompatible(t,e.id);e.type==="blade"?this.pluginsMap_.blades.unshift(e):e.type==="input"?this.pluginsMap_.inputs.unshift(e):e.type==="monitor"&&this.pluginsMap_.monitors.unshift(e)}createInput_(t,e,s){return this.pluginsMap_.inputs.reduce((i,r)=>i??Em(r,{document:t,target:e,params:s}),null)}createMonitor_(t,e,s){return this.pluginsMap_.monitors.reduce((i,r)=>i??$m(r,{document:t,params:s,target:e}),null)}createBinding(t,e,s){const i=e.read();if(I(i))throw new it({context:{key:e.key},type:"nomatchingcontroller"});const r=this.createInput_(t,e,s);if(r)return r;const o=this.createMonitor_(t,e,s);if(o)return o;throw new it({context:{key:e.key},type:"nomatchingcontroller"})}createBlade(t,e){const s=this.pluginsMap_.blades.reduce((i,r)=>i??ih(r,{document:t,params:e}),null);if(!s)throw new it({type:"nomatchingview",context:{params:e}});return s}createInputBindingApi_(t){const e=this.pluginsMap_.inputs.reduce((s,i)=>{var r,o;return s||((o=(r=i.api)===null||r===void 0?void 0:r.call(i,{controller:t}))!==null&&o!==void 0?o:null)},null);return this.apiCache_.add(t,e??new Pn(t))}createMonitorBindingApi_(t){const e=this.pluginsMap_.monitors.reduce((s,i)=>{var r,o;return s||((o=(r=i.api)===null||r===void 0?void 0:r.call(i,{controller:t}))!==null&&o!==void 0?o:null)},null);return this.apiCache_.add(t,e??new Pn(t))}createBindingApi(t){if(this.apiCache_.has(t))return this.apiCache_.get(t);if(Pp(t))return this.createInputBindingApi_(t);if(Mp(t))return this.createMonitorBindingApi_(t);throw it.shouldNeverHappen()}createApi(t){if(this.apiCache_.has(t))return this.apiCache_.get(t);if(yp(t))return this.createBindingApi(t);const e=this.pluginsMap_.blades.reduce((s,i)=>s??i.api({controller:t,pool:this}),null);if(!e)throw it.shouldNeverHappen();return this.apiCache_.add(t,e)}}const Lm=new xm;function Mm(){const n=new Sm(Lm);return[sm,lm,pm,dm,Gd,zd,Fd,Dd,xh,bm,ym,Cm,Dp,Xp,Gl].forEach(t=>{n.register("core",t)}),n}class Am extends $e{constructor(t){super(t),this.emitter_=new Q,this.controller.value.emitter.on("change",e=>{this.emitter_.emit("change",new On(this,e.rawValue))})}get label(){return this.controller.labelController.props.get("label")}set label(t){this.controller.labelController.props.set("label",t)}get options(){return this.controller.valueController.props.get("options")}set options(t){this.controller.valueController.props.set("options",t)}get value(){return this.controller.value.rawValue}set value(t){this.controller.value.rawValue=t}on(t,e){const s=e.bind(this);return this.emitter_.on(t,i=>{s(i)},{key:e}),this}off(t,e){return this.emitter_.off(t,e),this}}class Tm extends $e{}class Om extends $e{constructor(t){super(t),this.emitter_=new Q,this.controller.value.emitter.on("change",e=>{this.emitter_.emit("change",new On(this,e.rawValue))})}get label(){return this.controller.labelController.props.get("label")}set label(t){this.controller.labelController.props.set("label",t)}get max(){return this.controller.valueController.sliderController.props.get("max")}set max(t){this.controller.valueController.sliderController.props.set("max",t)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(t){this.controller.valueController.sliderController.props.set("min",t)}get value(){return this.controller.value.rawValue}set value(t){this.controller.value.rawValue=t}on(t,e){const s=e.bind(this);return this.emitter_.on(t,i=>{s(i)},{key:e}),this}off(t,e){return this.emitter_.off(t,e),this}}class Rm extends $e{constructor(t){super(t),this.emitter_=new Q,this.controller.value.emitter.on("change",e=>{this.emitter_.emit("change",new On(this,e.rawValue))})}get label(){return this.controller.labelController.props.get("label")}set label(t){this.controller.labelController.props.set("label",t)}get formatter(){return this.controller.valueController.props.get("formatter")}set formatter(t){this.controller.valueController.props.set("formatter",t)}get value(){return this.controller.value.rawValue}set value(t){this.controller.value.rawValue=t}on(t,e){const s=e.bind(this);return this.emitter_.on(t,i=>{s(i)},{key:e}),this}off(t,e){return this.emitter_.off(t,e),this}}const Dm=function(){return{id:"list",type:"blade",core:tn,accept(n){const t=G(n,e=>({options:e.required.custom(Bn),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string}));return t?{params:t}:null},controller(n){const t=new Dn(Hi(n.params.options)),e=U(n.params.value,{constraint:t}),s=new ue(n.document,{props:new O({options:t.values.value("options")}),value:e,viewProps:n.viewProps});return new xe(n.document,{blade:n.blade,props:O.fromObject({label:n.params.label}),value:e,valueController:s})},api(n){return!(n.controller instanceof xe)||!(n.controller.valueController instanceof ue)?null:new Am(n.controller)}}}();class Bm extends Ul{constructor(t,e){super(t,e)}get element(){return this.controller.view.element}}class Nm extends bi{constructor(t,e){super(t,{expanded:e.expanded,blade:e.blade,props:e.props,root:!0,viewProps:e.viewProps})}}const ko=R("spr");class jm{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(ko()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("hr");s.classList.add(ko("r")),this.element.appendChild(s)}}class Vo extends Cs{constructor(t,e){super(Object.assign(Object.assign({},e),{view:new jm(t,{viewProps:e.viewProps})}))}}const Im={id:"separator",type:"blade",core:tn,accept(n){const t=G(n,e=>({view:e.required.constant("separator")}));return t?{params:t}:null},controller(n){return new Vo(n.document,{blade:n.blade,viewProps:n.viewProps})},api(n){return n.controller instanceof Vo?new Tm(n.controller):null}},Fm={id:"slider",type:"blade",core:tn,accept(n){const t=G(n,e=>({max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number}));return t?{params:t}:null},controller(n){var t,e;const s=(t=n.params.value)!==null&&t!==void 0?t:0,i=new Tn({max:n.params.max,min:n.params.min}),r=U(s,{constraint:i}),o=new cs(n.document,Object.assign(Object.assign({},Jl({formatter:(e=n.params.format)!==null&&e!==void 0?e:sp,keyScale:U(1),max:i.values.value("max"),min:i.values.value("min"),pointerScale:Sl(n.params,s)})),{parser:Xt,value:r,viewProps:n.viewProps}));return new xe(n.document,{blade:n.blade,props:O.fromObject({label:n.params.label}),value:r,valueController:o})},api(n){return!(n.controller instanceof xe)||!(n.controller.valueController instanceof cs)?null:new Om(n.controller)}},zm=function(){return{id:"text",type:"blade",core:tn,accept(n){const t=G(n,e=>({parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string}));return t?{params:t}:null},controller(n){var t;const e=U(n.params.value),s=new En(n.document,{parser:n.params.parse,props:O.fromObject({formatter:(t=n.params.format)!==null&&t!==void 0?t:i=>String(i)}),value:e,viewProps:n.viewProps});return new xe(n.document,{blade:n.blade,props:O.fromObject({label:n.params.label}),value:e,valueController:s})},api(n){return!(n.controller instanceof xe)||!(n.controller.valueController instanceof En)?null:new Rm(n.controller)}}}();function Km(n){const t=n.createElement("div");return t.classList.add(R("dfw")()),n.body&&n.body.appendChild(t),t}function Um(n,t,e){if(n.querySelector(`style[data-tp-style=${t}]`))return;const s=n.createElement("style");s.dataset.tpStyle=t,s.textContent=e,n.head.appendChild(s)}class qm extends Bm{constructor(t){var e,s;const i=t??{},r=(e=i.document)!==null&&e!==void 0?e:vp(),o=Mm(),l=new Nm(r,{expanded:i.expanded,blade:en(),props:O.fromObject({title:i.title}),viewProps:Se.create()});super(l,o),this.pool_=o,this.containerElem_=(s=i.container)!==null&&s!==void 0?s:Km(r),this.containerElem_.appendChild(this.element),this.doc_=r,this.usesDefaultWrapper_=!i.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw it.alreadyDisposed();return this.doc_}dispose(){const t=this.containerElem_;if(!t)throw it.alreadyDisposed();if(this.usesDefaultWrapper_){const e=t.parentElement;e&&e.removeChild(t)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(t){t.css&&Um(this.document,`plugin-${t.id}`,t.css),("plugin"in t?[t.plugin]:"plugins"in t?t.plugins:[]).forEach(s=>{this.pool_.register(t.id,s)})}setUpDefaultPlugins_(){this.registerPlugin({id:"default",css:'.tp-tbiv_b,.tp-coltxtv_ms,.tp-colswv_b,.tp-ckbv_i,.tp-sglv_i,.tp-mllv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-rotv_b,.tp-fldv_b,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--bld-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--cnt-usz);line-height:var(--cnt-usz);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tbpv_c>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-vp))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tbpv_c>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--cnt-usp)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tbpv_c>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tbpv_c>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tbpv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tbpv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tbpv_c>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tbpv_c>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--bld-br);border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tbpv_c .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tbpv_c>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tbpv_c>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--bld-br)}.tp-tbpv_c .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--bld-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);overflow:hidden;padding-left:var(--cnt-hp);padding-right:calc(4px + var(--cnt-usz) + var(--cnt-hp));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-hp) + (var(--cnt-usz) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-vp);padding-top:var(--cnt-vp);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--cnt-usz);line-height:var(--cnt-usz);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-sglv_i,.tp-mllv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--mo-fg);height:var(--cnt-usz);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-sglv_i::-webkit-scrollbar,.tp-mllv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-sglv_i::-webkit-scrollbar-corner,.tp-mllv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-sglv_i::-webkit-scrollbar-thumb,.tp-mllv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-rotv{--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-br: var(--tp-base-border-radius, 6px);--bs-ff: var(--tp-base-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--bld-br: var(--tp-blade-border-radius, 2px);--bld-hp: var(--tp-blade-horizontal-padding, 4px);--bld-vw: var(--tp-blade-value-width, 160px);--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--cnt-hp: var(--tp-container-horizontal-padding, 4px);--cnt-vp: var(--tp-container-vertical-padding, 4px);--cnt-usp: var(--tp-container-unit-spacing, 4px);--cnt-usz: var(--tp-container-unit-size, 20px);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--bld-br);cursor:pointer;display:block;height:var(--cnt-usz);position:relative;width:var(--cnt-usz)}.tp-ckbv_w svg{display:block;height:16px;inset:0;margin:auto;opacity:0;position:absolute;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--cnt-usz)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--cnt-usp);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-hp));right:calc(-1*var(--cnt-hp));top:var(--cnt-usz)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--cnt-usp)}.tp-colpv_rgb{display:flex;margin-top:var(--cnt-usp);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-vp);padding-top:calc(var(--cnt-vp) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-hp));position:absolute;right:calc(-1*var(--cnt-hp));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--bld-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--cnt-usz)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{inset:0;position:absolute}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--bld-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;inset:0;position:absolute}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--bld-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{cursor:pointer;display:block;height:var(--cnt-usz);left:0;position:absolute;top:0;width:var(--cnt-usz)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--bld-br);content:"";display:block;inset:0;position:absolute}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--bld-br);color:var(--lbl-fg);cursor:pointer;height:var(--cnt-usz);line-height:var(--cnt-usz);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--cnt-usz)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-hp);padding-right:var(--cnt-hp)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:var(--bld-vw)}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 var(--bld-hp);width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--cnt-usz)*3);line-height:var(--cnt-usz);padding-left:var(--bld-hp);padding-right:var(--bld-hp);resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--cnt-usz);margin-right:4px;position:relative;width:var(--cnt-usz)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--cnt-usp);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-hp));right:calc(-1*var(--cnt-hp));top:var(--cnt-usz)}.tp-p2dpv{padding-left:calc(var(--cnt-usz) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:var(--bld-vw);padding:var(--cnt-vp) var(--cnt-hp);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--cnt-usz);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";display:block;height:2px;inset:0;margin:auto;position:absolute}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;content:"";display:block;height:2px;inset:0;margin-bottom:auto;margin-top:auto;position:absolute}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--bld-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--cnt-usz) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-hp) + 4px);padding-right:calc(var(--cnt-hp) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);content:"";inset:0 0 2px;pointer-events:none;position:absolute}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);opacity:.5;overflow:hidden;position:relative;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-tbpv_c{padding-bottom:var(--cnt-vp);padding-left:4px;padding-top:var(--cnt-vp)}.tp-txtv{position:relative}.tp-txtv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:calc(var(--bld-hp) - 5px);position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--cnt-usz) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--bld-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--bs-ff);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--cnt-usz) + var(--cnt-hp));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0;transition-delay:0s;transition-duration:0s}.tp-rotv.tp-rotv-not>.tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst.tp-fldv-expanded>.tp-fldv_b{transition-delay:0s;transition-duration:0s}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}',plugins:[Dm,Im,Fm,Gl,zm]})}}new zl("4.0.4");function K(n){return n==null}function rr(n){return n!==null&&typeof n=="object"}function gi(n){return n!==null&&typeof n=="object"}function Hm(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function Ee(n,t){return Array.from(new Set([...Object.keys(n),...Object.keys(t)])).reduce((s,i)=>{const r=n[i],o=t[i];return gi(r)&&gi(o)?Object.assign(Object.assign({},s),{[i]:Ee(r,o)}):Object.assign(Object.assign({},s),{[i]:i in t?o:r})},{})}function Gm(n){return rr(n)?"target"in n:!1}const Ym={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>`Invalid parameters for '${n.name}'`,nomatchingcontroller:n=>`No matching controller for '${n.key}'`,nomatchingview:n=>`No matching view for '${JSON.stringify(n.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:n=>`Not compatible with  plugin '${n.id}'`,propertynotfound:n=>`Property '${n.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class at{static alreadyDisposed(){return new at({type:"alreadydisposed"})}static notBindable(){return new at({type:"notbindable"})}static notCompatible(t,e){return new at({type:"notcompatible",context:{id:`${t}.${e}`}})}static propertyNotFound(t){return new at({type:"propertynotfound",context:{name:t}})}static shouldNeverHappen(){return new at({type:"shouldneverhappen"})}constructor(t){var e;this.message=(e=Ym[t.type](t.context))!==null&&e!==void 0?e:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=t.type}toString(){return this.message}}class us{constructor(t,e){this.obj_=t,this.key=e}static isBindable(t){return!(t===null||typeof t!="object"&&typeof t!="function")}read(){return this.obj_[this.key]}write(t){this.obj_[this.key]=t}writeProperty(t,e){const s=this.read();if(!us.isBindable(s))throw at.notBindable();if(!(t in s))throw at.propertyNotFound(t);s[t]=e}}class ot{constructor(){this.observers_={}}on(t,e){let s=this.observers_[t];return s||(s=this.observers_[t]=[]),s.push({handler:e}),this}off(t,e){const s=this.observers_[t];return s&&(this.observers_[t]=s.filter(i=>i.handler!==e)),this}emit(t,e){const s=this.observers_[t];s&&s.forEach(i=>{i.handler(e)})}}class Xm{constructor(t,e){var s;this.constraint_=e==null?void 0:e.constraint,this.equals_=(s=e==null?void 0:e.equals)!==null&&s!==void 0?s:(i,r)=>i===r,this.emitter=new ot,this.rawValue_=t}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const s=e??{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(t):t,r=this.rawValue_;this.equals_(r,i)&&!s.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:s,previousRawValue:r,rawValue:i,sender:this}))}}class Wm{constructor(t){this.emitter=new ot,this.value_=t}get rawValue(){return this.value_}set rawValue(t){this.setRawValue(t,{forceEmit:!1,last:!0})}setRawValue(t,e){const s=e??{forceEmit:!1,last:!0},i=this.value_;i===t&&!s.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=t,this.emitter.emit("change",{options:s,previousRawValue:i,rawValue:this.value_,sender:this}))}}class Zm{constructor(t){this.emitter=new ot,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=t,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(t){this.emitter.emit("beforechange",Object.assign(Object.assign({},t),{sender:this}))}onValueChange_(t){this.emitter.emit("change",Object.assign(Object.assign({},t),{sender:this}))}}function Y(n,t){const e=t==null?void 0:t.constraint,s=t==null?void 0:t.equals;return!e&&!s?new Wm(n):new Xm(n,t)}function Jm(n){return[new Zm(n),(t,e)=>{n.setRawValue(t,e)}]}class E{constructor(t){this.emitter=new ot,this.valMap_=t;for(const e in this.valMap_)this.valMap_[e].emitter.on("change",()=>{this.emitter.emit("change",{key:e,sender:this})})}static createCore(t){return Object.keys(t).reduce((s,i)=>Object.assign(s,{[i]:Y(t[i])}),{})}static fromObject(t){const e=this.createCore(t);return new E(e)}get(t){return this.valMap_[t].rawValue}set(t,e){this.valMap_[t].rawValue=e}value(t){return this.valMap_[t]}}class zn{constructor(t){this.values=E.fromObject({max:t.max,min:t.min})}constrain(t){const e=this.values.get("max"),s=this.values.get("min");return Math.min(Math.max(t,s),e)}}class or{constructor(t){this.values=E.fromObject({max:t.max,min:t.min})}constrain(t){const e=this.values.get("max"),s=this.values.get("min");let i=t;return K(s)||(i=Math.max(i,s)),K(e)||(i=Math.min(i,e)),i}}class Qm{constructor(t,e=0){this.step=t,this.origin=e}constrain(t){const e=this.origin%this.step,s=Math.round((t-e)/this.step);return e+s*this.step}}class tv{constructor(t){this.text=t}evaluate(){return Number(this.text)}toString(){return this.text}}const ev={"**":(n,t)=>Math.pow(n,t),"*":(n,t)=>n*t,"/":(n,t)=>n/t,"%":(n,t)=>n%t,"+":(n,t)=>n+t,"-":(n,t)=>n-t,"<<":(n,t)=>n<<t,">>":(n,t)=>n>>t,">>>":(n,t)=>n>>>t,"&":(n,t)=>n&t,"^":(n,t)=>n^t,"|":(n,t)=>n|t};class nv{constructor(t,e,s){this.left=e,this.operator=t,this.right=s}evaluate(){const t=ev[this.operator];if(!t)throw new Error(`unexpected binary operator: '${this.operator}`);return t(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const sv={"+":n=>n,"-":n=>-n,"~":n=>~n};class iv{constructor(t,e){this.operator=t,this.expression=e}evaluate(){const t=sv[this.operator];if(!t)throw new Error(`unexpected unary operator: '${this.operator}`);return t(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function lr(n){return(t,e)=>{for(let s=0;s<n.length;s++){const i=n[s](t,e);if(i!=="")return i}return""}}function $n(n,t){var e;const s=n.substr(t).match(/^\s+/);return(e=s&&s[0])!==null&&e!==void 0?e:""}function rv(n,t){const e=n.substr(t,1);return e.match(/^[1-9]$/)?e:""}function Sn(n,t){var e;const s=n.substr(t).match(/^[0-9]+/);return(e=s&&s[0])!==null&&e!==void 0?e:""}function ov(n,t){const e=Sn(n,t);if(e!=="")return e;const s=n.substr(t,1);if(t+=1,s!=="-"&&s!=="+")return"";const i=Sn(n,t);return i===""?"":s+i}function ar(n,t){const e=n.substr(t,1);if(t+=1,e.toLowerCase()!=="e")return"";const s=ov(n,t);return s===""?"":e+s}function Va(n,t){const e=n.substr(t,1);if(e==="0")return e;const s=rv(n,t);return t+=s.length,s===""?"":s+Sn(n,t)}function lv(n,t){const e=Va(n,t);if(t+=e.length,e==="")return"";const s=n.substr(t,1);if(t+=s.length,s!==".")return"";const i=Sn(n,t);return t+=i.length,e+s+i+ar(n,t)}function av(n,t){const e=n.substr(t,1);if(t+=e.length,e!==".")return"";const s=Sn(n,t);return t+=s.length,s===""?"":e+s+ar(n,t)}function cv(n,t){const e=Va(n,t);return t+=e.length,e===""?"":e+ar(n,t)}const uv=lr([lv,av,cv]);function pv(n,t){var e;const s=n.substr(t).match(/^[01]+/);return(e=s&&s[0])!==null&&e!==void 0?e:""}function hv(n,t){const e=n.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0b")return"";const s=pv(n,t);return s===""?"":e+s}function dv(n,t){var e;const s=n.substr(t).match(/^[0-7]+/);return(e=s&&s[0])!==null&&e!==void 0?e:""}function mv(n,t){const e=n.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0o")return"";const s=dv(n,t);return s===""?"":e+s}function vv(n,t){var e;const s=n.substr(t).match(/^[0-9a-f]+/i);return(e=s&&s[0])!==null&&e!==void 0?e:""}function bv(n,t){const e=n.substr(t,2);if(t+=e.length,e.toLowerCase()!=="0x")return"";const s=vv(n,t);return s===""?"":e+s}const fv=lr([hv,mv,bv]),_v=lr([fv,uv]);function wv(n,t){const e=_v(n,t);return t+=e.length,e===""?null:{evaluable:new tv(e),cursor:t}}function gv(n,t){const e=n.substr(t,1);if(t+=e.length,e!=="(")return null;const s=Sa(n,t);if(!s)return null;t=s.cursor,t+=$n(n,t).length;const i=n.substr(t,1);return t+=i.length,i!==")"?null:{evaluable:s.evaluable,cursor:t}}function Cv(n,t){var e;return(e=wv(n,t))!==null&&e!==void 0?e:gv(n,t)}function $a(n,t){const e=Cv(n,t);if(e)return e;const s=n.substr(t,1);if(t+=s.length,s!=="+"&&s!=="-"&&s!=="~")return null;const i=$a(n,t);return i?(t=i.cursor,{cursor:t,evaluable:new iv(s,i.evaluable)}):null}function yv(n,t,e){e+=$n(t,e).length;const s=n.filter(i=>t.startsWith(i,e))[0];return s?(e+=s.length,e+=$n(t,e).length,{cursor:e,operator:s}):null}function xv(n,t){return(e,s)=>{const i=n(e,s);if(!i)return null;s=i.cursor;let r=i.evaluable;for(;;){const o=yv(t,e,s);if(!o)break;s=o.cursor;const l=n(e,s);if(!l)return null;s=l.cursor,r=new nv(o.operator,r,l.evaluable)}return r?{cursor:s,evaluable:r}:null}}const Pv=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,t)=>xv(n,t),$a);function Sa(n,t){return t+=$n(n,t).length,Pv(n,t)}function Ev(n){const t=Sa(n,0);return!t||t.cursor+$n(n,t.cursor).length!==n.length?null:t.evaluable}function Vt(n){var t;const e=Ev(n);return(t=e==null?void 0:e.evaluate())!==null&&t!==void 0?t:null}function cr(n){if(typeof n=="number")return n;if(typeof n=="string"){const t=Vt(n);if(!K(t))return t}return 0}function st(n){return t=>t.toFixed(Math.max(Math.min(n,20),0))}function P(n,t,e,s,i){const r=(n-t)/(e-t);return s+r*(i-s)}function $o(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function H(n,t,e){return Math.min(Math.max(n,t),e)}function La(n,t){return(n%t+t)%t}function kv(n,t){return K(n.step)?Math.max($o(t),2):$o(n.step)}function Ma(n){var t;return(t=n.step)!==null&&t!==void 0?t:1}function Vv(n,t){var e;const s=Math.abs((e=n.step)!==null&&e!==void 0?e:t);return s===0?.1:Math.pow(10,Math.floor(Math.log10(s))-1)}function ur(n,t){return K(n.step)?null:new Qm(n.step,t)}function pr(n){return!K(n.max)&&!K(n.min)?new zn({max:n.max,min:n.min}):!K(n.max)||!K(n.min)?new or({max:n.max,min:n.min}):null}function hr(n,t){var e,s,i;return{formatter:(e=n.format)!==null&&e!==void 0?e:st(kv(n,t)),keyScale:(s=n.keyScale)!==null&&s!==void 0?s:Ma(n),pointerScale:(i=n.pointerScale)!==null&&i!==void 0?i:Vv(n,t)}}function dr(n){return{format:n.optional.function,keyScale:n.optional.number,max:n.optional.number,min:n.optional.number,pointerScale:n.optional.number,step:n.optional.number}}function mr(n){return{constraint:n.constraint,textProps:E.fromObject(hr(n.params,n.initialValue))}}class Me{constructor(t){this.controller=t}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(t){this.controller.viewProps.set("disabled",t)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(t){this.controller.viewProps.set("hidden",t)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(t){return this.controller.importState(t)}exportState(){return this.controller.exportState()}}class Ae{constructor(t){this.target=t}}class xs extends Ae{constructor(t,e,s){super(t),this.value=e,this.last=s??!0}}class $v extends Ae{constructor(t,e){super(t),this.expanded=e}}class Sv extends Ae{constructor(t,e){super(t),this.index=e}}class vr extends Me{constructor(t){super(t),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new ot,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(t){this.controller.labelController.props.set("label",t)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(t){this.controller.tag=t}on(t,e){const s=e.bind(this);return this.emitter_.on(t,i=>{s(i)}),this}refresh(){this.controller.value.fetch()}onValueChange_(t){const e=this.controller.value;this.emitter_.emit("change",new xs(this,e.binding.target.read(),t.options.last))}}function Lv(n,t){const s=Object.keys(t).reduce((i,r)=>{if(i===void 0)return;const o=t[r],l=o(n[r]);return l.succeeded?Object.assign(Object.assign({},i),{[r]:l.value}):void 0},{});return s}function Mv(n,t){return n.reduce((e,s)=>{if(e===void 0)return;const i=t(s);if(!(!i.succeeded||i.value===void 0))return[...e,i.value]},[])}function Av(n){return n===null?!1:typeof n=="object"}function Ft(n){return t=>e=>{if(!t&&e===void 0)return{succeeded:!1,value:void 0};if(t&&e===void 0)return{succeeded:!0,value:void 0};const s=n(e);return s!==void 0?{succeeded:!0,value:s}:{succeeded:!1,value:void 0}}}function So(n){return{custom:t=>Ft(t)(n),boolean:Ft(t=>typeof t=="boolean"?t:void 0)(n),number:Ft(t=>typeof t=="number"?t:void 0)(n),string:Ft(t=>typeof t=="string"?t:void 0)(n),function:Ft(t=>typeof t=="function"?t:void 0)(n),constant:t=>Ft(e=>e===t?t:void 0)(n),raw:Ft(t=>t)(n),object:t=>Ft(e=>{if(Av(e))return Lv(e,t)})(n),array:t=>Ft(e=>{if(Array.isArray(e))return Mv(e,t)})(n)}}const Ci={optional:So(!0),required:So(!1)};function X(n,t){const e=t(Ci),s=Ci.required.object(e)(n);return s.succeeded?s.value:void 0}function Lt(n,t,e,s){if(t&&!t(n))return!1;const i=X(n,e);return i?s(i):!1}function Mt(n,t){var e;return Ee((e=n==null?void 0:n())!==null&&e!==void 0?e:{},t)}function ss(n){return"value"in n}function Tv(n){if(!rr(n)||!("binding"in n))return!1;const t=n.binding;return Gm(t)}const et="http://www.w3.org/2000/svg";function ps(n){n.offsetHeight}function Ov(n,t){const e=n.style.transition;n.style.transition="none",t(),n.style.transition=e}function Ps(n){return n.ontouchstart!==void 0}function Rv(n){const t=n.ownerDocument.defaultView;return t&&"document"in t?n.getContext("2d",{willReadFrequently:!0}):null}const Dv={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function Es(n,t){const e=n.createElementNS(et,"svg");return e.innerHTML=Dv[t],e}function Aa(n,t,e){n.insertBefore(t,n.children[e])}function br(n){n.parentElement&&n.parentElement.removeChild(n)}function Ta(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function Bv(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function fr(n){return n.relatedTarget?n.relatedTarget:"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}function yt(n,t){n.emitter.on("change",e=>{t(e.rawValue)}),t(n.rawValue)}function Pt(n,t,e){yt(n.value(t),e)}const Nv="tp";function V(n){return(e,s)=>[Nv,"-",n,"v",e?`_${e}`:"",s?`-${s}`:""].join("")}const bn=V("lbl");function jv(n,t){const e=n.createDocumentFragment();return t.split(`
`).map(i=>n.createTextNode(i)).forEach((i,r)=>{r>0&&e.appendChild(n.createElement("br")),e.appendChild(i)}),e}class Oa{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(bn()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(bn("l")),Pt(e.props,"label",r=>{K(r)?this.element.classList.add(bn(void 0,"nol")):(this.element.classList.remove(bn(void 0,"nol")),Bv(s),s.appendChild(jv(t,r)))}),this.element.appendChild(s),this.labelElement=s;const i=t.createElement("div");i.classList.add(bn("v")),this.element.appendChild(i),this.valueElement=i}}class ks{constructor(t,e){this.props=e.props,this.valueController=e.valueController,this.viewProps=e.valueController.viewProps,this.view=new Oa(t,{props:e.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(t){return Lt(t,null,e=>({label:e.optional.string}),e=>(this.props.set("label",e.label),!0))}exportProps(){return Mt(null,{label:this.props.get("label")})}}function Iv(){return["veryfirst","first","last","verylast"]}const Lo=V(""),Mo={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class Kn{constructor(t){this.parent_=null,this.blade=t.blade,this.view=t.view,this.viewProps=t.viewProps;const e=this.view.element;this.blade.value("positions").emitter.on("change",()=>{Iv().forEach(s=>{e.classList.remove(Lo(void 0,Mo[s]))}),this.blade.get("positions").forEach(s=>{e.classList.add(Lo(void 0,Mo[s]))})}),this.viewProps.handleDispose(()=>{br(e)})}get parent(){return this.parent_}set parent(t){this.parent_=t,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(t){return Lt(t,null,e=>({disabled:e.required.boolean,hidden:e.required.boolean}),e=>(this.viewProps.importState(e),!0))}exportState(){return Mt(null,Object.assign({},this.viewProps.exportState()))}}class hs extends Kn{constructor(t,e){if(e.value!==e.valueController.value)throw at.shouldNeverHappen();const s=e.valueController.viewProps,i=new ks(t,{blade:e.blade,props:e.props,valueController:e.valueController});super(Object.assign(Object.assign({},e),{view:new Oa(t,{props:e.props,viewProps:s}),viewProps:s})),this.labelController=i,this.value=e.value,this.valueController=e.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}importState(t){return Lt(t,e=>{var s,i,r;return super.importState(e)&&this.labelController.importProps(e)&&((r=(i=(s=this.valueController).importProps)===null||i===void 0?void 0:i.call(s,t))!==null&&r!==void 0?r:!0)},e=>({value:e.optional.raw}),e=>(e.value&&(this.value.rawValue=e.value),!0))}exportState(){var t,e,s;return Mt(()=>super.exportState(),Object.assign(Object.assign({value:this.value.rawValue},this.labelController.exportProps()),(s=(e=(t=this.valueController).exportProps)===null||e===void 0?void 0:e.call(t))!==null&&s!==void 0?s:{}))}}function Ra(n,t){for(;n.length<t;)n.push(void 0)}function Fv(n){const t=[];return Ra(t,n),t}function zv(n){const t=n.indexOf(void 0);return t<0?n:n.slice(0,t)}function Kv(n,t){const e=[...zv(n),t];return e.length>n.length?e.splice(0,e.length-n.length):Ra(e,n.length),e}class Uv extends Me{get label(){return this.controller.labelController.props.get("label")}set label(t){this.controller.labelController.props.set("label",t)}get title(){var t;return(t=this.controller.buttonController.props.get("title"))!==null&&t!==void 0?t:""}set title(t){this.controller.buttonController.props.set("title",t)}on(t,e){const s=e.bind(this);return this.controller.buttonController.emitter.on(t,()=>{s(new Ae(this))}),this}}function qv(n,t,e){e?n.classList.add(t):n.classList.remove(t)}function he(n,t){return e=>{qv(n,t,e)}}function _r(n,t){yt(n,e=>{t.textContent=e??""})}const Us=V("btn");class Hv{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Us()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("button");s.classList.add(Us("b")),e.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;const i=t.createElement("div");i.classList.add(Us("t")),_r(e.props.value("title"),i),this.buttonElement.appendChild(i)}}class Da{constructor(t,e){this.emitter=new ot,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new Hv(t,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(t){return Lt(t,null,e=>({title:e.optional.string}),e=>(this.props.set("title",e.title),!0))}exportProps(){return Mt(null,{title:this.props.get("title")})}onClick_(){this.emitter.emit("click",{sender:this})}}class Ao extends Kn{constructor(t,e){const s=new Da(t,{props:e.buttonProps,viewProps:e.viewProps}),i=new ks(t,{blade:e.blade,props:e.labelProps,valueController:s});super({blade:e.blade,view:i.view,viewProps:e.viewProps}),this.buttonController=s,this.labelController=i}importState(t){return Lt(t,e=>super.importState(e)&&this.buttonController.importProps(e)&&this.labelController.importProps(e),()=>({}),()=>!0)}exportState(){return Mt(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}}class Gv{constructor(t){const[e,s]=t.split("-"),i=e.split(".");this.major=parseInt(i[0],10),this.minor=parseInt(i[1],10),this.patch=parseInt(i[2],10),this.prerelease=s??null}toString(){const t=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[t,this.prerelease].join("-"):t}}const Yv=new Gv("2.0.0-beta.2");function W(n){return Object.assign({core:Yv},n)}W({id:"button",type:"blade",accept(n){const t=X(n,e=>({title:e.required.string,view:e.required.constant("button"),label:e.optional.string}));return t?{params:t}:null},controller(n){return new Ao(n.document,{blade:n.blade,buttonProps:E.fromObject({title:n.params.title}),labelProps:E.fromObject({label:n.params.label}),viewProps:n.viewProps})},api(n){return n.controller instanceof Ao?new Uv(n.controller):null}});function Xv(n,t){return n.addBlade(Object.assign(Object.assign({},t),{view:"button"}))}function Wv(n,t){return n.addBlade(Object.assign(Object.assign({},t),{view:"folder"}))}function Zv(n,t){return n.addBlade(Object.assign(Object.assign({},t),{view:"tab"}))}function Jv(n){return rr(n)?"refresh"in n&&typeof n.refresh=="function":!1}function Qv(n,t){if(!us.isBindable(n))throw at.notBindable();return new us(n,t)}class tb{constructor(t,e){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=t,this.emitter_=new ot,this.pool_=e,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(t=>this.pool_.createApi(t))}addBinding(t,e,s){const i=s??{},r=this.controller_.element.ownerDocument,o=this.pool_.createBinding(r,Qv(t,e),i),l=this.pool_.createBindingApi(o);return this.add(l,i.index)}addFolder(t){return Wv(this,t)}addButton(t){return Xv(this,t)}addTab(t){return Zv(this,t)}add(t,e){const s=t.controller;return this.controller_.rack.add(s,e),t}remove(t){this.controller_.rack.remove(t.controller)}addBlade(t){const e=this.controller_.element.ownerDocument,s=this.pool_.createBlade(e,t),i=this.pool_.createApi(s);return this.add(i,t.index)}on(t,e){const s=e.bind(this);return this.emitter_.on(t,i=>{s(i)}),this}refresh(){this.children.forEach(t=>{Jv(t)&&t.refresh()})}onRackValueChange_(t){const e=t.bladeController,s=this.pool_.createApi(e),i=Tv(e.value)?e.value.binding:null;this.emitter_.emit("change",new xs(s,i?i.target.read():e.value.rawValue,t.options.last))}}class wr extends Me{constructor(t,e){super(t),this.rackApi_=new tb(t.rackController,e)}}class gr extends Kn{constructor(t){super({blade:t.blade,view:t.view,viewProps:t.rackController.viewProps}),this.rackController=t.rackController}importState(t){return Lt(t,e=>super.importState(e),e=>({children:e.required.array(e.required.raw)}),e=>this.rackController.rack.children.every((s,i)=>s.importState(e.children[i])))}exportState(){return Mt(()=>super.exportState(),{children:this.rackController.rack.children.map(t=>t.exportState())})}}function yi(n){return"rackController"in n}class eb{constructor(t){this.emitter=new ot,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=t}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(t){for(const e of this.allItems())if(t(e))return e;return null}includes(t){return this.cache_.has(t)}add(t,e){if(this.includes(t))throw at.shouldNeverHappen();const s=e!==void 0?e:this.items_.length;this.items_.splice(s,0,t),this.cache_.add(t);const i=this.extract_(t);i&&(i.emitter.on("add",this.onSubListAdd_),i.emitter.on("remove",this.onSubListRemove_),i.allItems().forEach(r=>{this.cache_.add(r)})),this.emitter.emit("add",{index:s,item:t,root:this,target:this})}remove(t){const e=this.items_.indexOf(t);if(e<0)return;this.items_.splice(e,1),this.cache_.delete(t);const s=this.extract_(t);s&&(s.allItems().forEach(i=>{this.cache_.delete(i)}),s.emitter.off("add",this.onSubListAdd_),s.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:e,item:t,root:this,target:this})}onSubListAdd_(t){this.cache_.add(t.item),this.emitter.emit("add",{index:t.index,item:t.item,root:this,target:t.target})}onSubListRemove_(t){this.cache_.delete(t.item),this.emitter.emit("remove",{index:t.index,item:t.item,root:this,target:t.target})}}function nb(n,t){for(let e=0;e<n.length;e++){const s=n[e];if(ss(s)&&s.value===t)return s}return null}function sb(n){return yi(n)?n.rackController.rack.bcSet_:null}class ib{constructor(t){var e,s;this.emitter=new ot,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(e=t.blade)!==null&&e!==void 0?e:null,(s=this.blade_)===null||s===void 0||s.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=t.viewProps,this.bcSet_=new eb(sb),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(t,e){var s;(s=t.parent)===null||s===void 0||s.remove(t),t.parent=this,this.bcSet_.add(t,e)}remove(t){t.parent=null,this.bcSet_.remove(t)}find(t){return this.bcSet_.allItems().filter(t)}onSetAdd_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("add",{bladeController:t.item,index:t.index,root:e,sender:this}),!e)return;const s=t.item;if(s.viewProps.emitter.on("change",this.onChildViewPropsChange_),s.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),s.viewProps.handleDispose(this.onChildDispose_),ss(s))s.value.emitter.on("change",this.onChildValueChange_);else if(yi(s)){const i=s.rackController.rack;if(i){const r=i.emitter;r.on("layout",this.onRackLayout_),r.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(t){this.updatePositions_();const e=t.target===t.root;if(this.emitter.emit("remove",{bladeController:t.item,root:e,sender:this}),!e)return;const s=t.item;if(ss(s))s.value.emitter.off("change",this.onChildValueChange_);else if(yi(s)){const i=s.rackController.rack;if(i){const r=i.emitter;r.off("layout",this.onRackLayout_),r.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const t=this.bcSet_.items.filter(i=>!i.viewProps.get("hidden")),e=t[0],s=t[t.length-1];this.bcSet_.items.forEach(i=>{const r=[];i===e&&(r.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&r.push("veryfirst")),i===s&&(r.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&r.push("verylast")),i.blade.set("positions",r)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(e=>e.viewProps.get("disposed")).forEach(e=>{this.bcSet_.remove(e)})}onChildValueChange_(t){const e=nb(this.find(ss),t.sender);if(!e)throw at.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:e,options:t.options,sender:this})}onRackLayout_(t){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(t){this.emitter.emit("valuechange",{bladeController:t.bladeController,options:t.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class Cr{constructor(t){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=t.element,this.viewProps=t.viewProps;const e=new ib({blade:t.root?void 0:t.blade,viewProps:t.viewProps});e.emitter.on("add",this.onRackAdd_),e.emitter.on("remove",this.onRackRemove_),this.rack=e,this.viewProps.handleDispose(()=>{for(let s=this.rack.children.length-1;s>=0;s--)this.rack.children[s].viewProps.set("disposed",!0)})}onRackAdd_(t){t.root&&Aa(this.element,t.bladeController.view.element,t.index)}onRackRemove_(t){t.root&&br(t.bladeController.view.element)}}function Ba(){return new E({positions:Y([],{equals:Hm})})}class sn extends E{constructor(t){super(t)}static create(t){const e={completed:!0,expanded:t,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},s=E.createCore(e);return new sn(s)}get styleExpanded(){var t;return(t=this.get("temporaryExpanded"))!==null&&t!==void 0?t:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const t=this.get("expandedHeight");return this.get("shouldFixHeight")&&!K(t)?`${t}px`:"auto"}bindExpandedClass(t,e){const s=()=>{this.styleExpanded?t.classList.add(e):t.classList.remove(e)};Pt(this,"expanded",s),Pt(this,"temporaryExpanded",s)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function rb(n,t){let e=0;return Ov(t,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),ps(t),e=t.clientHeight,n.set("temporaryExpanded",null),ps(t)}),e}function To(n,t){t.style.height=n.styleHeight}function Vs(n,t){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),K(n.get("expandedHeight"))){const e=rb(n,t);e>0&&n.set("expandedHeight",e)}n.set("shouldFixHeight",!0),ps(t)}),n.emitter.on("change",()=>{To(n,t)}),To(n,t),t.addEventListener("transitionend",e=>{e.propertyName==="height"&&n.cleanUpTransition()})}class ob extends wr{constructor(t,e){super(t,e),this.emitter_=new ot,this.controller.foldable.value("expanded").emitter.on("change",s=>{this.emitter_.emit("fold",new $v(this,s.sender.rawValue))}),this.rackApi_.on("change",s=>{this.emitter_.emit("change",s)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(t){this.controller.foldable.set("expanded",t)}get title(){return this.controller.props.get("title")}set title(t){this.controller.props.set("title",t)}get children(){return this.rackApi_.children}addBinding(t,e,s){return this.rackApi_.addBinding(t,e,s)}addFolder(t){return this.rackApi_.addFolder(t)}addButton(t){return this.rackApi_.addButton(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){return this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addBlade(t){return this.rackApi_.addBlade(t)}on(t,e){const s=e.bind(this);return this.emitter_.on(t,i=>{s(i)}),this}refresh(){this.rackApi_.refresh()}}const Na=V("cnt");class lb{constructor(t,e){var s;this.className_=V((s=e.viewName)!==null&&s!==void 0?s:"fld"),this.element=t.createElement("div"),this.element.classList.add(this.className_(),Na()),e.viewProps.bindClassModifiers(this.element),this.foldable_=e.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),Pt(this.foldable_,"completed",he(this.element,this.className_(void 0,"cpl")));const i=t.createElement("button");i.classList.add(this.className_("b")),Pt(e.props,"title",c=>{K(c)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const r=t.createElement("div");r.classList.add(this.className_("i")),this.element.appendChild(r);const o=t.createElement("div");o.classList.add(this.className_("t")),_r(e.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const l=t.createElement("div");l.classList.add(this.className_("m")),this.buttonElement.appendChild(l);const a=t.createElement("div");a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}}class Oo extends gr{constructor(t,e){var s;const i=sn.create((s=e.expanded)!==null&&s!==void 0?s:!0),r=new lb(t,{foldable:i,props:e.props,viewName:e.root?"rot":void 0,viewProps:e.viewProps});super(Object.assign(Object.assign({},e),{rackController:new Cr({blade:e.blade,element:r.containerElement,root:e.root,viewProps:e.viewProps}),view:r})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=e.props,this.foldable=i,Vs(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(t){return Lt(t,e=>super.importState(e),e=>({expanded:e.required.boolean,title:e.optional.string}),e=>(this.foldable.set("expanded",e.expanded),this.props.set("title",e.title),!0))}exportState(){return Mt(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}W({id:"folder",type:"blade",accept(n){const t=X(n,e=>({title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean}));return t?{params:t}:null},controller(n){return new Oo(n.document,{blade:n.blade,expanded:n.params.expanded,props:E.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof Oo?new ob(n.controller,n.pool):null}});const ab=V("");function Ro(n,t){return he(n,ab(void 0,t))}class Zt extends E{constructor(t){var e;super(t),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=Jm(Y(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(e=this.get("parent"))===null||e===void 0||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(t){var e,s,i;const r=t??{};return new Zt(E.createCore({disabled:(e=r.disabled)!==null&&e!==void 0?e:!1,disposed:!1,hidden:(s=r.hidden)!==null&&s!==void 0?s:!1,parent:(i=r.parent)!==null&&i!==void 0?i:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(t){yt(this.globalDisabled_,Ro(t,"disabled")),Pt(this,"hidden",Ro(t,"hidden"))}bindDisabled(t){yt(this.globalDisabled_,e=>{t.disabled=e})}bindTabIndex(t){yt(this.globalDisabled_,e=>{t.tabIndex=e?-1:0})}handleDispose(t){this.value("disposed").emitter.on("change",e=>{e&&t()})}importState(t){this.set("disabled",t.disabled),this.set("hidden",t.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const t=this.get("parent");return(t?t.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(t){var e;const s=t.previousRawValue;s==null||s.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(e=this.get("parent"))===null||e===void 0||e.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}const Do=V("tbp");class cb{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Do()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(Do("c")),this.element.appendChild(s),this.containerElement=s}}const fn=V("tbi");class ub{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(fn()),e.viewProps.bindClassModifiers(this.element),Pt(e.props,"selected",r=>{r?this.element.classList.add(fn(void 0,"sel")):this.element.classList.remove(fn(void 0,"sel"))});const s=t.createElement("button");s.classList.add(fn("b")),e.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;const i=t.createElement("div");i.classList.add(fn("t")),_r(e.props.value("title"),i),this.buttonElement.appendChild(i),this.titleElement=i}}class pb{constructor(t,e){this.emitter=new ot,this.onClick_=this.onClick_.bind(this),this.props=e.props,this.viewProps=e.viewProps,this.view=new ub(t,{props:e.props,viewProps:e.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class xi extends gr{constructor(t,e){const s=new cb(t,{viewProps:e.viewProps});super(Object.assign(Object.assign({},e),{rackController:new Cr({blade:e.blade,element:s.containerElement,viewProps:e.viewProps}),view:s})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new pb(t,{props:e.itemProps,viewProps:Zt.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=e.props,Pt(this.props,"selected",i=>{this.itemController.props.set("selected",i),this.viewProps.set("hidden",!i)})}get itemController(){return this.ic_}importState(t){return Lt(t,e=>super.importState(e),e=>({selected:e.required.boolean,title:e.required.string}),e=>(this.ic_.props.set("selected",e.selected),this.ic_.props.set("title",e.title),!0))}exportState(){return Mt(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}}class hb extends wr{constructor(t,e){super(t,e),this.emitter_=new ot,this.onSelect_=this.onSelect_.bind(this),this.pool_=e,this.rackApi_.on("change",s=>{this.emitter_.emit("change",s)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(t){const e=this.controller.view.element.ownerDocument,s=new xi(e,{blade:Ba(),itemProps:E.fromObject({selected:!1,title:t.title}),props:E.fromObject({selected:!1}),viewProps:Zt.create()}),i=this.pool_.createApi(s);return this.rackApi_.add(i,t.index)}removePage(t){this.rackApi_.remove(this.rackApi_.children[t])}on(t,e){const s=e.bind(this);return this.emitter_.on(t,i=>{s(i)}),this}onSelect_(t){this.emitter_.emit("select",new Sv(this,t.rawValue))}}class db extends wr{get title(){var t;return(t=this.controller.itemController.props.get("title"))!==null&&t!==void 0?t:""}set title(t){this.controller.itemController.props.set("title",t)}get selected(){return this.controller.props.get("selected")}set selected(t){this.controller.props.set("selected",t)}get children(){return this.rackApi_.children}addButton(t){return this.rackApi_.addButton(t)}addFolder(t){return this.rackApi_.addFolder(t)}addTab(t){return this.rackApi_.addTab(t)}add(t,e){this.rackApi_.add(t,e)}remove(t){this.rackApi_.remove(t)}addBinding(t,e,s){return this.rackApi_.addBinding(t,e,s)}addBlade(t){return this.rackApi_.addBlade(t)}refresh(){this.rackApi_.refresh()}}const Bo=-1;class mb{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=Y(!0),this.selectedIndex=Y(Bo),this.items_=[]}add(t,e){const s=e??this.items_.length;this.items_.splice(s,0,t),t.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(t){const e=this.items_.indexOf(t);e<0||(this.items_.splice(e,1),t.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=Bo,this.empty.rawValue=!0;return}const t=this.items_.findIndex(e=>e.rawValue);t<0?(this.items_.forEach((e,s)=>{e.rawValue=s===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((e,s)=>{e.rawValue=s===t}),this.selectedIndex.rawValue=t),this.empty.rawValue=!1}onItemSelectedChange_(t){if(t.rawValue){const e=this.items_.findIndex(s=>s===t.sender);this.items_.forEach((s,i)=>{s.rawValue=i===e}),this.selectedIndex.rawValue=e}else this.keepSelection_()}}const _n=V("tab");class vb{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(_n(),Na()),e.viewProps.bindClassModifiers(this.element),yt(e.empty,he(this.element,_n(void 0,"nop")));const s=t.createElement("div");s.classList.add(_n("t")),this.element.appendChild(s),this.itemsElement=s;const i=t.createElement("div");i.classList.add(_n("i")),this.element.appendChild(i);const r=t.createElement("div");r.classList.add(_n("c")),this.element.appendChild(r),this.contentsElement=r}}class No extends gr{constructor(t,e){const s=new mb,i=new vb(t,{empty:s.empty,viewProps:e.viewProps});super({blade:e.blade,rackController:new Cr({blade:e.blade,element:i.contentsElement,viewProps:e.viewProps}),view:i}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const r=this.rackController.rack;r.emitter.on("add",this.onRackAdd_),r.emitter.on("remove",this.onRackRemove_),this.tab=s}add(t,e){this.rackController.rack.add(t,e)}remove(t){this.rackController.rack.remove(this.rackController.rack.children[t])}onRackAdd_(t){if(!t.root)return;const e=t.bladeController;Aa(this.view.itemsElement,e.itemController.view.element,t.index),e.itemController.viewProps.set("parent",this.viewProps),this.tab.add(e.props.value("selected"))}onRackRemove_(t){if(!t.root)return;const e=t.bladeController;br(e.itemController.view.element),e.itemController.viewProps.set("parent",null),this.tab.remove(e.props.value("selected"))}}W({id:"tab",type:"blade",accept(n){const t=X(n,e=>({pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")}));return!t||t.pages.length===0?null:{params:t}},controller(n){const t=new No(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(e=>{const s=new xi(n.document,{blade:Ba(),itemProps:E.fromObject({selected:!1,title:e.title}),props:E.fromObject({selected:!1}),viewProps:Zt.create()});t.add(s)}),t},api(n){return n.controller instanceof No?new hb(n.controller,n.pool):n.controller instanceof xi?new db(n.controller,n.pool):null}});class yr extends vr{get options(){return this.controller.valueController.props.get("options")}set options(t){this.controller.valueController.props.set("options",t)}}class bb{constructor(){this.disabled=!1,this.emitter=new ot}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class fb{constructor(t,e){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=t,this.emitter=new ot,this.interval_=e,this.setTimer_()}get disabled(){return this.disabled_}set disabled(t){this.disabled_=t,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const t=this.doc_.defaultView;t&&t.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const t=this.doc_.defaultView;t&&(this.timerId_=t.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class rn{constructor(t){this.constraints=t}constrain(t){return this.constraints.reduce((e,s)=>s.constrain(e),t)}}function Ln(n,t){if(n instanceof t)return n;if(n instanceof rn){const e=n.constraints.reduce((s,i)=>s||(i instanceof t?i:null),null);if(e)return e}return null}class $s{constructor(t){this.values=E.fromObject({options:t})}constrain(t){const e=this.values.get("options");return e.length===0||e.filter(i=>i.value===t).length>0?t:e[0].value}}function Ss(n){var t;const e=Ci;if(Array.isArray(n))return(t=X({items:n},s=>({items:s.required.array(s.required.object({text:s.required.string,value:s.required.raw}))})))===null||t===void 0?void 0:t.items;if(typeof n=="object")return e.required.raw(n).value}function ja(n){if(Array.isArray(n))return n;const t=[];return Object.keys(n).forEach(e=>{t.push({text:e,value:n[e]})}),t}function xr(n){return K(n)?null:new $s(ja(n))}const qs=V("lst");class _b{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.element=t.createElement("div"),this.element.classList.add(qs()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("select");s.classList.add(qs("s")),e.viewProps.bindDisabled(s),this.element.appendChild(s),this.selectElement=s;const i=t.createElement("div");i.classList.add(qs("m")),i.appendChild(Es(t,"dropdown")),this.element.appendChild(i),e.value.emitter.on("change",this.onValueChange_),this.value_=e.value,Pt(this.props_,"options",r=>{Ta(this.selectElement),r.forEach(o=>{const l=t.createElement("option");l.textContent=o.text,this.selectElement.appendChild(l)}),this.update_()})}update_(){const t=this.props_.get("options").map(e=>e.value);this.selectElement.selectedIndex=t.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class Xe{constructor(t,e){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new _b(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(t){const e=t.currentTarget;this.value.rawValue=this.props.get("options")[e.selectedIndex].value}importProps(t){return Lt(t,null,e=>({options:e.required.custom(Ss)}),e=>(this.props.set("options",ja(e.options)),!0))}exportProps(){return Mt(null,{options:this.props.get("options")})}}const jo=V("pop");class wb{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(jo()),e.viewProps.bindClassModifiers(this.element),yt(e.shows,he(this.element,jo(void 0,"v")))}}class Pr{constructor(t,e){this.shows=Y(!1),this.viewProps=e.viewProps,this.view=new wb(t,{shows:this.shows,viewProps:this.viewProps})}}const Io=V("txt");class gb{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Io()),e.viewProps.bindClassModifiers(this.element),this.props_=e.props,this.props_.emitter.on("change",this.onChange_);const s=t.createElement("input");s.classList.add(Io("i")),s.type="text",e.viewProps.bindDisabled(s),this.element.appendChild(s),this.inputElement=s,e.value.emitter.on("change",this.onChange_),this.value_=e.value,this.refresh()}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value_.rawValue)}onChange_(){this.refresh()}}class Ls{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=e.parser,this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new gb(t,{props:e.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const s=t.currentTarget.value,i=this.parser_(s);K(i)||(this.value.rawValue=i),this.view.refresh()}}function Cb(n){return String(n)}function Er(n){return n==="false"?!1:!!n}function Fo(n){return Cb(n)}function yb(n){return t=>n.reduce((e,s)=>e!==null?e:s(t),null)}const xb=st(0);function ds(n){return xb(n)+"%"}function kr(n){return String(n)}function Pi(n){return n}function Te({primary:n,secondary:t,forward:e,backward:s}){let i=!1;function r(o){i||(i=!0,o(),i=!1)}n.emitter.on("change",o=>{r(()=>{t.setRawValue(e(n.rawValue,t.rawValue),o.options)})}),t.emitter.on("change",o=>{r(()=>{n.setRawValue(s(n.rawValue,t.rawValue),o.options)}),r(()=>{t.setRawValue(e(n.rawValue,t.rawValue),o.options)})}),r(()=>{t.setRawValue(e(n.rawValue,t.rawValue),{forceEmit:!1,last:!0})})}function nt(n,t){const e=n*(t.altKey?.1:1)*(t.shiftKey?10:1);return t.upKey?+e:t.downKey?-e:0}function ke(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function $t(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function Pb(n){return n==="ArrowUp"||n==="ArrowDown"}function ms(n){return Pb(n)||n==="ArrowLeft"||n==="ArrowRight"}function Hs(n,t){var e,s;const i=t.ownerDocument.defaultView,r=t.getBoundingClientRect();return{x:n.pageX-(((e=i&&i.scrollX)!==null&&e!==void 0?e:0)+r.left),y:n.pageY-(((s=i&&i.scrollY)!==null&&s!==void 0?s:0)+r.top)}}class Jt{constructor(t){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=t,this.emitter=new ot,t.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),t.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),t.addEventListener("touchend",this.onTouchEnd_),t.addEventListener("mousedown",this.onMouseDown_)}computePosition_(t){const e=this.elem_.getBoundingClientRect();return{bounds:{width:e.width,height:e.height},point:t?{x:t.x,y:t.y}:null}}onMouseDown_(t){var e;t.preventDefault(),(e=t.currentTarget)===null||e===void 0||e.focus();const s=this.elem_.ownerDocument;s.addEventListener("mousemove",this.onDocumentMouseMove_),s.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(Hs(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseMove_(t){this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(Hs(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onDocumentMouseUp_(t){const e=this.elem_.ownerDocument;e.removeEventListener("mousemove",this.onDocumentMouseMove_),e.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(Hs(t,this.elem_)),sender:this,shiftKey:t.shiftKey})}onTouchStart_(t){t.preventDefault();const e=t.targetTouches.item(0),s=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-s.left,y:e.clientY-s.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchMove_(t){const e=t.targetTouches.item(0),s=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:t.altKey,data:this.computePosition_(e?{x:e.clientX-s.left,y:e.clientY-s.top}:void 0),sender:this,shiftKey:t.shiftKey}),this.lastTouch_=e}onTouchEnd_(t){var e;const s=(e=t.targetTouches.item(0))!==null&&e!==void 0?e:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:t.altKey,data:this.computePosition_(s?{x:s.clientX-i.left,y:s.clientY-i.top}:void 0),sender:this,shiftKey:t.shiftKey})}}const _t=V("txt");class Eb{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(_t(),_t(void 0,"num")),e.arrayPosition&&this.element.classList.add(_t(void 0,e.arrayPosition)),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("input");s.classList.add(_t("i")),s.type="text",e.viewProps.bindDisabled(s),this.element.appendChild(s),this.inputElement=s,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=e.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(_t()),this.inputElement.classList.add(_t("i"));const i=t.createElement("div");i.classList.add(_t("k")),this.element.appendChild(i),this.knobElement=i;const r=t.createElementNS(et,"svg");r.classList.add(_t("g")),this.knobElement.appendChild(r);const o=t.createElementNS(et,"path");o.classList.add(_t("gb")),r.appendChild(o),this.guideBodyElem_=o;const l=t.createElementNS(et,"path");l.classList.add(_t("gh")),r.appendChild(l),this.guideHeadElem_=l;const a=t.createElement("div");a.classList.add(V("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.refresh()}onDraggingChange_(t){if(t.rawValue===null){this.element.classList.remove(_t(void 0,"drg"));return}this.element.classList.add(_t(void 0,"drg"));const e=t.rawValue/this.props_.get("pointerScale"),s=e+(e>0?-1:e<0?1:0),i=H(-s,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${s+i},0 L${s},4 L${s+i},8`,`M ${e},-1 L${e},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${e},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${e}px`}refresh(){const t=this.props_.get("formatter");this.inputElement.value=t(this.value.rawValue)}onChange_(){this.refresh()}}class Un{constructor(t,e){var s;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=e.parser,this.props=e.props,this.sliderProps_=(s=e.sliderProps)!==null&&s!==void 0?s:null,this.value=e.value,this.viewProps=e.viewProps,this.dragging_=Y(null),this.view=new Eb(t,{arrayPosition:e.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const i=new Jt(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}constrainValue_(t){var e,s;const i=(e=this.sliderProps_)===null||e===void 0?void 0:e.get("min"),r=(s=this.sliderProps_)===null||s===void 0?void 0:s.get("max");let o=t;return i!==void 0&&(o=Math.max(o,i)),r!==void 0&&(o=Math.min(o,r)),o}onInputChange_(t){const s=t.currentTarget.value,i=this.parser_(s);K(i)||(this.value.rawValue=this.constrainValue_(i)),this.view.refresh()}onInputKeyDown_(t){const e=nt(this.props.get("keyScale"),ke(t));e!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+e),{forceEmit:!1,last:!1})}onInputKeyUp_(t){nt(this.props.get("keyScale"),ke(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(t){if(!t.point)return null;const e=t.point.x-t.bounds.width/2;return this.constrainValue_(this.originRawValue_+e*this.props.get("pointerScale"))}onPointerMove_(t){const e=this.computeDraggingValue_(t.data);e!==null&&(this.value.setRawValue(e,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(t){const e=this.computeDraggingValue_(t.data);e!==null&&(this.value.setRawValue(e,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Gs=V("sld");class kb{constructor(t,e){this.onChange_=this.onChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onChange_),this.element=t.createElement("div"),this.element.classList.add(Gs()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(Gs("t")),e.viewProps.bindTabIndex(s),this.element.appendChild(s),this.trackElement=s;const i=t.createElement("div");i.classList.add(Gs("k")),this.trackElement.appendChild(i),this.knobElement=i,e.value.emitter.on("change",this.onChange_),this.value=e.value,this.update_()}update_(){const t=H(P(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${t}%`}onChange_(){this.update_()}}class Vb{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.props=e.props,this.view=new kb(t,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Jt(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){t.point&&this.value.setRawValue(P(H(t.point.x,0,t.bounds.width),0,t.bounds.width,this.props.get("min"),this.props.get("max")),e)}onPointerDownOrMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=nt(this.props.get("keyScale"),$t(t));e!==0&&this.value.setRawValue(this.value.rawValue+e,{forceEmit:!1,last:!1})}onKeyUp_(t){nt(this.props.get("keyScale"),$t(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Ys=V("sldtxt");class $b{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Ys());const s=t.createElement("div");s.classList.add(Ys("s")),this.sliderView_=e.sliderView,s.appendChild(this.sliderView_.element),this.element.appendChild(s);const i=t.createElement("div");i.classList.add(Ys("t")),this.textView_=e.textView,i.appendChild(this.textView_.element),this.element.appendChild(i)}}class zo{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sliderC_=new Vb(t,{props:e.sliderProps,value:e.value,viewProps:this.viewProps}),this.textC_=new Un(t,{parser:e.parser,props:e.textProps,sliderProps:e.sliderProps,value:e.value,viewProps:e.viewProps}),this.view=new $b(t,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(t){return Lt(t,null,e=>({max:e.required.number,min:e.required.number}),e=>{const s=this.sliderC_.props;return s.set("max",e.max),s.set("min",e.min),!0})}exportProps(){const t=this.sliderC_.props;return Mt(null,{max:t.get("max"),min:t.get("min")})}}function Sb(n){return{sliderProps:new E({keyScale:n.keyScale,max:n.max,min:n.min}),textProps:new E({formatter:Y(n.formatter),keyScale:n.keyScale,pointerScale:Y(n.pointerScale)})}}const Lb={containerUnitSize:"cnt-usz"};function Ia(n){return`--${Lb[n]}`}class Fa{constructor(t,e){const s=V(e.viewName);this.element=t.createElement("div"),this.element.classList.add(s()),e.viewProps.bindClassModifiers(this.element)}}function Mn(n){return dr(n)}function le(n){if(gi(n))return X(n,Mn)}function qt(n,t){if(!n)return;const e=[],s=ur(n,t);s&&e.push(s);const i=pr(n);return i&&e.push(i),new rn(e)}function za(n){if(n==="inline"||n==="popup")return n}function de(n,t){n.write(t)}const Wn=V("ckb");class Mb{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(Wn()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("label");s.classList.add(Wn("l")),this.element.appendChild(s);const i=t.createElement("input");i.classList.add(Wn("i")),i.type="checkbox",s.appendChild(i),this.inputElement=i,e.viewProps.bindDisabled(this.inputElement);const r=t.createElement("div");r.classList.add(Wn("w")),s.appendChild(r);const o=Es(t,"check");r.appendChild(o),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class Ab{constructor(t,e){this.onInputChange_=this.onInputChange_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new Mb(t,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(t){const e=t.currentTarget;this.value.rawValue=e.checked}}function Tb(n){const t=[],e=xr(n.options);return e&&t.push(e),new rn(t)}W({id:"input-bool",type:"input",accept:(n,t)=>{if(typeof n!="boolean")return null;const e=X(t,s=>({options:s.optional.custom(Ss),readonly:s.optional.constant(!1)}));return e?{initialValue:n,params:e}:null},binding:{reader:n=>Er,constraint:n=>Tb(n.params),writer:n=>de},controller:n=>{const t=n.document,e=n.value,s=n.constraint,i=s&&Ln(s,$s);return i?new Xe(t,{props:new E({options:i.values.value("options")}),value:e,viewProps:n.viewProps}):new Ab(t,{value:e,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="boolean"?null:n.controller.valueController instanceof Xe?new yr(n.controller):null}});const fe=V("col");class Ob{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(fe()),e.foldable.bindExpandedClass(this.element,fe(void 0,"expanded")),Pt(e.foldable,"completed",he(this.element,fe(void 0,"cpl")));const s=t.createElement("div");s.classList.add(fe("h")),this.element.appendChild(s);const i=t.createElement("div");i.classList.add(fe("s")),s.appendChild(i),this.swatchElement=i;const r=t.createElement("div");if(r.classList.add(fe("t")),s.appendChild(r),this.textElement=r,e.pickerLayout==="inline"){const o=t.createElement("div");o.classList.add(fe("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}}function Rb(n,t,e){const s=H(n/255,0,1),i=H(t/255,0,1),r=H(e/255,0,1),o=Math.max(s,i,r),l=Math.min(s,i,r),a=o-l;let c=0,u=0;const p=(l+o)/2;return a!==0&&(u=a/(1-Math.abs(o+l-1)),s===o?c=(i-r)/a:i===o?c=2+(r-s)/a:c=4+(s-i)/a,c=c/6+(c<0?1:0)),[c*360,u*100,p*100]}function Db(n,t,e){const s=(n%360+360)%360,i=H(t/100,0,1),r=H(e/100,0,1),o=(1-Math.abs(2*r-1))*i,l=o*(1-Math.abs(s/60%2-1)),a=r-o/2;let c,u,p;return s>=0&&s<60?[c,u,p]=[o,l,0]:s>=60&&s<120?[c,u,p]=[l,o,0]:s>=120&&s<180?[c,u,p]=[0,o,l]:s>=180&&s<240?[c,u,p]=[0,l,o]:s>=240&&s<300?[c,u,p]=[l,0,o]:[c,u,p]=[o,0,l],[(c+a)*255,(u+a)*255,(p+a)*255]}function Bb(n,t,e){const s=H(n/255,0,1),i=H(t/255,0,1),r=H(e/255,0,1),o=Math.max(s,i,r),l=Math.min(s,i,r),a=o-l;let c;a===0?c=0:o===s?c=60*(((i-r)/a%6+6)%6):o===i?c=60*((r-s)/a+2):c=60*((s-i)/a+4);const u=o===0?0:a/o,p=o;return[c,u*100,p*100]}function Ka(n,t,e){const s=La(n,360),i=H(t/100,0,1),r=H(e/100,0,1),o=r*i,l=o*(1-Math.abs(s/60%2-1)),a=r-o;let c,u,p;return s>=0&&s<60?[c,u,p]=[o,l,0]:s>=60&&s<120?[c,u,p]=[l,o,0]:s>=120&&s<180?[c,u,p]=[0,o,l]:s>=180&&s<240?[c,u,p]=[0,l,o]:s>=240&&s<300?[c,u,p]=[l,0,o]:[c,u,p]=[o,0,l],[(c+a)*255,(u+a)*255,(p+a)*255]}function Nb(n,t,e){const s=e+t*(100-Math.abs(2*e-100))/200;return[n,s!==0?t*(100-Math.abs(2*e-100))/s:0,e+t*(100-Math.abs(2*e-100))/(2*100)]}function jb(n,t,e){const s=100-Math.abs(e*(200-t)/100-100);return[n,s!==0?t*e/s:0,e*(200-t)/(2*100)]}function jt(n){return[n[0],n[1],n[2]]}function Ms(n,t){return[n[0],n[1],n[2],t]}const Ib={hsl:{hsl:(n,t,e)=>[n,t,e],hsv:Nb,rgb:Db},hsv:{hsl:jb,hsv:(n,t,e)=>[n,t,e],rgb:Ka},rgb:{hsl:Rb,hsv:Bb,rgb:(n,t,e)=>[n,t,e]}};function We(n,t){return[t==="float"?1:n==="rgb"?255:360,t==="float"?1:n==="rgb"?255:100,t==="float"?1:n==="rgb"?255:100]}function Fb(n,t){return n===t?t:La(n,t)}function Ua(n,t,e){var s;const i=We(t,e);return[t==="rgb"?H(n[0],0,i[0]):Fb(n[0],i[0]),H(n[1],0,i[1]),H(n[2],0,i[2]),H((s=n[3])!==null&&s!==void 0?s:1,0,1)]}function Ko(n,t,e,s){const i=We(t,e),r=We(t,s);return n.map((o,l)=>o/i[l]*r[l])}function qa(n,t,e){const s=Ko(n,t.mode,t.type,"int"),i=Ib[t.mode][e.mode](...s);return Ko(i,e.mode,"int",e.type)}class D{static black(){return new D([0,0,0],"rgb")}constructor(t,e){this.type="int",this.mode=e,this.comps_=Ua(t,e,this.type)}getComponents(t){return Ms(qa(jt(this.comps_),{mode:this.mode,type:this.type},{mode:t??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const t=this.getComponents("rgb");return{r:t[0],g:t[1],b:t[2],a:t[3]}}}const ne=V("colp");class zb{constructor(t,e){this.alphaViews_=null,this.element=t.createElement("div"),this.element.classList.add(ne()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(ne("hsv"));const i=t.createElement("div");i.classList.add(ne("sv")),this.svPaletteView_=e.svPaletteView,i.appendChild(this.svPaletteView_.element),s.appendChild(i);const r=t.createElement("div");r.classList.add(ne("h")),this.hPaletteView_=e.hPaletteView,r.appendChild(this.hPaletteView_.element),s.appendChild(r),this.element.appendChild(s);const o=t.createElement("div");if(o.classList.add(ne("rgb")),this.textsView_=e.textsView,o.appendChild(this.textsView_.element),this.element.appendChild(o),e.alphaViews){this.alphaViews_={palette:e.alphaViews.palette,text:e.alphaViews.text};const l=t.createElement("div");l.classList.add(ne("a"));const a=t.createElement("div");a.classList.add(ne("ap")),a.appendChild(this.alphaViews_.palette.element),l.appendChild(a);const c=t.createElement("div");c.classList.add(ne("at")),c.appendChild(this.alphaViews_.text.element),l.appendChild(c),this.element.appendChild(l)}}get allFocusableElements(){const t=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(e=>e.inputElement)];return this.alphaViews_&&t.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),t}}function Kb(n){return n==="int"?"int":n==="float"?"float":void 0}function Vr(n){return X(n,t=>({color:t.optional.object({alpha:t.optional.boolean,type:t.optional.custom(Kb)}),expanded:t.optional.boolean,picker:t.optional.custom(za),readonly:t.optional.constant(!1)}))}function Ve(n){return n?.1:1}function Ha(n){var t;return(t=n.color)===null||t===void 0?void 0:t.type}class $r{constructor(t,e){this.type="float",this.mode=e,this.comps_=Ua(t,e,this.type)}getComponents(t){return Ms(qa(jt(this.comps_),{mode:this.mode,type:this.type},{mode:t??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const t=this.getComponents("rgb");return{r:t[0],g:t[1],b:t[2],a:t[3]}}}const Ub={int:(n,t)=>new D(n,t),float:(n,t)=>new $r(n,t)};function Sr(n,t,e){return Ub[e](n,t)}function qb(n){return n.type==="float"}function Hb(n){return n.type==="int"}function Gb(n){const t=n.getComponents(),e=We(n.mode,"int");return new D([Math.round(P(t[0],0,1,0,e[0])),Math.round(P(t[1],0,1,0,e[1])),Math.round(P(t[2],0,1,0,e[2])),t[3]],n.mode)}function Yb(n){const t=n.getComponents(),e=We(n.mode,"int");return new $r([P(t[0],0,e[0],0,1),P(t[1],0,e[1],0,1),P(t[2],0,e[2],0,1),t[3]],n.mode)}function ut(n,t){if(n.type===t)return n;if(Hb(n)&&t==="float")return Yb(n);if(qb(n)&&t==="int")return Gb(n);throw at.shouldNeverHappen()}function Xb(n,t){return n.alpha===t.alpha&&n.mode===t.mode&&n.notation===t.notation&&n.type===t.type}function Ct(n,t){const e=n.match(/^(.+)%$/);return Math.min(e?parseFloat(e[1])*.01*t:parseFloat(n),t)}const Wb={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function Ga(n){const t=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!t)return parseFloat(n);const e=parseFloat(t[1]),s=t[2];return Wb[s](e)}function Ya(n){const t=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const e=[Ct(t[1],255),Ct(t[2],255),Ct(t[3],255)];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])?null:e}function Zb(n){const t=Ya(n);return t?new D(t,"rgb"):null}function Xa(n){const t=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const e=[Ct(t[1],255),Ct(t[2],255),Ct(t[3],255),Ct(t[4],1)];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])||isNaN(e[3])?null:e}function Jb(n){const t=Xa(n);return t?new D(t,"rgb"):null}function Wa(n){const t=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const e=[Ga(t[1]),Ct(t[2],100),Ct(t[3],100)];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])?null:e}function Qb(n){const t=Wa(n);return t?new D(t,"hsl"):null}function Za(n){const t=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!t)return null;const e=[Ga(t[1]),Ct(t[2],100),Ct(t[3],100),Ct(t[4],1)];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])||isNaN(e[3])?null:e}function tf(n){const t=Za(n);return t?new D(t,"hsl"):null}function Ja(n){const t=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)];const e=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null}function ef(n){const t=Ja(n);return t?new D(t,"rgb"):null}function Qa(n){const t=n.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(t)return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16),P(parseInt(t[4]+t[4],16),0,255,0,1)];const e=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),P(parseInt(e[4],16),0,255,0,1)]:null}function nf(n){const t=Qa(n);return t?new D(t,"rgb"):null}function tc(n){const t=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const e=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])?null:e}function sf(n){return t=>{const e=tc(t);return e?Sr(e,"rgb",n):null}}function ec(n){const t=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!t)return null;const e=[parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]),parseFloat(t[4])];return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])||isNaN(e[3])?null:e}function rf(n){return t=>{const e=ec(t);return e?Sr(e,"rgb",n):null}}const of=[{parser:Ja,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:Qa,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:Ya,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:Xa,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Wa,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:Za,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:tc,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:ec,result:{alpha:!0,mode:"rgb",notation:"object"}}];function lf(n){return of.reduce((t,{parser:e,result:s})=>t||(e(n)?s:null),null)}function af(n,t="int"){const e=lf(n);return e?e.notation==="hex"&&t!=="float"?Object.assign(Object.assign({},e),{type:"int"}):e.notation==="func"?Object.assign(Object.assign({},e),{type:t}):null:null}function qn(n){const t=[ef,nf,Zb,Jb,Qb,tf];t.push(sf("int"),rf("int"));const e=yb(t);return s=>{const i=e(s);return i?ut(i,n):null}}function cf(n){const t=qn("int");if(typeof n!="string")return D.black();const e=t(n);return e??D.black()}function nc(n){const t=H(Math.floor(n),0,255).toString(16);return t.length===1?`0${t}`:t}function Lr(n,t="#"){const e=jt(n.getComponents("rgb")).map(nc).join("");return`${t}${e}`}function Mr(n,t="#"){const e=n.getComponents("rgb"),s=[e[0],e[1],e[2],e[3]*255].map(nc).join("");return`${t}${s}`}function sc(n){const t=st(0),e=ut(n,"int");return`rgb(${jt(e.getComponents("rgb")).map(i=>t(i)).join(", ")})`}function is(n){const t=st(2),e=st(0);return`rgba(${ut(n,"int").getComponents("rgb").map((r,o)=>(o===3?t:e)(r)).join(", ")})`}function uf(n){const t=[st(0),ds,ds],e=ut(n,"int");return`hsl(${jt(e.getComponents("hsl")).map((i,r)=>t[r](i)).join(", ")})`}function pf(n){const t=[st(0),ds,ds,st(2)];return`hsla(${ut(n,"int").getComponents("hsl").map((i,r)=>t[r](i)).join(", ")})`}function ic(n,t){const e=st(t==="float"?2:0),s=["r","g","b"],i=ut(n,t);return`{${jt(i.getComponents("rgb")).map((o,l)=>`${s[l]}: ${e(o)}`).join(", ")}}`}function hf(n){return t=>ic(t,n)}function rc(n,t){const e=st(2),s=st(t==="float"?2:0),i=["r","g","b","a"];return`{${ut(n,t).getComponents("rgb").map((l,a)=>{const c=a===3?e:s;return`${i[a]}: ${c(l)}`}).join(", ")}}`}function df(n){return t=>rc(t,n)}const mf=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:Lr},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:Mr},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:sc},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:is},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:uf},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:pf},...["int","float"].reduce((n,t)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"object",type:t},stringifier:hf(t)},{format:{alpha:!0,mode:"rgb",notation:"object",type:t},stringifier:df(t)}],[])];function oc(n){return mf.reduce((t,e)=>t||(Xb(e.format,n)?e.stringifier:null),null)}const wn=V("apl");class vf{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(wn()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const s=t.createElement("div");s.classList.add(wn("b")),this.element.appendChild(s);const i=t.createElement("div");i.classList.add(wn("c")),s.appendChild(i),this.colorElem_=i;const r=t.createElement("div");r.classList.add(wn("m")),this.element.appendChild(r),this.markerElem_=r;const o=t.createElement("div");o.classList.add(wn("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const t=this.value.rawValue,e=t.getComponents("rgb"),s=new D([e[0],e[1],e[2],0],"rgb"),i=new D([e[0],e[1],e[2],255],"rgb"),r=["to right",is(s),is(i)];this.colorElem_.style.background=`linear-gradient(${r.join(",")})`,this.previewElem_.style.backgroundColor=is(t);const o=P(e[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}}class bf{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new vf(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Jt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const s=t.point.x/t.bounds.width,i=this.value.rawValue,[r,o,l]=i.getComponents("hsv");this.value.setRawValue(new D([r,o,l,s],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=nt(Ve(!0),$t(t));if(e===0)return;const s=this.value.rawValue,[i,r,o,l]=s.getComponents("hsv");this.value.setRawValue(new D([i,r,o,l+e],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){nt(Ve(!0),$t(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Be=V("coltxt");function ff(n){const t=n.createElement("select"),e=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return t.appendChild(e.reduce((s,i)=>{const r=n.createElement("option");return r.textContent=i.text,r.value=i.value,s.appendChild(r),s},n.createDocumentFragment())),t}class _f{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Be()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(Be("m")),this.modeElem_=ff(t),this.modeElem_.classList.add(Be("ms")),s.appendChild(this.modeSelectElement),e.viewProps.bindDisabled(this.modeElem_);const i=t.createElement("div");i.classList.add(Be("mm")),i.appendChild(Es(t,"dropdown")),s.appendChild(i),this.element.appendChild(s);const r=t.createElement("div");r.classList.add(Be("w")),this.element.appendChild(r),this.inputsElem_=r,this.inputViews_=e.inputViews,this.applyInputViews_(),yt(e.mode,o=>{this.modeElem_.value=o})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(t){this.inputViews_=t,this.applyInputViews_()}applyInputViews_(){Ta(this.inputsElem_);const t=this.element.ownerDocument;this.inputViews_.forEach(e=>{const s=t.createElement("div");s.classList.add(Be("c")),s.appendChild(e.element),this.inputsElem_.appendChild(s)})}}function wf(n){return st(n==="float"?2:0)}function gf(n,t,e){const s=We(n,t)[e];return new zn({min:0,max:s})}function Cf(n,t,e){return new Un(n,{arrayPosition:e===0?"fst":e===2?"lst":"mid",parser:t.parser,props:E.fromObject({formatter:wf(t.colorType),keyScale:Ve(!1),pointerScale:t.colorType==="float"?.01:1}),value:Y(0,{constraint:gf(t.colorMode,t.colorType,e)}),viewProps:t.viewProps})}function yf(n,t){const e={colorMode:t.colorMode,colorType:t.colorType,parser:Vt,viewProps:t.viewProps};return[0,1,2].map(s=>{const i=Cf(n,e,s);return Te({primary:t.value,secondary:i.value,forward(r){return ut(r,t.colorType).getComponents(t.colorMode)[s]},backward(r,o){const l=t.colorMode,c=ut(r,t.colorType).getComponents(l);c[s]=o;const u=Sr(Ms(jt(c),c[3]),l,t.colorType);return ut(u,"int")}}),i})}function xf(n,t){const e=new Ls(n,{parser:qn("int"),props:E.fromObject({formatter:Lr}),value:Y(D.black()),viewProps:t.viewProps});return Te({primary:t.value,secondary:e.value,forward:s=>new D(jt(s.getComponents()),s.mode),backward:(s,i)=>new D(Ms(jt(i.getComponents(s.mode)),s.getComponents()[3]),s.mode)}),[e]}function Pf(n){return n!=="hex"}class Ef{constructor(t,e){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=e.colorType,this.value=e.value,this.viewProps=e.viewProps,this.colorMode=Y(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(t),this.view=new _f(t,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(t){const e=this.colorMode.rawValue;return Pf(e)?yf(t,{colorMode:e,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):xf(t,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(t){const e=t.currentTarget;this.colorMode.rawValue=e.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(s=>s.view)}}const Xs=V("hpl");class kf{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Xs()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const s=t.createElement("div");s.classList.add(Xs("c")),this.element.appendChild(s);const i=t.createElement("div");i.classList.add(Xs("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const t=this.value.rawValue,[e]=t.getComponents("hsv");this.markerElem_.style.backgroundColor=sc(new D([e,100,100],"hsv"));const s=P(e,0,360,0,100);this.markerElem_.style.left=`${s}%`}onValueChange_(){this.update_()}}class Vf{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new kf(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Jt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const s=P(H(t.point.x,0,t.bounds.width),0,t.bounds.width,0,360),i=this.value.rawValue,[,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new D([s,r,o,l],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){const e=nt(Ve(!1),$t(t));if(e===0)return;const s=this.value.rawValue,[i,r,o,l]=s.getComponents("hsv");this.value.setRawValue(new D([i+e,r,o,l],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){nt(Ve(!1),$t(t))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Ws=V("svp"),Uo=64;class $f{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.element=t.createElement("div"),this.element.classList.add(Ws()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const s=t.createElement("canvas");s.height=Uo,s.width=Uo,s.classList.add(Ws("c")),this.element.appendChild(s),this.canvasElement=s;const i=t.createElement("div");i.classList.add(Ws("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const t=Rv(this.canvasElement);if(!t)return;const s=this.value.rawValue.getComponents("hsv"),i=this.canvasElement.width,r=this.canvasElement.height,o=t.getImageData(0,0,i,r),l=o.data;for(let u=0;u<r;u++)for(let p=0;p<i;p++){const d=P(p,0,i,0,100),v=P(u,0,r,100,0),b=Ka(s[0],d,v),y=(u*i+p)*4;l[y]=b[0],l[y+1]=b[1],l[y+2]=b[2],l[y+3]=255}t.putImageData(o,0,0);const a=P(s[1],0,100,0,100);this.markerElem_.style.left=`${a}%`;const c=P(s[2],0,100,100,0);this.markerElem_.style.top=`${c}%`}onValueChange_(){this.update_()}}class Sf{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.view=new $f(t,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Jt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const s=P(t.point.x,0,t.bounds.width,0,100),i=P(t.point.y,0,t.bounds.height,100,0),[r,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new D([r,s,i,o],"hsv"),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onKeyDown_(t){ms(t.key)&&t.preventDefault();const[e,s,i,r]=this.value.rawValue.getComponents("hsv"),o=Ve(!1),l=nt(o,$t(t)),a=nt(o,ke(t));l===0&&a===0||this.value.setRawValue(new D([e,s+l,i+a,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(t){const e=Ve(!1),s=nt(e,$t(t)),i=nt(e,ke(t));s===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Lf{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.hPaletteC_=new Vf(t,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Sf(t,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=e.supportsAlpha?{palette:new bf(t,{value:this.value,viewProps:this.viewProps}),text:new Un(t,{parser:Vt,props:E.fromObject({pointerScale:.01,keyScale:.1,formatter:st(2)}),value:Y(0,{constraint:new zn({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Te({primary:this.value,secondary:this.alphaIcs_.text.value,forward:s=>s.getComponents()[3],backward:(s,i)=>{const r=s.getComponents();return r[3]=i,new D(r,s.mode)}}),this.textsC_=new Ef(t,{colorType:e.colorType,value:this.value,viewProps:this.viewProps}),this.view=new zb(t,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:e.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}}const Zs=V("colsw");class Mf{constructor(t,e){this.onValueChange_=this.onValueChange_.bind(this),e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.element=t.createElement("div"),this.element.classList.add(Zs()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(Zs("sw")),this.element.appendChild(s),this.swatchElem_=s;const i=t.createElement("button");i.classList.add(Zs("b")),e.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i,this.update_()}update_(){const t=this.value.rawValue;this.swatchElem_.style.backgroundColor=Mr(t)}onValueChange_(){this.update_()}}class Af{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new Mf(t,{value:this.value,viewProps:this.viewProps})}}class Ar{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=sn.create(e.expanded),this.swatchC_=new Af(t,{value:this.value,viewProps:this.viewProps});const s=this.swatchC_.view.buttonElement;s.addEventListener("blur",this.onButtonBlur_),s.addEventListener("click",this.onButtonClick_),this.textC_=new Ls(t,{parser:e.parser,props:E.fromObject({formatter:e.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new Ob(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=e.pickerLayout==="popup"?new Pr(t,{viewProps:this.viewProps}):null;const i=new Lf(t,{colorType:e.colorType,supportsAlpha:e.supportsAlpha,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach(r=>{r.addEventListener("blur",this.onPopupChildBlur_),r.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(i.view.element),Te({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:r=>r,backward:(r,o)=>o})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Vs(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,s=t.relatedTarget;(!s||!e.contains(s))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,s=fr(t);s&&e.contains(s)||s&&s===this.swatchC_.view.buttonElement&&!Ps(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?t.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&t.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function Tf(n){return jt(n.getComponents("rgb")).reduce((t,e)=>t<<8|Math.floor(e)&255,0)}function Of(n){return n.getComponents("rgb").reduce((t,e,s)=>{const i=Math.floor(s===3?e*255:e)&255;return t<<8|i},0)>>>0}function Rf(n){return new D([n>>16&255,n>>8&255,n&255],"rgb")}function Df(n){return new D([n>>24&255,n>>16&255,n>>8&255,P(n&255,0,255,0,1)],"rgb")}function Bf(n){return typeof n!="number"?D.black():Rf(n)}function Nf(n){return typeof n!="number"?D.black():Df(n)}function rs(n,t){return typeof n!="object"||K(n)?!1:t in n&&typeof n[t]=="number"}function lc(n){return rs(n,"r")&&rs(n,"g")&&rs(n,"b")}function ac(n){return lc(n)&&rs(n,"a")}function cc(n){return lc(n)}function Tr(n,t){if(n.mode!==t.mode||n.type!==t.type)return!1;const e=n.getComponents(),s=t.getComponents();for(let i=0;i<e.length;i++)if(e[i]!==s[i])return!1;return!0}function qo(n){return"a"in n?[n.r,n.g,n.b,n.a]:[n.r,n.g,n.b]}function jf(n){const t=oc(n);return t?(e,s)=>{de(e,t(s))}:null}function If(n){const t=n?Of:Tf;return(e,s)=>{de(e,t(s))}}function Ff(n,t,e){const i=ut(t,e).toRgbaObject();n.writeProperty("r",i.r),n.writeProperty("g",i.g),n.writeProperty("b",i.b),n.writeProperty("a",i.a)}function zf(n,t,e){const i=ut(t,e).toRgbaObject();n.writeProperty("r",i.r),n.writeProperty("g",i.g),n.writeProperty("b",i.b)}function Kf(n,t){return(e,s)=>{n?Ff(e,s,t):zf(e,s,t)}}function Uf(n){var t;return!!(!((t=n==null?void 0:n.color)===null||t===void 0)&&t.alpha)}function qf(n){return n?t=>Mr(t,"0x"):t=>Lr(t,"0x")}function Hf(n){return"color"in n||n.view==="color"}W({id:"input-color-number",type:"input",accept:(n,t)=>{if(typeof n!="number"||!Hf(t))return null;const e=Vr(t);return e?{initialValue:n,params:Object.assign(Object.assign({},e),{supportsAlpha:Uf(t)})}:null},binding:{reader:n=>n.params.supportsAlpha?Nf:Bf,equals:Tr,writer:n=>If(n.params.supportsAlpha)},controller:n=>{var t,e;return new Ar(n.document,{colorType:"int",expanded:(t=n.params.expanded)!==null&&t!==void 0?t:!1,formatter:qf(n.params.supportsAlpha),parser:qn("int"),pickerLayout:(e=n.params.picker)!==null&&e!==void 0?e:"popup",supportsAlpha:n.params.supportsAlpha,value:n.value,viewProps:n.viewProps})}});function Gf(n,t){if(!cc(n))return ut(D.black(),t);if(t==="int"){const e=qo(n);return new D(e,"rgb")}if(t==="float"){const e=qo(n);return new $r(e,"rgb")}return ut(D.black(),"int")}function Yf(n){return ac(n)}function Xf(n){return t=>{const e=Gf(t,n);return ut(e,"int")}}function Wf(n,t){return e=>n?rc(e,t):ic(e,t)}W({id:"input-color-object",type:"input",accept:(n,t)=>{var e;if(!cc(n))return null;const s=Vr(t);return s?{initialValue:n,params:Object.assign(Object.assign({},s),{colorType:(e=Ha(t))!==null&&e!==void 0?e:"int"})}:null},binding:{reader:n=>Xf(n.params.colorType),equals:Tr,writer:n=>Kf(Yf(n.initialValue),n.params.colorType)},controller:n=>{var t,e;const s=ac(n.initialValue);return new Ar(n.document,{colorType:n.params.colorType,expanded:(t=n.params.expanded)!==null&&t!==void 0?t:!1,formatter:Wf(s,n.params.colorType),parser:qn("int"),pickerLayout:(e=n.params.picker)!==null&&e!==void 0?e:"popup",supportsAlpha:s,value:n.value,viewProps:n.viewProps})}});W({id:"input-color-string",type:"input",accept:(n,t)=>{if(typeof n!="string"||t.view==="text")return null;const e=af(n,Ha(t));if(!e)return null;const s=oc(e);if(!s)return null;const i=Vr(t);return i?{initialValue:n,params:Object.assign(Object.assign({},i),{format:e,stringifier:s})}:null},binding:{reader:()=>cf,equals:Tr,writer:n=>{const t=jf(n.params.format);if(!t)throw at.notBindable();return t}},controller:n=>{var t,e;return new Ar(n.document,{colorType:n.params.format.type,expanded:(t=n.params.expanded)!==null&&t!==void 0?t:!1,formatter:n.params.stringifier,parser:qn("int"),pickerLayout:(e=n.params.picker)!==null&&e!==void 0?e:"popup",supportsAlpha:n.params.format.alpha,value:n.value,viewProps:n.viewProps})}});class As{constructor(t){this.components=t.components,this.asm_=t.assembly}constrain(t){const e=this.asm_.toComponents(t).map((s,i)=>{var r,o;return(o=(r=this.components[i])===null||r===void 0?void 0:r.constrain(s))!==null&&o!==void 0?o:s});return this.asm_.fromComponents(e)}}const Ho=V("pndtxt");class Zf{constructor(t,e){this.textViews=e.textViews,this.element=t.createElement("div"),this.element.classList.add(Ho()),this.textViews.forEach(s=>{const i=t.createElement("div");i.classList.add(Ho("a")),i.appendChild(s.element),this.element.appendChild(i)})}}function Jf(n,t,e){return new Un(n,{arrayPosition:e===0?"fst":e===t.axes.length-1?"lst":"mid",parser:t.parser,props:t.axes[e].textProps,value:Y(0,{constraint:t.axes[e].constraint}),viewProps:t.viewProps})}class on{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.acs_=e.axes.map((s,i)=>Jf(t,e,i)),this.acs_.forEach((s,i)=>{Te({primary:this.value,secondary:s.value,forward:r=>e.assembly.toComponents(r)[i],backward:(r,o)=>{const l=e.assembly.toComponents(r);return l[i]=o,e.assembly.fromComponents(l)}})}),this.view=new Zf(t,{textViews:this.acs_.map(s=>s.view)})}get textControllers(){return this.acs_}}class Qf extends vr{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(t){this.controller.valueController.sliderController.props.set("max",t)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(t){this.controller.valueController.sliderController.props.set("min",t)}}function t_(n,t){const e=[],s=ur(n,t);s&&e.push(s);const i=pr(n);i&&e.push(i);const r=xr(n.options);return r&&e.push(r),new rn(e)}W({id:"input-number",type:"input",accept:(n,t)=>{if(typeof n!="number")return null;const e=X(t,s=>Object.assign(Object.assign({},dr(s)),{options:s.optional.custom(Ss),readonly:s.optional.constant(!1)}));return e?{initialValue:n,params:e}:null},binding:{reader:n=>cr,constraint:n=>t_(n.params,n.initialValue),writer:n=>de},controller:n=>{const t=n.value,e=n.constraint,s=e&&Ln(e,$s);if(s)return new Xe(n.document,{props:new E({options:s.values.value("options")}),value:t,viewProps:n.viewProps});const i=hr(n.params,t.rawValue),r=e&&Ln(e,zn);return r?new zo(n.document,Object.assign(Object.assign({},Sb(Object.assign(Object.assign({},i),{keyScale:Y(i.keyScale),max:r.values.value("max"),min:r.values.value("min")}))),{parser:Vt,value:t,viewProps:n.viewProps})):new Un(n.document,{parser:Vt,props:E.fromObject(i),value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="number"?null:n.controller.valueController instanceof zo?new Qf(n.controller):n.controller.valueController instanceof Xe?new yr(n.controller):null}});class ce{constructor(t=0,e=0){this.x=t,this.y=e}getComponents(){return[this.x,this.y]}static isObject(t){if(K(t))return!1;const e=t.x,s=t.y;return!(typeof e!="number"||typeof s!="number")}static equals(t,e){return t.x===e.x&&t.y===e.y}toObject(){return{x:this.x,y:this.y}}}const uc={toComponents:n=>n.getComponents(),fromComponents:n=>new ce(...n)},Ne=V("p2d");class e_{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Ne()),e.viewProps.bindClassModifiers(this.element),yt(e.expanded,he(this.element,Ne(void 0,"expanded")));const s=t.createElement("div");s.classList.add(Ne("h")),this.element.appendChild(s);const i=t.createElement("button");i.classList.add(Ne("b")),i.appendChild(Es(t,"p2dpad")),e.viewProps.bindDisabled(i),s.appendChild(i),this.buttonElement=i;const r=t.createElement("div");if(r.classList.add(Ne("t")),s.appendChild(r),this.textElement=r,e.pickerLayout==="inline"){const o=t.createElement("div");o.classList.add(Ne("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}}const se=V("p2dp");class n_{constructor(t,e){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=e.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=t.createElement("div"),this.element.classList.add(se()),e.layout==="popup"&&this.element.classList.add(se(void 0,"p")),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(se("p")),e.viewProps.bindTabIndex(s),this.element.appendChild(s),this.padElement=s;const i=t.createElementNS(et,"svg");i.classList.add(se("g")),this.padElement.appendChild(i),this.svgElem_=i;const r=t.createElementNS(et,"line");r.classList.add(se("ax")),r.setAttributeNS(null,"x1","0"),r.setAttributeNS(null,"y1","50%"),r.setAttributeNS(null,"x2","100%"),r.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(r);const o=t.createElementNS(et,"line");o.classList.add(se("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const l=t.createElementNS(et,"line");l.classList.add(se("l")),l.setAttributeNS(null,"x1","50%"),l.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(l),this.lineElem_=l;const a=t.createElement("div");a.classList.add(se("m")),this.padElement.appendChild(a),this.markerElem_=a,e.value.emitter.on("change",this.onValueChange_),this.value=e.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[t,e]=this.value.rawValue.getComponents(),s=this.props_.get("max"),i=P(t,-s,+s,0,100),r=P(e,-s,+s,0,100),o=this.props_.get("invertsY")?100-r:r;this.lineElem_.setAttributeNS(null,"x2",`${i}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${i}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}}function Go(n,t,e){return[nt(t[0],$t(n)),nt(t[1],ke(n))*(e?1:-1)]}class s_{constructor(t,e){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.view=new n_(t,{layout:e.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Jt(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(t,e){if(!t.point)return;const s=this.props.get("max"),i=P(t.point.x,0,t.bounds.width,-s,+s),r=P(this.props.get("invertsY")?t.bounds.height-t.point.y:t.point.y,0,t.bounds.height,-s,+s);this.value.setRawValue(new ce(i,r),e)}onPointerDown_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerMove_(t){this.handlePointerEvent_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.handlePointerEvent_(t.data,{forceEmit:!0,last:!0})}onPadKeyDown_(t){ms(t.key)&&t.preventDefault();const[e,s]=Go(t,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));e===0&&s===0||this.value.setRawValue(new ce(this.value.rawValue.x+e,this.value.rawValue.y+s),{forceEmit:!1,last:!1})}onPadKeyUp_(t){const[e,s]=Go(t,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));e===0&&s===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class i_{constructor(t,e){var s,i;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=sn.create(e.expanded),this.popC_=e.pickerLayout==="popup"?new Pr(t,{viewProps:this.viewProps}):null;const r=new s_(t,{layout:e.pickerLayout,props:new E({invertsY:Y(e.invertsY),max:Y(e.max),xKeyScale:e.axes[0].textProps.value("keyScale"),yKeyScale:e.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach(o=>{o.addEventListener("blur",this.onPopupChildBlur_),o.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=r,this.textC_=new on(t,{assembly:uc,axes:e.axes,parser:e.parser,value:this.value,viewProps:this.viewProps}),this.view=new e_(t,{expanded:this.foldable_.value("expanded"),pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(s=this.view.buttonElement)===null||s===void 0||s.addEventListener("blur",this.onPadButtonBlur_),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Te({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:o=>o,backward:(o,l)=>l})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Vs(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(t){if(!this.popC_)return;const e=this.view.element,s=t.relatedTarget;(!s||!e.contains(s))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,s=fr(t);s&&e.contains(s)||s&&s===this.view.buttonElement&&!Ps(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_?t.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&t.key==="Escape"&&this.view.buttonElement.focus()}}function r_(n){return ce.isObject(n)?new ce(n.x,n.y):new ce}function o_(n,t){n.writeProperty("x",t.x),n.writeProperty("y",t.y)}function l_(n,t){return new As({assembly:uc,components:[qt(Object.assign(Object.assign({},n),n.x),t.x),qt(Object.assign(Object.assign({},n),n.y),t.y)]})}function Yo(n,t){var e,s;if(!K(n.min)||!K(n.max))return Math.max(Math.abs((e=n.min)!==null&&e!==void 0?e:0),Math.abs((s=n.max)!==null&&s!==void 0?s:0));const i=Ma(n);return Math.max(Math.abs(i)*10,Math.abs(t)*10)}function a_(n,t){var e,s;const i=Yo(Ee(n,(e=n.x)!==null&&e!==void 0?e:{}),t.x),r=Yo(Ee(n,(s=n.y)!==null&&s!==void 0?s:{}),t.y);return Math.max(i,r)}function c_(n){if(!("y"in n))return!1;const t=n.y;return t&&"inverted"in t?!!t.inverted:!1}W({id:"input-point2d",type:"input",accept:(n,t)=>{if(!ce.isObject(n))return null;const e=X(t,s=>Object.assign(Object.assign({},Mn(s)),{expanded:s.optional.boolean,picker:s.optional.custom(za),readonly:s.optional.constant(!1),x:s.optional.custom(le),y:s.optional.object(Object.assign(Object.assign({},Mn(s)),{inverted:s.optional.boolean}))}));return e?{initialValue:n,params:e}:null},binding:{reader:()=>r_,constraint:n=>l_(n.params,n.initialValue),equals:ce.equals,writer:()=>o_},controller:n=>{var t,e;const s=n.document,i=n.value,r=n.constraint,o=[n.params.x,n.params.y];return new i_(s,{axes:i.rawValue.getComponents().map((l,a)=>{var c;return mr({constraint:r.components[a],initialValue:l,params:Ee(n.params,(c=o[a])!==null&&c!==void 0?c:{})})}),expanded:(t=n.params.expanded)!==null&&t!==void 0?t:!1,invertsY:c_(n.params),max:a_(n.params,i.rawValue),parser:Vt,pickerLayout:(e=n.params.picker)!==null&&e!==void 0?e:"popup",value:i,viewProps:n.viewProps})}});class He{constructor(t=0,e=0,s=0){this.x=t,this.y=e,this.z=s}getComponents(){return[this.x,this.y,this.z]}static isObject(t){if(K(t))return!1;const e=t.x,s=t.y,i=t.z;return!(typeof e!="number"||typeof s!="number"||typeof i!="number")}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const pc={toComponents:n=>n.getComponents(),fromComponents:n=>new He(...n)};function u_(n){return He.isObject(n)?new He(n.x,n.y,n.z):new He}function p_(n,t){n.writeProperty("x",t.x),n.writeProperty("y",t.y),n.writeProperty("z",t.z)}function h_(n,t){return new As({assembly:pc,components:[qt(Object.assign(Object.assign({},n),n.x),t.x),qt(Object.assign(Object.assign({},n),n.y),t.y),qt(Object.assign(Object.assign({},n),n.z),t.z)]})}W({id:"input-point3d",type:"input",accept:(n,t)=>{if(!He.isObject(n))return null;const e=X(t,s=>Object.assign(Object.assign({},Mn(s)),{readonly:s.optional.constant(!1),x:s.optional.custom(le),y:s.optional.custom(le),z:s.optional.custom(le)}));return e?{initialValue:n,params:e}:null},binding:{reader:n=>u_,constraint:n=>h_(n.params,n.initialValue),equals:He.equals,writer:n=>p_},controller:n=>{const t=n.value,e=n.constraint,s=[n.params.x,n.params.y,n.params.z];return new on(n.document,{assembly:pc,axes:t.rawValue.getComponents().map((i,r)=>{var o;return mr({constraint:e.components[r],initialValue:i,params:Ee(n.params,(o=s[r])!==null&&o!==void 0?o:{})})}),parser:Vt,value:t,viewProps:n.viewProps})}});class Ge{constructor(t=0,e=0,s=0,i=0){this.x=t,this.y=e,this.z=s,this.w=i}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(t){if(K(t))return!1;const e=t.x,s=t.y,i=t.z,r=t.w;return!(typeof e!="number"||typeof s!="number"||typeof i!="number"||typeof r!="number")}static equals(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const hc={toComponents:n=>n.getComponents(),fromComponents:n=>new Ge(...n)};function d_(n){return Ge.isObject(n)?new Ge(n.x,n.y,n.z,n.w):new Ge}function m_(n,t){n.writeProperty("x",t.x),n.writeProperty("y",t.y),n.writeProperty("z",t.z),n.writeProperty("w",t.w)}function v_(n,t){return new As({assembly:hc,components:[qt(Object.assign(Object.assign({},n),n.x),t.x),qt(Object.assign(Object.assign({},n),n.y),t.y),qt(Object.assign(Object.assign({},n),n.z),t.z),qt(Object.assign(Object.assign({},n),n.w),t.w)]})}W({id:"input-point4d",type:"input",accept:(n,t)=>{if(!Ge.isObject(n))return null;const e=X(t,s=>Object.assign(Object.assign({},Mn(s)),{readonly:s.optional.constant(!1),w:s.optional.custom(le),x:s.optional.custom(le),y:s.optional.custom(le),z:s.optional.custom(le)}));return e?{initialValue:n,params:e}:null},binding:{reader:n=>d_,constraint:n=>v_(n.params,n.initialValue),equals:Ge.equals,writer:n=>m_},controller:n=>{const t=n.value,e=n.constraint,s=[n.params.x,n.params.y,n.params.z,n.params.w];return new on(n.document,{assembly:hc,axes:t.rawValue.getComponents().map((i,r)=>{var o;return mr({constraint:e.components[r],initialValue:i,params:Ee(n.params,(o=s[r])!==null&&o!==void 0?o:{})})}),parser:Vt,value:t,viewProps:n.viewProps})}});function b_(n){const t=[],e=xr(n.options);return e&&t.push(e),new rn(t)}W({id:"input-string",type:"input",accept:(n,t)=>{if(typeof n!="string")return null;const e=X(t,s=>({readonly:s.optional.constant(!1),options:s.optional.custom(Ss)}));return e?{initialValue:n,params:e}:null},binding:{reader:n=>kr,constraint:n=>b_(n.params),writer:n=>de},controller:n=>{const t=n.document,e=n.value,s=n.constraint,i=s&&Ln(s,$s);return i?new Xe(t,{props:new E({options:i.values.value("options")}),value:e,viewProps:n.viewProps}):new Ls(t,{parser:r=>r,props:E.fromObject({formatter:Pi}),value:e,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="string"?null:n.controller.valueController instanceof Xe?new yr(n.controller):null}});const Hn={monitor:{defaultInterval:200,defaultRows:3}},Xo=V("mll");class f_{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(Xo()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("textarea");s.classList.add(Xo("i")),s.style.height=`calc(var(${Ia("containerUnitSize")}) * ${e.rows})`,s.readOnly=!0,e.viewProps.bindDisabled(s),this.element.appendChild(s),this.textareaElem_=s,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.textareaElem_,e=t.scrollTop===t.scrollHeight-t.clientHeight,s=[];this.value.rawValue.forEach(i=>{i!==void 0&&s.push(this.formatter_(i))}),t.textContent=s.join(`
`),e&&(t.scrollTop=t.scrollHeight)}onValueUpdate_(){this.update_()}}class Or{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new f_(t,{formatter:e.formatter,rows:e.rows,value:this.value,viewProps:this.viewProps})}}const Wo=V("sgl");class __{constructor(t,e){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=e.formatter,this.element=t.createElement("div"),this.element.classList.add(Wo()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("input");s.classList.add(Wo("i")),s.readOnly=!0,s.type="text",e.viewProps.bindDisabled(s),this.element.appendChild(s),this.inputElement=s,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}update_(){const t=this.value.rawValue,e=t[t.length-1];this.inputElement.value=e!==void 0?this.formatter_(e):""}onValueUpdate_(){this.update_()}}class Rr{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new __(t,{formatter:e.formatter,value:this.value,viewProps:this.viewProps})}}W({id:"monitor-bool",type:"monitor",accept:(n,t)=>{if(typeof n!="boolean")return null;const e=X(t,s=>({readonly:s.required.constant(!0),rows:s.optional.number}));return e?{initialValue:n,params:e}:null},binding:{reader:n=>Er},controller:n=>{var t;return n.value.rawValue.length===1?new Rr(n.document,{formatter:Fo,value:n.value,viewProps:n.viewProps}):new Or(n.document,{formatter:Fo,rows:(t=n.params.rows)!==null&&t!==void 0?t:Hn.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}});class w_ extends vr{get max(){return this.controller.valueController.props.get("max")}set max(t){this.controller.valueController.props.set("max",t)}get min(){return this.controller.valueController.props.get("min")}set min(t){this.controller.valueController.props.set("min",t)}}const ie=V("grl");class g_{constructor(t,e){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=t.createElement("div"),this.element.classList.add(ie()),e.viewProps.bindClassModifiers(this.element),this.formatter_=e.formatter,this.props_=e.props,this.cursor_=e.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const s=t.createElementNS(et,"svg");s.classList.add(ie("g")),s.style.height=`calc(var(${Ia("containerUnitSize")}) * ${e.rows})`,this.element.appendChild(s),this.svgElem_=s;const i=t.createElementNS(et,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;const r=t.createElement("div");r.classList.add(ie("t"),V("tt")()),this.element.appendChild(r),this.tooltipElem_=r,e.value.emitter.on("change",this.onValueUpdate_),this.value=e.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const t=this.svgElem_.getBoundingClientRect(),e=this.value.rawValue.length-1,s=this.props_.get("min"),i=this.props_.get("max"),r=[];this.value.rawValue.forEach((u,p)=>{if(u===void 0)return;const d=P(p,0,e,0,t.width),v=P(u,s,i,t.height,0);r.push([d,v].join(","))}),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,l=this.value.rawValue[this.cursor_.rawValue];if(l===void 0){o.classList.remove(ie("t","a"));return}const a=P(this.cursor_.rawValue,0,e,0,t.width),c=P(l,s,i,t.height,0);o.style.left=`${a}px`,o.style.top=`${c}px`,o.textContent=`${this.formatter_(l)}`,o.classList.contains(ie("t","a"))||(o.classList.add(ie("t","a"),ie("t","in")),ps(o),o.classList.remove(ie("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class Dr{constructor(t,e){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=e.props,this.value=e.value,this.viewProps=e.viewProps,this.cursor_=Y(-1),this.view=new g_(t,{cursor:this.cursor_,formatter:e.formatter,rows:e.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!Ps(t))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const s=new Jt(this.view.element);s.emitter.on("down",this.onGraphPointerDown_),s.emitter.on("move",this.onGraphPointerMove_),s.emitter.on("up",this.onGraphPointerUp_)}}importProps(t){return Lt(t,null,e=>({max:e.required.number,min:e.required.number}),e=>(this.props.set("max",e.max),this.props.set("min",e.min),!0))}exportProps(){return Mt(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(t){const e=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(P(t.offsetX,0,e.width,0,this.value.rawValue.length))}onGraphPointerDown_(t){this.onGraphPointerMove_(t)}onGraphPointerMove_(t){if(!t.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(P(t.data.point.x,0,t.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function Ei(n){return K(n.format)?st(2):n.format}function C_(n){var t;return n.value.rawValue.length===1?new Rr(n.document,{formatter:Ei(n.params),value:n.value,viewProps:n.viewProps}):new Or(n.document,{formatter:Ei(n.params),rows:(t=n.params.rows)!==null&&t!==void 0?t:Hn.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}function y_(n){var t,e,s;return new Dr(n.document,{formatter:Ei(n.params),rows:(t=n.params.rows)!==null&&t!==void 0?t:Hn.monitor.defaultRows,props:E.fromObject({max:(e=n.params.max)!==null&&e!==void 0?e:100,min:(s=n.params.min)!==null&&s!==void 0?s:0}),value:n.value,viewProps:n.viewProps})}function Zo(n){return n.view==="graph"}W({id:"monitor-number",type:"monitor",accept:(n,t)=>{if(typeof n!="number")return null;const e=X(t,s=>({format:s.optional.function,max:s.optional.number,min:s.optional.number,readonly:s.required.constant(!0),rows:s.optional.number,view:s.optional.string}));return e?{initialValue:n,params:e}:null},binding:{defaultBufferSize:n=>Zo(n)?64:1,reader:n=>cr},controller:n=>Zo(n.params)?y_(n):C_(n),api:n=>n.controller.valueController instanceof Dr?new w_(n.controller):null});W({id:"monitor-string",type:"monitor",accept:(n,t)=>{if(typeof n!="string")return null;const e=X(t,s=>({multiline:s.optional.boolean,readonly:s.required.constant(!0),rows:s.optional.number}));return e?{initialValue:n,params:e}:null},binding:{reader:n=>kr},controller:n=>{var t;const e=n.value;return e.rawValue.length>1||n.params.multiline?new Or(n.document,{formatter:Pi,rows:(t=n.params.rows)!==null&&t!==void 0?t:Hn.monitor.defaultRows,value:e,viewProps:n.viewProps}):new Rr(n.document,{formatter:Pi,value:e,viewProps:n.viewProps})}});class dc{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get title(){var t;return(t=this.controller_.props.get("title"))!==null&&t!==void 0?t:""}set title(t){this.controller_.props.set("title",t)}on(t,e){const s=e.bind(this);return this.controller_.emitter.on(t,()=>{s(new Ae(this))}),this}}class x_ extends Ae{constructor(t,e,s){super(t),this.cell=e,this.index=s}}class mc extends Me{constructor(t){super(t),this.cellToApiMap_=new Map,this.emitter_=new ot;const e=this.controller.valueController;e.cellControllers.forEach((s,i)=>{const r=new dc(s);this.cellToApiMap_.set(s,r),s.emitter.on("click",()=>{const o=i%e.size[0],l=Math.floor(i/e.size[0]);this.emitter_.emit("click",{event:new x_(this,r,[o,l])})})})}cell(t,e){const s=this.controller.valueController,i=s.cellControllers[e*s.size[0]+t];return this.cellToApiMap_.get(i)}on(t,e){const s=e.bind(this);return this.emitter_.on(t,i=>{s(i.event)}),this}}class vc{constructor(t,e){this.size=e.size;const[s,i]=this.size,r=[];for(let o=0;o<i;o++)for(let l=0;l<s;l++){const a=new Da(t,{props:E.fromObject(Object.assign({},e.cellConfig(l,o))),viewProps:Zt.create()});r.push(a)}this.cellCs_=r,this.viewProps=Zt.create(),this.viewProps.handleDispose(()=>{this.cellCs_.forEach(o=>{o.viewProps.set("disposed",!0)})}),this.view=new Fa(t,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns=`repeat(${s}, 1fr)`,this.cellCs_.forEach(o=>{this.view.element.appendChild(o.view.element)})}get cellControllers(){return this.cellCs_}}class Jo extends Kn{constructor(t,e){const s=e.valueController,i=new ks(t,{blade:e.blade,props:e.labelProps,valueController:s});super({blade:e.blade,view:i.view,viewProps:s.viewProps}),this.valueController=s,this.labelController=i}}const P_=W({id:"buttongrid",type:"blade",accept(n){const t=X(n,e=>({cells:e.required.function,size:e.required.array(e.required.number),view:e.required.constant("buttongrid"),label:e.optional.string}));return t?{params:t}:null},controller(n){return new Jo(n.document,{blade:n.blade,labelProps:E.fromObject({label:n.params.label}),valueController:new vc(n.document,{cellConfig:n.params.cells,size:n.params.size})})},api(n){return n.controller instanceof Jo?new mc(n.controller):null}});class bc extends Me{get label(){return this.controller.labelController.props.get("label")}set label(t){this.controller.labelController.props.set("label",t)}get value(){return this.controller.valueController.value.rawValue}set value(t){this.controller.valueController.value.rawValue=t}on(t,e){const s=e.bind(this);return this.controller.valueController.value.emitter.on(t,i=>{s(new xs(this,i.rawValue,i.options.last))}),this}}function wt(n,t,e){return n*(1-e)+t*e}const E_=20,k_=.001,Js=100;function V_(n,t){let e=.25,s=.5,i=-1;for(let r=0;r<E_;r++){const[o,l]=n.curve(s);if(s+=e*(o<t?1:-1),i=l,e*=.5,Math.abs(t-o)<k_)break}return i}class pe{constructor(t=0,e=0,s=1,i=1){this.cache_=[],this.comps_=[t,e,s,i]}get x1(){return this.comps_[0]}get y1(){return this.comps_[1]}get x2(){return this.comps_[2]}get y2(){return this.comps_[3]}static isObject(t){return K(t)||!Array.isArray(t)?!1:typeof t[0]=="number"&&typeof t[1]=="number"&&typeof t[2]=="number"&&typeof t[3]=="number"}static equals(t,e){return t.x1===e.x1&&t.y1===e.y1&&t.x2===e.x2&&t.y2===e.y2}curve(t){const e=wt(0,this.x1,t),s=wt(0,this.y1,t),i=wt(this.x1,this.x2,t),r=wt(this.y1,this.y2,t),o=wt(this.x2,1,t),l=wt(this.y2,1,t),a=wt(e,i,t),c=wt(s,r,t),u=wt(i,o,t),p=wt(r,l,t);return[wt(a,u,t),wt(c,p,t)]}y(t){if(this.cache_.length===0){const e=[];for(let s=0;s<Js;s++)e.push(V_(this,P(s,0,Js-1,0,1)));this.cache_=e}return this.cache_[Math.round(P(H(t,0,1),0,1,0,Js-1))]}toObject(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}const Br={toComponents:n=>n.toObject(),fromComponents:n=>new pe(...n)};function $_(n){const t=st(2);return`cubic-bezier(${n.toObject().map(s=>t(s)).join(", ")})`}const Qo=[0,.5,.5,1];function S_(n){const t=n.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!t)return new pe(...Qo);const e=[t[1],t[2],t[3],t[4]].reduce((s,i)=>{if(!s)return null;const r=Number(i);return isNaN(r)?null:[...s,r]},[]);return new pe(...e??Qo)}const _e=V("cbz");class fc{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(_e()),e.viewProps.bindClassModifiers(this.element),e.foldable.bindExpandedClass(this.element,_e(void 0,"expanded")),Pt(e.foldable,"completed",he(this.element,_e(void 0,"cpl")));const s=t.createElement("div");s.classList.add(_e("h")),this.element.appendChild(s);const i=t.createElement("button");i.classList.add(_e("b")),e.viewProps.bindDisabled(i);const r=t.createElementNS(et,"svg");r.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',i.appendChild(r),s.appendChild(i),this.buttonElement=i;const o=t.createElement("div");if(o.classList.add(_e("t")),s.appendChild(o),this.textElement=o,e.pickerLayout==="inline"){const l=t.createElement("div");l.classList.add(_e("p")),this.element.appendChild(l),this.pickerElement=l}else this.pickerElement=null}}const Qs=V("cbzp");class _c{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Qs()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("div");s.classList.add(Qs("g")),this.element.appendChild(s),this.graphElement=s;const i=t.createElement("div");i.classList.add(Qs("t")),this.element.appendChild(i),this.textElement=i}}function wc(n,t){const e=new MutationObserver(i=>{for(const r of i)r.type==="childList"&&r.addedNodes.forEach(o=>{o.contains(o)&&(t(),e.disconnect())})}),s=n.ownerDocument;e.observe(s.body,{attributes:!0,childList:!0,subtree:!0})}const re=V("cbzg");function L_(n,t){return e=>t(n(e))}class gc{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(re()),e.viewProps.bindClassModifiers(this.element),e.viewProps.bindTabIndex(this.element);const s=t.createElement("div");s.classList.add(re("p")),this.element.appendChild(s),this.previewElement=s;const i=t.createElementNS(et,"svg");i.classList.add(re("g")),this.element.appendChild(i),this.svgElem_=i;const r=t.createElementNS(et,"path");r.classList.add(re("u")),this.svgElem_.appendChild(r),this.guideElem_=r;const o=t.createElementNS(et,"polyline");o.classList.add(re("l")),this.svgElem_.appendChild(o),this.lineElem_=o,this.handleElems_=[t.createElement("div"),t.createElement("div")],this.handleElems_.forEach(l=>{l.classList.add(re("h")),this.element.appendChild(l)}),this.vectorElems_=[t.createElementNS(et,"line"),t.createElementNS(et,"line")],this.vectorElems_.forEach(l=>{l.classList.add(re("v")),this.svgElem_.appendChild(l)}),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=e.selection,this.handleElems_.forEach((l,a)=>{yt(this.sel_,L_(c=>c===a,he(l,re("h","sel"))))}),wc(this.element,()=>{this.refresh()})}getVertMargin_(t){return t*.25}valueToPosition(t,e){const{clientWidth:s,clientHeight:i}=this.element,r=this.getVertMargin_(i);return{x:P(t,0,1,0,s),y:P(e,0,1,i-r,r)}}positionToValue(t,e){const s=this.element.getBoundingClientRect(),i=s.width,r=s.height,o=this.getVertMargin_(r);return{x:H(P(t,0,i,0,1),0,1),y:P(e,r-o,o,0,1)}}refresh(){this.guideElem_.setAttributeNS(null,"d",[0,1].map(r=>{const o=this.valueToPosition(0,r),l=this.valueToPosition(1,r);return[`M ${o.x},${o.y}`,`L ${l.x},${l.y}`].join(" ")}).join(" "));const t=this.value_.rawValue,e=[];let s=0;for(;;){const r=this.valueToPosition(...t.curve(s));if(e.push([r.x,r.y].join(",")),s>=1)break;s=Math.min(s+.05,1)}this.lineElem_.setAttributeNS(null,"points",e.join(" "));const i=t.toObject();[0,1].forEach(r=>{const o=this.valueToPosition(r,r),l=this.valueToPosition(i[r*2],i[r*2+1]),a=this.vectorElems_[r];a.setAttributeNS(null,"x1",String(o.x)),a.setAttributeNS(null,"y1",String(o.y)),a.setAttributeNS(null,"x2",String(l.x)),a.setAttributeNS(null,"y2",String(l.y));const c=this.handleElems_[r];c.style.left=`${l.x}px`,c.style.top=`${l.y}px`})}onValueChange_(){this.refresh()}}const tl=24,el=400,nl=1e3,je=V("cbzprv");class Cc{constructor(t,e){this.stopped_=!0,this.startTime_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=t.createElement("div"),this.element.classList.add(je()),e.viewProps.bindClassModifiers(this.element);const s=t.createElementNS(et,"svg");s.classList.add(je("g")),this.element.appendChild(s),this.svgElem_=s;const i=t.createElementNS(et,"path");i.classList.add(je("t")),this.svgElem_.appendChild(i),this.ticksElem_=i;const r=t.createElement("div");r.classList.add(je("m")),this.element.appendChild(r),this.markerElem_=r,this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_),e.viewProps.handleDispose(this.onDispose_),wc(this.element,()=>{this.refresh()})}play(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(je("m","a")),this.startTime_=new Date().getTime()+el,this.stopped_=!1,requestAnimationFrame(this.onTimer_)}stop(){this.stopped_=!0,this.markerElem_.classList.remove(je("m","a"))}onDispose_(){this.stop()}updateMarker_(t){const e=this.value_.rawValue.y(H(t,0,1));this.markerElem_.style.left=`${e*100}%`}refresh(){const{clientWidth:t,clientHeight:e}=this.svgElem_,s=[],i=this.value_.rawValue;for(let r=0;r<tl;r++){const o=P(r,0,tl-1,0,1),l=P(i.y(o),0,1,0,t);s.push(`M ${l},0 v${e}`)}this.ticksElem_.setAttributeNS(null,"d",s.join(" "))}onTimer_(){if(this.startTime_===null)return;const t=new Date().getTime()-this.startTime_,e=t/nl;this.updateMarker_(e),t>nl+el&&this.stop(),this.stopped_||requestAnimationFrame(this.onTimer_)}onValueChange_(){this.refresh(),this.play()}}function ki(n,t,e,s){const i=e-n,r=s-t;return Math.sqrt(i*i+r*r)}function M_(n,t,e,s){const i=ki(n,t,e,s),r=Math.atan2(s-t,e-n),o=Math.round(r/(Math.PI/4))*Math.PI/4;return{x:n+Math.cos(o)*i,y:t+Math.sin(o)*i}}class yc{constructor(t,e){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.keyScale_=e.keyScale,this.value=e.value,this.sel_=Y(0),this.viewProps=e.viewProps,this.view=new gc(t,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_),this.prevView_=new Cc(t,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",i=>{i.stopImmediatePropagation(),i.preventDefault(),this.prevView_.play()}),this.view.previewElement.appendChild(this.prevView_.element);const s=new Jt(this.view.element);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}refresh(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}updateValue_(t,e,s){const i=this.sel_.rawValue,r=this.value.rawValue.toObject(),o=this.view.positionToValue(t.x,t.y),l=e?M_(i,i,o.x,o.y):o;r[i*2]=l.x,r[i*2+1]=l.y,this.value.setRawValue(new pe(...r),s)}onPointerDown_(t){const e=t.data;if(!e.point)return;const s=this.value.rawValue,i=this.view.valueToPosition(s.x1,s.y1),r=ki(e.point.x,e.point.y,i.x,i.y),o=this.view.valueToPosition(s.x2,s.y2),l=ki(e.point.x,e.point.y,o.x,o.y);this.sel_.rawValue=r<=l?0:1,this.updateValue_(e.point,t.shiftKey,{forceEmit:!1,last:!1})}onPointerMove_(t){const e=t.data;e.point&&this.updateValue_(e.point,t.shiftKey,{forceEmit:!1,last:!1})}onPointerUp_(t){const e=t.data;e.point&&this.updateValue_(e.point,t.shiftKey,{forceEmit:!0,last:!0})}onKeyDown_(t){ms(t.key)&&t.preventDefault();const e=this.sel_.rawValue,s=this.value.rawValue.toObject(),i=this.keyScale_.rawValue;s[e*2]+=nt(i,$t(t)),s[e*2+1]+=nt(i,ke(t)),this.value.setRawValue(new pe(...s),{forceEmit:!1,last:!1})}onKeyUp_(t){ms(t.key)&&t.preventDefault();const e=this.keyScale_.rawValue,s=nt(e,$t(t)),i=nt(e,ke(t));s===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class xc{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.view=new _c(t,{viewProps:this.viewProps}),this.gc_=new yc(t,{keyScale:e.axis.textProps.value("keyScale"),value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);const s=Object.assign(Object.assign({},e.axis),{constraint:new or({max:1,min:0})}),i=Object.assign(Object.assign({},e.axis),{constraint:void 0});this.tc_=new on(t,{assembly:Br,axes:[s,i,s,i],parser:Vt,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}get allFocusableElements(){return[this.gc_.view.element,...this.tc_.view.textViews.map(t=>t.inputElement)]}refresh(){this.gc_.refresh()}}class Vi{constructor(t,e){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=e.value,this.viewProps=e.viewProps,this.foldable_=sn.create(e.expanded),this.view=new fc(t,{foldable:this.foldable_,pickerLayout:e.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new Ls(t,{parser:S_,props:E.fromObject({formatter:$_}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_=e.pickerLayout==="popup"?new Pr(t,{viewProps:this.viewProps}):null;const s=new xc(t,{axis:e.axis,value:this.value,viewProps:this.viewProps});s.allFocusableElements.forEach(i=>{i.addEventListener("blur",this.onPopupChildBlur_),i.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),yt(this.popC_.shows,i=>{i&&s.refresh()}),Te({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:i=>i,backward:(i,r)=>r})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Vs(this.foldable_,this.view.pickerElement))}onButtonBlur_(t){if(!this.popC_)return;const e=t.relatedTarget;(!e||!this.popC_.view.element.contains(e))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}onPopupChildBlur_(t){if(!this.popC_)return;const e=this.popC_.view.element,s=fr(t);s&&e.contains(s)||s&&s===this.view.buttonElement&&!Ps(e.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(t){this.popC_&&t.key==="Escape"&&(this.popC_.shows.rawValue=!1)}}function A_(){return new As({assembly:Br,components:[0,1,2,3].map(n=>n%2===0?new or({min:0,max:1}):void 0)})}const T_=W({id:"cubicbezier",type:"blade",accept(n){const t=X(n,e=>({value:e.required.array(e.required.number),view:e.required.constant("cubicbezier"),expanded:e.optional.boolean,label:e.optional.string,picker:e.optional.custom(s=>s==="inline"||s==="popup"?s:void 0)}));return t?{params:t}:null},controller(n){var t,e;const s=new pe(...n.params.value),i=Y(s,{constraint:A_(),equals:pe.equals}),r=new Vi(n.document,{axis:{textProps:E.fromObject({keyScale:.1,pointerScale:.01,formatter:st(2)})},expanded:(t=n.params.expanded)!==null&&t!==void 0?t:!1,pickerLayout:(e=n.params.picker)!==null&&e!==void 0?e:"popup",value:i,viewProps:n.viewProps});return new hs(n.document,{blade:n.blade,props:E.fromObject({label:n.params.label}),value:i,valueController:r})},api(n){return!(n.controller instanceof hs)||!(n.controller.valueController instanceof Vi)?null:new bc(n.controller)}});class Pc extends Me{get fps(){return this.controller.valueController.fps}get max(){return this.controller.valueController.props.get("max")}set max(t){this.controller.valueController.props.set("max",t)}get min(){return this.controller.valueController.props.get("min")}set min(t){this.controller.valueController.props.set("min",t)}begin(){this.controller.valueController.begin()}end(){this.controller.valueController.end()}on(t,e){const s=e.bind(this);return this.controller.valueController.ticker.emitter.on(t,()=>{s(new Ae(this))}),this}}const sl=20;class Ec{constructor(){this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}get duration(){return this.duration_}get fps(){return this.fps_}begin(t){this.start_=t.getTime()}calculateFps_(t){if(this.timestamps_.length===0)return null;const e=this.timestamps_[0];return 1e3*(this.frameCount_-e.frameCount)/(t-e.time)}compactTimestamps_(){if(this.timestamps_.length<=sl)return;const t=this.timestamps_.length-sl;this.timestamps_.splice(0,t);const e=this.timestamps_[0].frameCount;this.timestamps_.forEach(s=>{s.frameCount-=e}),this.frameCount_-=e}end(t){if(this.start_===null)return;const e=t.getTime();this.duration_=e-this.start_,this.start_=null,this.fps_=this.calculateFps_(e),this.timestamps_.push({frameCount:this.frameCount_,time:e}),++this.frameCount_,this.compactTimestamps_()}}const gn=V("fps");class kc{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(gn()),e.viewProps.bindClassModifiers(this.element),this.graphElement=t.createElement("div"),this.graphElement.classList.add(gn("g")),this.element.appendChild(this.graphElement);const s=t.createElement("div");s.classList.add(gn("l")),this.element.appendChild(s);const i=t.createElement("span");i.classList.add(gn("v")),i.textContent="--",s.appendChild(i),this.valueElement=i;const r=t.createElement("span");r.classList.add(gn("u")),r.textContent="FPS",s.appendChild(r)}}class Vc{constructor(t,e){this.stopwatch_=new Ec,this.onTick_=this.onTick_.bind(this),this.ticker=e.ticker,this.ticker.emitter.on("tick",this.onTick_),this.props=e.props,this.value_=e.value,this.viewProps=e.viewProps,this.view=new kc(t,{viewProps:this.viewProps}),this.graphC_=new Dr(t,{formatter:st(0),props:this.props,rows:e.rows,value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose(()=>{this.graphC_.viewProps.set("disposed",!0),this.ticker.dispose()})}get fps(){return this.stopwatch_.fps}begin(){this.stopwatch_.begin(new Date)}end(){this.stopwatch_.end(new Date)}onTick_(){const t=this.fps;if(t!==null){const e=this.value_.rawValue;this.value_.rawValue=Kv(e,t),this.view.valueElement.textContent=t.toFixed(0)}}}class il extends Kn{constructor(t,e){const s=e.valueController,i=new ks(t,{blade:e.blade,props:e.labelProps,valueController:s});super({blade:e.blade,view:i.view,viewProps:s.viewProps}),this.valueController=s,this.labelController=i}}function O_(n,t){return t===0?new bb:new fb(n,t??Hn.monitor.defaultInterval)}const R_=W({id:"fpsgraph",type:"blade",accept(n){const t=X(n,e=>({view:e.required.constant("fpsgraph"),interval:e.optional.number,label:e.optional.string,rows:e.optional.number,max:e.optional.number,min:e.optional.number}));return t?{params:t}:null},controller(n){var t,e,s,i;const r=(t=n.params.interval)!==null&&t!==void 0?t:500;return new il(n.document,{blade:n.blade,labelProps:E.fromObject({label:n.params.label}),valueController:new Vc(n.document,{props:E.fromObject({max:(e=n.params.max)!==null&&e!==void 0?e:90,min:(s=n.params.min)!==null&&s!==void 0?s:0}),rows:(i=n.params.rows)!==null&&i!==void 0?i:2,ticker:O_(n.document,r),value:Y(Fv(80)),viewProps:n.viewProps})})},api(n){return n.controller instanceof il?new Pc(n.controller):null}});class mt{constructor(t,e){this.min=t,this.max=e}static isObject(t){if(typeof t!="object"||t===null)return!1;const e=t.min,s=t.max;return!(typeof e!="number"||typeof s!="number")}static equals(t,e){return t.min===e.min&&t.max===e.max}get length(){return this.max-this.min}toObject(){return{min:this.min,max:this.max}}}const Nr={fromComponents:n=>new mt(n[0],n[1]),toComponents:n=>[n.min,n.max]};class jr{constructor(t){this.edge=t}constrain(t){var e,s,i,r,o,l,a,c;if(t.min<=t.max)return new mt((s=(e=this.edge)===null||e===void 0?void 0:e.constrain(t.min))!==null&&s!==void 0?s:t.min,(r=(i=this.edge)===null||i===void 0?void 0:i.constrain(t.max))!==null&&r!==void 0?r:t.max);const u=(t.min+t.max)/2;return new mt((l=(o=this.edge)===null||o===void 0?void 0:o.constrain(u))!==null&&l!==void 0?l:u,(c=(a=this.edge)===null||a===void 0?void 0:a.constrain(u))!==null&&c!==void 0?c:u)}}const ti=V("rsltxt");class $c{constructor(t,e){this.sliderView_=e.sliderView,this.textView_=e.textView,this.element=t.createElement("div"),this.element.classList.add(ti());const s=t.createElement("div");s.classList.add(ti("s")),s.appendChild(this.sliderView_.element),this.element.appendChild(s);const i=t.createElement("div");i.classList.add(ti("t")),i.appendChild(this.textView_.element),this.element.appendChild(i)}}const we=V("rsl");class Sc{constructor(t,e){this.onSliderPropsChange_=this.onSliderPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.sliderProps_=e.sliderProps,this.sliderProps_.emitter.on("change",this.onSliderPropsChange_),this.element=t.createElement("div"),this.element.classList.add(we()),e.viewProps.bindClassModifiers(this.element),this.value_=e.value,this.value_.emitter.on("change",this.onValueChange_);const s=t.createElement("div");s.classList.add(we("t")),this.element.appendChild(s),this.trackElement=s;const i=t.createElement("div");i.classList.add(we("b")),s.appendChild(i),this.barElement=i;const r=["min","max"].map(o=>{const l=t.createElement("div");return l.classList.add(we("k"),we("k",o)),s.appendChild(l),l});this.knobElements=[r[0],r[1]],this.update_()}valueToX_(t){const e=this.sliderProps_.get("min"),s=this.sliderProps_.get("max");return H(P(t,e,s,0,1),0,1)*100}update_(){const t=this.value_.rawValue;t.length===0?this.element.classList.add(we(void 0,"zero")):this.element.classList.remove(we(void 0,"zero"));const e=[this.valueToX_(t.min),this.valueToX_(t.max)];this.barElement.style.left=`${e[0]}%`,this.barElement.style.right=`${100-e[1]}%`,this.knobElements.forEach((s,i)=>{s.style.left=`${e[i]}%`})}onSliderPropsChange_(){this.update_()}onValueChange_(){this.update_()}}class Lc{constructor(t,e){this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.sliderProps=e.sliderProps,this.viewProps=e.viewProps,this.value=e.value,this.view=new Sc(t,{sliderProps:this.sliderProps,value:this.value,viewProps:e.viewProps});const s=new Jt(this.view.trackElement);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}ofs_(){return this.grabbing_==="min"?this.view.knobElements[0].getBoundingClientRect().width/2:this.grabbing_==="max"?-this.view.knobElements[1].getBoundingClientRect().width/2:0}valueFromData_(t){if(!t.point)return null;const e=(t.point.x+this.ofs_())/t.bounds.width,s=this.sliderProps.get("min"),i=this.sliderProps.get("max");return P(e,0,1,s,i)}onPointerDown_(t){if(!t.data.point)return;const e=t.data.point.x/t.data.bounds.width,s=this.value.rawValue,i=this.sliderProps.get("min"),r=this.sliderProps.get("max"),o=P(s.min,i,r,0,1),l=P(s.max,i,r,0,1);Math.abs(l-e)<=.025?this.grabbing_="max":Math.abs(o-e)<=.025?this.grabbing_="min":e>=o&&e<=l?(this.grabbing_="length",this.grabOffset_=P(e-o,0,1,0,r-i)):e<o?(this.grabbing_="min",this.onPointerMove_(t)):e>l&&(this.grabbing_="max",this.onPointerMove_(t))}applyPointToValue_(t,e){const s=this.valueFromData_(t);if(s===null)return;const i=this.sliderProps.get("min"),r=this.sliderProps.get("max");if(this.grabbing_==="min")this.value.setRawValue(new mt(s,this.value.rawValue.max),e);else if(this.grabbing_==="max")this.value.setRawValue(new mt(this.value.rawValue.min,s),e);else if(this.grabbing_==="length"){const o=this.value.rawValue.length;let l=s-this.grabOffset_,a=l+o;l<i?(l=i,a=i+o):a>r&&(l=r-o,a=r),this.value.setRawValue(new mt(l,a),e)}}onPointerMove_(t){this.applyPointToValue_(t.data,{forceEmit:!1,last:!1})}onPointerUp_(t){this.applyPointToValue_(t.data,{forceEmit:!0,last:!0}),this.grabbing_=null}}class Mc{constructor(t,e){this.value=e.value,this.viewProps=e.viewProps,this.sc_=new Lc(t,e);const s={constraint:e.constraint,textProps:e.textProps};this.tc_=new on(t,{assembly:Nr,axes:[s,s],parser:e.parser,value:this.value,viewProps:e.viewProps}),this.view=new $c(t,{sliderView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}function D_(n){return mt.isObject(n)?new mt(n.min,n.max):new mt(0,0)}function B_(n,t){n.writeProperty("max",t.max),n.writeProperty("min",t.min)}function N_(n){const t=[],e=pr(n);e&&t.push(e);const s=ur(n);return s&&t.push(s),new jr(new rn(t))}const j_=W({id:"input-interval",type:"input",accept:(n,t)=>{if(!mt.isObject(n))return null;const e=X(t,s=>Object.assign(Object.assign({},dr(s)),{readonly:s.optional.constant(!1)}));return e?{initialValue:new mt(n.min,n.max),params:e}:null},binding:{reader:n=>D_,constraint:n=>N_(n.params),equals:mt.equals,writer:n=>B_},controller(n){const t=n.value,e=n.constraint;if(!(e instanceof jr))throw at.shouldNeverHappen();const s=(t.rawValue.min+t.rawValue.max)/2,i=E.fromObject(hr(n.params,s)),r=e.edge&&Ln(e.edge,zn);if(r)return new Mc(n.document,{constraint:e.edge,parser:Vt,sliderProps:new E({keyScale:i.value("keyScale"),max:r.values.value("max"),min:r.values.value("min")}),textProps:i,value:t,viewProps:n.viewProps});const o={constraint:e.edge,textProps:i};return new on(n.document,{assembly:Nr,axes:[o,o],parser:Vt,value:t,viewProps:n.viewProps})}});class Ac{constructor(t){this.controller_=t}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(t){this.controller_.viewProps.set("disabled",t)}get title(){var t;return(t=this.controller_.props.get("title"))!==null&&t!==void 0?t:""}set title(t){this.controller_.props.set("title",t)}}class Tc extends xs{constructor(t,e,s,i,r){super(t,i,r),this.cell=e,this.index=s}}class Oc extends Me{constructor(t){super(t),this.cellToApiMap_=new Map,this.controller.valueController.cellControllers.forEach(s=>{const i=new Ac(s);this.cellToApiMap_.set(s,i)})}get value(){return this.controller.value}cell(t,e){const s=this.controller.valueController,i=s.cellControllers[e*s.size[0]+t];return this.cellToApiMap_.get(i)}on(t,e){const s=e.bind(this);this.controller.value.emitter.on(t,i=>{const r=this.controller.valueController,o=r.findCellByValue(i.rawValue);if(!o)return;const l=this.cellToApiMap_.get(o);if(!l)return;const a=r.cellControllers.indexOf(o);s(new Tc(this,l,[a%r.size[0],Math.floor(a/r.size[0])],i.rawValue))})}}const Cn=V("rad");class Rc{constructor(t,e){this.element=t.createElement("div"),this.element.classList.add(Cn()),e.viewProps.bindClassModifiers(this.element);const s=t.createElement("label");s.classList.add(Cn("l")),this.element.appendChild(s);const i=t.createElement("input");i.classList.add(Cn("i")),i.name=e.name,i.type="radio",e.viewProps.bindDisabled(i),s.appendChild(i),this.inputElement=i;const r=t.createElement("div");r.classList.add(Cn("b")),s.appendChild(r);const o=t.createElement("div");o.classList.add(Cn("t")),r.appendChild(o),Pt(e.props,"title",l=>{o.textContent=l})}}class Dc{constructor(t,e){this.props=e.props,this.viewProps=e.viewProps,this.view=new Rc(t,{name:e.name,props:this.props,viewProps:this.viewProps})}}class vs{constructor(t,e){this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=e.size;const[s,i]=this.size;for(let r=0;r<i;r++)for(let o=0;o<s;o++){const l=new Dc(t,{name:e.groupName,props:E.fromObject(Object.assign({},e.cellConfig(o,r))),viewProps:Zt.create()});this.cellCs_.push(l),this.cellValues_.push(e.cellConfig(o,r).value)}this.value=e.value,yt(this.value,r=>{const o=this.findCellByValue(r);o&&(o.view.inputElement.checked=!0)}),this.viewProps=Zt.create(),this.view=new Fa(t,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns=`repeat(${s}, 1fr)`,this.cellCs_.forEach(r=>{r.view.inputElement.addEventListener("change",this.onCellInputChange_),this.view.element.appendChild(r.view.element)})}get cellControllers(){return this.cellCs_}findCellByValue(t){const e=this.cellValues_.findIndex(s=>s===t);return e<0?null:this.cellCs_[e]}onCellInputChange_(t){const e=t.currentTarget,s=this.cellCs_.findIndex(i=>i.view.inputElement===e);s<0||(this.value.rawValue=this.cellValues_[s])}}const I_=function(){return W({id:"radiogrid",type:"blade",accept(n){const t=X(n,e=>({cells:e.required.function,groupName:e.required.string,size:e.required.array(e.required.number),value:e.required.raw,view:e.required.constant("radiogrid"),label:e.optional.string}));return t?{params:t}:null},controller(n){const t=Y(n.params.value);return new hs(n.document,{blade:n.blade,props:E.fromObject({label:n.params.label}),value:t,valueController:new vs(n.document,{groupName:n.params.groupName,cellConfig:n.params.cells,size:n.params.size,value:t})})},api(n){return!(n.controller instanceof hs)||!(n.controller.valueController instanceof vs)?null:new Oc(n.controller)}})}();function Ir(n){return W({id:"input-radiogrid",type:"input",accept(t,e){if(!n.isType(t))return null;const s=X(e,i=>({cells:i.required.function,groupName:i.required.string,size:i.required.array(i.required.number),view:i.required.constant("radiogrid")}));return s?{initialValue:t,params:s}:null},binding:n.binding,controller:t=>new vs(t.document,{cellConfig:t.params.cells,groupName:t.params.groupName,size:t.params.size,value:t.value})})}const F_=Ir({isType:n=>typeof n=="number",binding:{reader:n=>cr,writer:n=>de}}),z_=Ir({isType:n=>typeof n=="string",binding:{reader:n=>kr,writer:n=>de}}),K_=Ir({isType:n=>typeof n=="boolean",binding:{reader:n=>Er,writer:n=>de}}),U_="essentials",q_='.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--bld-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--cnt-usz);line-height:var(--cnt-usz);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--cnt-usz);line-height:var(--cnt-usz);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--bld-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--cnt-usz)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--cnt-usp);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1 * var(--cnt-hp));position:absolute;right:calc(-1 * var(--cnt-hp));top:var(--cnt-usz)}.tp-cbzpv_t{margin-top:var(--cnt-usp)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--cnt-usz) * 5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--cnt-usz));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--cnt-usz) - 8px);margin-top:calc((var(--cnt-usz) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--bld-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',H_=[P_,T_,R_,j_,I_,K_,F_,z_],G_=Object.freeze(Object.defineProperty({__proto__:null,ButtonCellApi:dc,ButtonGridApi:mc,ButtonGridController:vc,CubicBezier:pe,CubicBezierApi:bc,CubicBezierAssembly:Br,CubicBezierController:Vi,CubicBezierGraphController:yc,CubicBezierGraphView:gc,CubicBezierPickerController:xc,CubicBezierPickerView:_c,CubicBezierPreviewView:Cc,CubicBezierView:fc,FpsGraphBladeApi:Pc,FpsGraphController:Vc,FpsView:kc,Fpswatch:Ec,Interval:mt,IntervalAssembly:Nr,IntervalConstraint:jr,RadioCellApi:Ac,RadioController:Dc,RadioGridApi:Oc,RadioGridController:vs,RadioView:Rc,RangeSliderController:Lc,RangeSliderTextController:Mc,RangeSliderTextView:$c,RangeSliderView:Sc,TpRadioGridChangeEvent:Tc,css:q_,id:U_,plugins:H_},Symbol.toStringTag,{value:"Module"})),{min:Y_,max:X_}=Math,Ce=(n,t=0,e=1)=>Y_(X_(t,n),e),Fr=n=>{n._clipped=!1,n._unclipped=n.slice(0);for(let t=0;t<=3;t++)t<3?((n[t]<0||n[t]>255)&&(n._clipped=!0),n[t]=Ce(n[t],0,255)):t===3&&(n[t]=Ce(n[t],0,1));return n},Bc={};for(let n of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])Bc[`[object ${n}]`]=n.toLowerCase();function T(n){return Bc[Object.prototype.toString.call(n)]||"object"}const k=(n,t=null)=>n.length>=3?Array.prototype.slice.call(n):T(n[0])=="object"&&t?t.split("").filter(e=>n[0][e]!==void 0).map(e=>n[0][e]):n[0].slice(0),ln=n=>{if(n.length<2)return null;const t=n.length-1;return T(n[t])=="string"?n[t].toLowerCase():null},{PI:Ts,min:Nc,max:jc}=Math,xt=n=>Math.round(n*100)/100,$i=n=>Math.round(n*100)/100,Kt=Ts*2,ei=Ts/3,W_=Ts/180,Z_=180/Ts;function Ic(n){return[...n.slice(0,3).reverse(),...n.slice(3)]}const x={format:{},autodetect:[]};class m{constructor(...t){const e=this;if(T(t[0])==="object"&&t[0].constructor&&t[0].constructor===this.constructor)return t[0];let s=ln(t),i=!1;if(!s){i=!0,x.sorted||(x.autodetect=x.autodetect.sort((r,o)=>o.p-r.p),x.sorted=!0);for(let r of x.autodetect)if(s=r.test(...t),s)break}if(x.format[s]){const r=x.format[s].apply(null,i?t:t.slice(0,-1));e._rgb=Fr(r)}else throw new Error("unknown format: "+t);e._rgb.length===3&&e._rgb.push(1)}toString(){return T(this.hex)=="function"?this.hex():`[${this._rgb.join(",")}]`}}const J_="3.1.2",A=(...n)=>new m(...n);A.version=J_;const Ze={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},Q_=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,tw=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,Fc=n=>{if(n.match(Q_)){(n.length===4||n.length===7)&&(n=n.substr(1)),n.length===3&&(n=n.split(""),n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]);const t=parseInt(n,16),e=t>>16,s=t>>8&255,i=t&255;return[e,s,i,1]}if(n.match(tw)){(n.length===5||n.length===9)&&(n=n.substr(1)),n.length===4&&(n=n.split(""),n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]+n[3]+n[3]);const t=parseInt(n,16),e=t>>24&255,s=t>>16&255,i=t>>8&255,r=Math.round((t&255)/255*100)/100;return[e,s,i,r]}throw new Error(`unknown hex color: ${n}`)},{round:Zn}=Math,zc=(...n)=>{let[t,e,s,i]=k(n,"rgba"),r=ln(n)||"auto";i===void 0&&(i=1),r==="auto"&&(r=i<1?"rgba":"rgb"),t=Zn(t),e=Zn(e),s=Zn(s);let l="000000"+(t<<16|e<<8|s).toString(16);l=l.substr(l.length-6);let a="0"+Zn(i*255).toString(16);switch(a=a.substr(a.length-2),r.toLowerCase()){case"rgba":return`#${l}${a}`;case"argb":return`#${a}${l}`;default:return`#${l}`}};m.prototype.name=function(){const n=zc(this._rgb,"rgb");for(let t of Object.keys(Ze))if(Ze[t]===n)return t.toLowerCase();return n};x.format.named=n=>{if(n=n.toLowerCase(),Ze[n])return Fc(Ze[n]);throw new Error("unknown color name: "+n)};x.autodetect.push({p:5,test:(n,...t)=>{if(!t.length&&T(n)==="string"&&Ze[n.toLowerCase()])return"named"}});m.prototype.alpha=function(n,t=!1){return n!==void 0&&T(n)==="number"?t?(this._rgb[3]=n,this):new m([this._rgb[0],this._rgb[1],this._rgb[2],n],"rgb"):this._rgb[3]};m.prototype.clipped=function(){return this._rgb._clipped||!1};const Dt={Kn:18,labWhitePoint:"d65",Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452,kE:216/24389,kKE:8,kK:24389/27,RefWhiteRGB:{X:.95047,Y:1,Z:1.08883},MtxRGB2XYZ:{m00:.4124564390896922,m01:.21267285140562253,m02:.0193338955823293,m10:.357576077643909,m11:.715152155287818,m12:.11919202588130297,m20:.18043748326639894,m21:.07217499330655958,m22:.9503040785363679},MtxXYZ2RGB:{m00:3.2404541621141045,m01:-.9692660305051868,m02:.055643430959114726,m10:-1.5371385127977166,m11:1.8760108454466942,m12:-.2040259135167538,m20:-.498531409556016,m21:.041556017530349834,m22:1.0572251882231791},As:.9414285350000001,Bs:1.040417467,Cs:1.089532651,MtxAdaptMa:{m00:.8951,m01:-.7502,m02:.0389,m10:.2664,m11:1.7135,m12:-.0685,m20:-.1614,m21:.0367,m22:1.0296},MtxAdaptMaI:{m00:.9869929054667123,m01:.43230526972339456,m02:-.008528664575177328,m10:-.14705425642099013,m11:.5183602715367776,m12:.04004282165408487,m20:.15996265166373125,m21:.0492912282128556,m22:.9684866957875502}},ew=new Map([["a",[1.0985,.35585]],["b",[1.0985,.35585]],["c",[.98074,1.18232]],["d50",[.96422,.82521]],["d55",[.95682,.92149]],["d65",[.95047,1.08883]],["e",[1,1,1]],["f2",[.99186,.67393]],["f7",[.95041,1.08747]],["f11",[1.00962,.6435]],["icc",[.96422,.82521]]]);function Ht(n){const t=ew.get(String(n).toLowerCase());if(!t)throw new Error("unknown Lab illuminant "+n);Dt.labWhitePoint=n,Dt.Xn=t[0],Dt.Zn=t[1]}function An(){return Dt.labWhitePoint}const zr=(...n)=>{n=k(n,"lab");const[t,e,s]=n,[i,r,o]=nw(t,e,s),[l,a,c]=Kc(i,r,o);return[l,a,c,n.length>3?n[3]:1]},nw=(n,t,e)=>{const{kE:s,kK:i,kKE:r,Xn:o,Yn:l,Zn:a}=Dt,c=(n+16)/116,u=.002*t+c,p=c-.005*e,d=u*u*u,v=p*p*p,b=d>s?d:(116*u-16)/i,y=n>r?Math.pow((n+16)/116,3):n/i,w=v>s?v:(116*p-16)/i,_=b*o,q=y*l,z=w*a;return[_,q,z]},ni=n=>{const t=Math.sign(n);return n=Math.abs(n),(n<=.0031308?n*12.92:1.055*Math.pow(n,1/2.4)-.055)*t},Kc=(n,t,e)=>{const{MtxAdaptMa:s,MtxAdaptMaI:i,MtxXYZ2RGB:r,RefWhiteRGB:o,Xn:l,Yn:a,Zn:c}=Dt,u=l*s.m00+a*s.m10+c*s.m20,p=l*s.m01+a*s.m11+c*s.m21,d=l*s.m02+a*s.m12+c*s.m22,v=o.X*s.m00+o.Y*s.m10+o.Z*s.m20,b=o.X*s.m01+o.Y*s.m11+o.Z*s.m21,y=o.X*s.m02+o.Y*s.m12+o.Z*s.m22,w=(n*s.m00+t*s.m10+e*s.m20)*(v/u),_=(n*s.m01+t*s.m11+e*s.m21)*(b/p),q=(n*s.m02+t*s.m12+e*s.m22)*(y/d),z=w*i.m00+_*i.m10+q*i.m20,F=w*i.m01+_*i.m11+q*i.m21,$=w*i.m02+_*i.m12+q*i.m22,S=ni(z*r.m00+F*r.m10+$*r.m20),h=ni(z*r.m01+F*r.m11+$*r.m21),f=ni(z*r.m02+F*r.m12+$*r.m22);return[S*255,h*255,f*255]},Kr=(...n)=>{const[t,e,s,...i]=k(n,"rgb"),[r,o,l]=Uc(t,e,s),[a,c,u]=sw(r,o,l);return[a,c,u,...i.length>0&&i[0]<1?[i[0]]:[]]};function sw(n,t,e){const{Xn:s,Yn:i,Zn:r,kE:o,kK:l}=Dt,a=n/s,c=t/i,u=e/r,p=a>o?Math.pow(a,1/3):(l*a+16)/116,d=c>o?Math.pow(c,1/3):(l*c+16)/116,v=u>o?Math.pow(u,1/3):(l*u+16)/116;return[116*d-16,500*(p-d),200*(d-v)]}function si(n){const t=Math.sign(n);return n=Math.abs(n),(n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4))*t}const Uc=(n,t,e)=>{n=si(n/255),t=si(t/255),e=si(e/255);const{MtxRGB2XYZ:s,MtxAdaptMa:i,MtxAdaptMaI:r,Xn:o,Yn:l,Zn:a,As:c,Bs:u,Cs:p}=Dt;let d=n*s.m00+t*s.m10+e*s.m20,v=n*s.m01+t*s.m11+e*s.m21,b=n*s.m02+t*s.m12+e*s.m22;const y=o*i.m00+l*i.m10+a*i.m20,w=o*i.m01+l*i.m11+a*i.m21,_=o*i.m02+l*i.m12+a*i.m22;let q=d*i.m00+v*i.m10+b*i.m20,z=d*i.m01+v*i.m11+b*i.m21,F=d*i.m02+v*i.m12+b*i.m22;return q*=y/c,z*=w/u,F*=_/p,d=q*r.m00+z*r.m10+F*r.m20,v=q*r.m01+z*r.m11+F*r.m21,b=q*r.m02+z*r.m12+F*r.m22,[d,v,b]};m.prototype.lab=function(){return Kr(this._rgb)};const iw=(...n)=>new m(...n,"lab");Object.assign(A,{lab:iw,getLabWhitePoint:An,setLabWhitePoint:Ht});x.format.lab=zr;x.autodetect.push({p:2,test:(...n)=>{if(n=k(n,"lab"),T(n)==="array"&&n.length===3)return"lab"}});m.prototype.darken=function(n=1){const t=this,e=t.lab();return e[0]-=Dt.Kn*n,new m(e,"lab").alpha(t.alpha(),!0)};m.prototype.brighten=function(n=1){return this.darken(-n)};m.prototype.darker=m.prototype.darken;m.prototype.brighter=m.prototype.brighten;m.prototype.get=function(n){const[t,e]=n.split("."),s=this[t]();if(e){const i=t.indexOf(e)-(t.substr(0,2)==="ok"?2:0);if(i>-1)return s[i];throw new Error(`unknown channel ${e} in mode ${t}`)}else return s};const{pow:rw}=Math,ow=1e-7,lw=20;m.prototype.luminance=function(n,t="rgb"){if(n!==void 0&&T(n)==="number"){if(n===0)return new m([0,0,0,this._rgb[3]],"rgb");if(n===1)return new m([255,255,255,this._rgb[3]],"rgb");let e=this.luminance(),s=lw;const i=(o,l)=>{const a=o.interpolate(l,.5,t),c=a.luminance();return Math.abs(n-c)<ow||!s--?a:c>n?i(o,a):i(a,l)},r=(e>n?i(new m([0,0,0]),this):i(this,new m([255,255,255]))).rgb();return new m([...r,this._rgb[3]])}return aw(...this._rgb.slice(0,3))};const aw=(n,t,e)=>(n=ii(n),t=ii(t),e=ii(e),.2126*n+.7152*t+.0722*e),ii=n=>(n/=255,n<=.03928?n/12.92:rw((n+.055)/1.055,2.4)),rt={},Je=(n,t,e=.5,...s)=>{let i=s[0]||"lrgb";if(!rt[i]&&!s.length&&(i=Object.keys(rt)[0]),!rt[i])throw new Error(`interpolation mode ${i} is not defined`);return T(n)!=="object"&&(n=new m(n)),T(t)!=="object"&&(t=new m(t)),rt[i](n,t,e).alpha(n.alpha()+e*(t.alpha()-n.alpha()))};m.prototype.mix=m.prototype.interpolate=function(n,t=.5,...e){return Je(this,n,t,...e)};m.prototype.premultiply=function(n=!1){const t=this._rgb,e=t[3];return n?(this._rgb=[t[0]*e,t[1]*e,t[2]*e,e],this):new m([t[0]*e,t[1]*e,t[2]*e,e],"rgb")};const{sin:cw,cos:uw}=Math,qc=(...n)=>{let[t,e,s]=k(n,"lch");return isNaN(s)&&(s=0),s=s*W_,[t,uw(s)*e,cw(s)*e]},Ur=(...n)=>{n=k(n,"lch");const[t,e,s]=n,[i,r,o]=qc(t,e,s),[l,a,c]=zr(i,r,o);return[l,a,c,n.length>3?n[3]:1]},pw=(...n)=>{const t=Ic(k(n,"hcl"));return Ur(...t)},{sqrt:hw,atan2:dw,round:mw}=Math,Hc=(...n)=>{const[t,e,s]=k(n,"lab"),i=hw(e*e+s*s);let r=(dw(s,e)*Z_+360)%360;return mw(i*1e4)===0&&(r=Number.NaN),[t,i,r]},qr=(...n)=>{const[t,e,s,...i]=k(n,"rgb"),[r,o,l]=Kr(t,e,s),[a,c,u]=Hc(r,o,l);return[a,c,u,...i.length>0&&i[0]<1?[i[0]]:[]]};m.prototype.lch=function(){return qr(this._rgb)};m.prototype.hcl=function(){return Ic(qr(this._rgb))};const vw=(...n)=>new m(...n,"lch"),bw=(...n)=>new m(...n,"hcl");Object.assign(A,{lch:vw,hcl:bw});x.format.lch=Ur;x.format.hcl=pw;["lch","hcl"].forEach(n=>x.autodetect.push({p:2,test:(...t)=>{if(t=k(t,n),T(t)==="array"&&t.length===3)return n}}));m.prototype.saturate=function(n=1){const t=this,e=t.lch();return e[1]+=Dt.Kn*n,e[1]<0&&(e[1]=0),new m(e,"lch").alpha(t.alpha(),!0)};m.prototype.desaturate=function(n=1){return this.saturate(-n)};m.prototype.set=function(n,t,e=!1){const[s,i]=n.split("."),r=this[s]();if(i){const o=s.indexOf(i)-(s.substr(0,2)==="ok"?2:0);if(o>-1){if(T(t)=="string")switch(t.charAt(0)){case"+":r[o]+=+t;break;case"-":r[o]+=+t;break;case"*":r[o]*=+t.substr(1);break;case"/":r[o]/=+t.substr(1);break;default:r[o]=+t}else if(T(t)==="number")r[o]=t;else throw new Error("unsupported value for Color.set");const l=new m(r,s);return e?(this._rgb=l._rgb,this):l}throw new Error(`unknown channel ${i} in mode ${s}`)}else return r};m.prototype.tint=function(n=.5,...t){return Je(this,"white",n,...t)};m.prototype.shade=function(n=.5,...t){return Je(this,"black",n,...t)};const fw=(n,t,e)=>{const s=n._rgb,i=t._rgb;return new m(s[0]+e*(i[0]-s[0]),s[1]+e*(i[1]-s[1]),s[2]+e*(i[2]-s[2]),"rgb")};rt.rgb=fw;const{sqrt:ri,pow:Ie}=Math,_w=(n,t,e)=>{const[s,i,r]=n._rgb,[o,l,a]=t._rgb;return new m(ri(Ie(s,2)*(1-e)+Ie(o,2)*e),ri(Ie(i,2)*(1-e)+Ie(l,2)*e),ri(Ie(r,2)*(1-e)+Ie(a,2)*e),"rgb")};rt.lrgb=_w;const ww=(n,t,e)=>{const s=n.lab(),i=t.lab();return new m(s[0]+e*(i[0]-s[0]),s[1]+e*(i[1]-s[1]),s[2]+e*(i[2]-s[2]),"lab")};rt.lab=ww;const an=(n,t,e,s)=>{let i,r;s==="hsl"?(i=n.hsl(),r=t.hsl()):s==="hsv"?(i=n.hsv(),r=t.hsv()):s==="hcg"?(i=n.hcg(),r=t.hcg()):s==="hsi"?(i=n.hsi(),r=t.hsi()):s==="lch"||s==="hcl"?(s="hcl",i=n.hcl(),r=t.hcl()):s==="oklch"&&(i=n.oklch().reverse(),r=t.oklch().reverse());let o,l,a,c,u,p;(s.substr(0,1)==="h"||s==="oklch")&&([o,a,u]=i,[l,c,p]=r);let d,v,b,y;return!isNaN(o)&&!isNaN(l)?(l>o&&l-o>180?y=l-(o+360):l<o&&o-l>180?y=l+360-o:y=l-o,v=o+e*y):isNaN(o)?isNaN(l)?v=Number.NaN:(v=l,(u==1||u==0)&&s!="hsv"&&(d=c)):(v=o,(p==1||p==0)&&s!="hsv"&&(d=a)),d===void 0&&(d=a+e*(c-a)),b=u+e*(p-u),s==="oklch"?new m([b,d,v],s):new m([v,d,b],s)},Gc=(n,t,e)=>an(n,t,e,"lch");rt.lch=Gc;rt.hcl=Gc;const gw=n=>{if(T(n)=="number"&&n>=0&&n<=16777215){const t=n>>16,e=n>>8&255,s=n&255;return[t,e,s,1]}throw new Error("unknown num color: "+n)},Cw=(...n)=>{const[t,e,s]=k(n,"rgb");return(t<<16)+(e<<8)+s};m.prototype.num=function(){return Cw(this._rgb)};const yw=(...n)=>new m(...n,"num");Object.assign(A,{num:yw});x.format.num=gw;x.autodetect.push({p:5,test:(...n)=>{if(n.length===1&&T(n[0])==="number"&&n[0]>=0&&n[0]<=16777215)return"num"}});const xw=(n,t,e)=>{const s=n.num(),i=t.num();return new m(s+e*(i-s),"num")};rt.num=xw;const{floor:Pw}=Math,Ew=(...n)=>{n=k(n,"hcg");let[t,e,s]=n,i,r,o;s=s*255;const l=e*255;if(e===0)i=r=o=s;else{t===360&&(t=0),t>360&&(t-=360),t<0&&(t+=360),t/=60;const a=Pw(t),c=t-a,u=s*(1-e),p=u+l*(1-c),d=u+l*c,v=u+l;switch(a){case 0:[i,r,o]=[v,d,u];break;case 1:[i,r,o]=[p,v,u];break;case 2:[i,r,o]=[u,v,d];break;case 3:[i,r,o]=[u,p,v];break;case 4:[i,r,o]=[d,u,v];break;case 5:[i,r,o]=[v,u,p];break}}return[i,r,o,n.length>3?n[3]:1]},kw=(...n)=>{const[t,e,s]=k(n,"rgb"),i=Nc(t,e,s),r=jc(t,e,s),o=r-i,l=o*100/255,a=i/(255-o)*100;let c;return o===0?c=Number.NaN:(t===r&&(c=(e-s)/o),e===r&&(c=2+(s-t)/o),s===r&&(c=4+(t-e)/o),c*=60,c<0&&(c+=360)),[c,l,a]};m.prototype.hcg=function(){return kw(this._rgb)};const Vw=(...n)=>new m(...n,"hcg");A.hcg=Vw;x.format.hcg=Ew;x.autodetect.push({p:1,test:(...n)=>{if(n=k(n,"hcg"),T(n)==="array"&&n.length===3)return"hcg"}});const $w=(n,t,e)=>an(n,t,e,"hcg");rt.hcg=$w;const{cos:Fe}=Math,Sw=(...n)=>{n=k(n,"hsi");let[t,e,s]=n,i,r,o;return isNaN(t)&&(t=0),isNaN(e)&&(e=0),t>360&&(t-=360),t<0&&(t+=360),t/=360,t<1/3?(o=(1-e)/3,i=(1+e*Fe(Kt*t)/Fe(ei-Kt*t))/3,r=1-(o+i)):t<2/3?(t-=1/3,i=(1-e)/3,r=(1+e*Fe(Kt*t)/Fe(ei-Kt*t))/3,o=1-(i+r)):(t-=2/3,r=(1-e)/3,o=(1+e*Fe(Kt*t)/Fe(ei-Kt*t))/3,i=1-(r+o)),i=Ce(s*i*3),r=Ce(s*r*3),o=Ce(s*o*3),[i*255,r*255,o*255,n.length>3?n[3]:1]},{min:Lw,sqrt:Mw,acos:Aw}=Math,Tw=(...n)=>{let[t,e,s]=k(n,"rgb");t/=255,e/=255,s/=255;let i;const r=Lw(t,e,s),o=(t+e+s)/3,l=o>0?1-r/o:0;return l===0?i=NaN:(i=(t-e+(t-s))/2,i/=Mw((t-e)*(t-e)+(t-s)*(e-s)),i=Aw(i),s>e&&(i=Kt-i),i/=Kt),[i*360,l,o]};m.prototype.hsi=function(){return Tw(this._rgb)};const Ow=(...n)=>new m(...n,"hsi");A.hsi=Ow;x.format.hsi=Sw;x.autodetect.push({p:2,test:(...n)=>{if(n=k(n,"hsi"),T(n)==="array"&&n.length===3)return"hsi"}});const Rw=(n,t,e)=>an(n,t,e,"hsi");rt.hsi=Rw;const Si=(...n)=>{n=k(n,"hsl");const[t,e,s]=n;let i,r,o;if(e===0)i=r=o=s*255;else{const l=[0,0,0],a=[0,0,0],c=s<.5?s*(1+e):s+e-s*e,u=2*s-c,p=t/360;l[0]=p+1/3,l[1]=p,l[2]=p-1/3;for(let d=0;d<3;d++)l[d]<0&&(l[d]+=1),l[d]>1&&(l[d]-=1),6*l[d]<1?a[d]=u+(c-u)*6*l[d]:2*l[d]<1?a[d]=c:3*l[d]<2?a[d]=u+(c-u)*(2/3-l[d])*6:a[d]=u;[i,r,o]=[a[0]*255,a[1]*255,a[2]*255]}return n.length>3?[i,r,o,n[3]]:[i,r,o,1]},Yc=(...n)=>{n=k(n,"rgba");let[t,e,s]=n;t/=255,e/=255,s/=255;const i=Nc(t,e,s),r=jc(t,e,s),o=(r+i)/2;let l,a;return r===i?(l=0,a=Number.NaN):l=o<.5?(r-i)/(r+i):(r-i)/(2-r-i),t==r?a=(e-s)/(r-i):e==r?a=2+(s-t)/(r-i):s==r&&(a=4+(t-e)/(r-i)),a*=60,a<0&&(a+=360),n.length>3&&n[3]!==void 0?[a,l,o,n[3]]:[a,l,o]};m.prototype.hsl=function(){return Yc(this._rgb)};const Dw=(...n)=>new m(...n,"hsl");A.hsl=Dw;x.format.hsl=Si;x.autodetect.push({p:2,test:(...n)=>{if(n=k(n,"hsl"),T(n)==="array"&&n.length===3)return"hsl"}});const Bw=(n,t,e)=>an(n,t,e,"hsl");rt.hsl=Bw;const{floor:Nw}=Math,jw=(...n)=>{n=k(n,"hsv");let[t,e,s]=n,i,r,o;if(s*=255,e===0)i=r=o=s;else{t===360&&(t=0),t>360&&(t-=360),t<0&&(t+=360),t/=60;const l=Nw(t),a=t-l,c=s*(1-e),u=s*(1-e*a),p=s*(1-e*(1-a));switch(l){case 0:[i,r,o]=[s,p,c];break;case 1:[i,r,o]=[u,s,c];break;case 2:[i,r,o]=[c,s,p];break;case 3:[i,r,o]=[c,u,s];break;case 4:[i,r,o]=[p,c,s];break;case 5:[i,r,o]=[s,c,u];break}}return[i,r,o,n.length>3?n[3]:1]},{min:Iw,max:Fw}=Math,zw=(...n)=>{n=k(n,"rgb");let[t,e,s]=n;const i=Iw(t,e,s),r=Fw(t,e,s),o=r-i;let l,a,c;return c=r/255,r===0?(l=Number.NaN,a=0):(a=o/r,t===r&&(l=(e-s)/o),e===r&&(l=2+(s-t)/o),s===r&&(l=4+(t-e)/o),l*=60,l<0&&(l+=360)),[l,a,c]};m.prototype.hsv=function(){return zw(this._rgb)};const Kw=(...n)=>new m(...n,"hsv");A.hsv=Kw;x.format.hsv=jw;x.autodetect.push({p:2,test:(...n)=>{if(n=k(n,"hsv"),T(n)==="array"&&n.length===3)return"hsv"}});const Uw=(n,t,e)=>an(n,t,e,"hsv");rt.hsv=Uw;function bs(n,t){let e=n.length;Array.isArray(n[0])||(n=[n]),Array.isArray(t[0])||(t=t.map(o=>[o]));let s=t[0].length,i=t[0].map((o,l)=>t.map(a=>a[l])),r=n.map(o=>i.map(l=>Array.isArray(o)?o.reduce((a,c,u)=>a+c*(l[u]||0),0):l.reduce((a,c)=>a+c*o,0)));return e===1&&(r=r[0]),s===1?r.map(o=>o[0]):r}const Hr=(...n)=>{n=k(n,"lab");const[t,e,s,...i]=n,[r,o,l]=qw([t,e,s]),[a,c,u]=Kc(r,o,l);return[a,c,u,...i.length>0&&i[0]<1?[i[0]]:[]]};function qw(n){var t=[[1.2268798758459243,-.5578149944602171,.2813910456659647],[-.0405757452148008,1.112286803280317,-.0717110580655164],[-.0763729366746601,-.4214933324022432,1.5869240198367816]],e=[[1,.3963377773761749,.2158037573099136],[1,-.1055613458156586,-.0638541728258133],[1,-.0894841775298119,-1.2914855480194092]],s=bs(e,n);return bs(t,s.map(i=>i**3))}const Gr=(...n)=>{const[t,e,s,...i]=k(n,"rgb"),r=Uc(t,e,s);return[...Hw(r),...i.length>0&&i[0]<1?[i[0]]:[]]};function Hw(n){const t=[[.819022437996703,.3619062600528904,-.1288737815209879],[.0329836539323885,.9292868615863434,.0361446663506424],[.0481771893596242,.2642395317527308,.6335478284694309]],e=[[.210454268309314,.7936177747023054,-.0040720430116193],[1.9779985324311684,-2.42859224204858,.450593709617411],[.0259040424655478,.7827717124575296,-.8086757549230774]],s=bs(t,n);return bs(e,s.map(i=>Math.cbrt(i)))}m.prototype.oklab=function(){return Gr(this._rgb)};const Gw=(...n)=>new m(...n,"oklab");Object.assign(A,{oklab:Gw});x.format.oklab=Hr;x.autodetect.push({p:2,test:(...n)=>{if(n=k(n,"oklab"),T(n)==="array"&&n.length===3)return"oklab"}});const Yw=(n,t,e)=>{const s=n.oklab(),i=t.oklab();return new m(s[0]+e*(i[0]-s[0]),s[1]+e*(i[1]-s[1]),s[2]+e*(i[2]-s[2]),"oklab")};rt.oklab=Yw;const Xw=(n,t,e)=>an(n,t,e,"oklch");rt.oklch=Xw;const{pow:oi,sqrt:li,PI:ai,cos:rl,sin:ol,atan2:Ww}=Math,Zw=(n,t="lrgb",e=null)=>{const s=n.length;e||(e=Array.from(new Array(s)).map(()=>1));const i=s/e.reduce(function(p,d){return p+d});if(e.forEach((p,d)=>{e[d]*=i}),n=n.map(p=>new m(p)),t==="lrgb")return Jw(n,e);const r=n.shift(),o=r.get(t),l=[];let a=0,c=0;for(let p=0;p<o.length;p++)if(o[p]=(o[p]||0)*e[0],l.push(isNaN(o[p])?0:e[0]),t.charAt(p)==="h"&&!isNaN(o[p])){const d=o[p]/180*ai;a+=rl(d)*e[0],c+=ol(d)*e[0]}let u=r.alpha()*e[0];n.forEach((p,d)=>{const v=p.get(t);u+=p.alpha()*e[d+1];for(let b=0;b<o.length;b++)if(!isNaN(v[b]))if(l[b]+=e[d+1],t.charAt(b)==="h"){const y=v[b]/180*ai;a+=rl(y)*e[d+1],c+=ol(y)*e[d+1]}else o[b]+=v[b]*e[d+1]});for(let p=0;p<o.length;p++)if(t.charAt(p)==="h"){let d=Ww(c/l[p],a/l[p])/ai*180;for(;d<0;)d+=360;for(;d>=360;)d-=360;o[p]=d}else o[p]=o[p]/l[p];return u/=s,new m(o,t).alpha(u>.99999?1:u,!0)},Jw=(n,t)=>{const e=n.length,s=[0,0,0,0];for(let i=0;i<n.length;i++){const r=n[i],o=t[i]/e,l=r._rgb;s[0]+=oi(l[0],2)*o,s[1]+=oi(l[1],2)*o,s[2]+=oi(l[2],2)*o,s[3]+=l[3]*o}return s[0]=li(s[0]),s[1]=li(s[1]),s[2]=li(s[2]),s[3]>.9999999&&(s[3]=1),new m(Fr(s))},{pow:Qw}=Math;function fs(n){let t="rgb",e=A("#ccc"),s=0,i=[0,1],r=[],o=[0,0],l=!1,a=[],c=!1,u=0,p=1,d=!1,v={},b=!0,y=1;const w=function(h){if(h=h||["#fff","#000"],h&&T(h)==="string"&&A.brewer&&A.brewer[h.toLowerCase()]&&(h=A.brewer[h.toLowerCase()]),T(h)==="array"){h.length===1&&(h=[h[0],h[0]]),h=h.slice(0);for(let f=0;f<h.length;f++)h[f]=A(h[f]);r.length=0;for(let f=0;f<h.length;f++)r.push(f/(h.length-1))}return $(),a=h},_=function(h){if(l!=null){const f=l.length-1;let C=0;for(;C<f&&h>=l[C];)C++;return C-1}return 0};let q=h=>h,z=h=>h;const F=function(h,f){let C,g;if(f==null&&(f=!1),isNaN(h)||h===null)return e;f?g=h:l&&l.length>2?g=_(h)/(l.length-2):p!==u?g=(h-u)/(p-u):g=1,g=z(g),f||(g=q(g)),y!==1&&(g=Qw(g,y)),g=o[0]+g*(1-o[0]-o[1]),g=Ce(g,0,1);const L=Math.floor(g*1e4);if(b&&v[L])C=v[L];else{if(T(a)==="array")for(let M=0;M<r.length;M++){const j=r[M];if(g<=j){C=a[M];break}if(g>=j&&M===r.length-1){C=a[M];break}if(g>j&&g<r[M+1]){g=(g-j)/(r[M+1]-j),C=A.interpolate(a[M],a[M+1],g,t);break}}else T(a)==="function"&&(C=a(g));b&&(v[L]=C)}return C};var $=()=>v={};w(n);const S=function(h){const f=A(F(h));return c&&f[c]?f[c]():f};return S.classes=function(h){if(h!=null){if(T(h)==="array")l=h,i=[h[0],h[h.length-1]];else{const f=A.analyze(i);h===0?l=[f.min,f.max]:l=A.limits(f,"e",h)}return S}return l},S.domain=function(h){if(!arguments.length)return i;u=h[0],p=h[h.length-1],r=[];const f=a.length;if(h.length===f&&u!==p)for(let C of Array.from(h))r.push((C-u)/(p-u));else{for(let C=0;C<f;C++)r.push(C/(f-1));if(h.length>2){const C=h.map((L,M)=>M/(h.length-1)),g=h.map(L=>(L-u)/(p-u));g.every((L,M)=>C[M]===L)||(z=L=>{if(L<=0||L>=1)return L;let M=0;for(;L>=g[M+1];)M++;const j=(L-g[M])/(g[M+1]-g[M]);return C[M]+j*(C[M+1]-C[M])})}}return i=[u,p],S},S.mode=function(h){return arguments.length?(t=h,$(),S):t},S.range=function(h,f){return w(h),S},S.out=function(h){return c=h,S},S.spread=function(h){return arguments.length?(s=h,S):s},S.correctLightness=function(h){return h==null&&(h=!0),d=h,$(),d?q=function(f){const C=F(0,!0).lab()[0],g=F(1,!0).lab()[0],L=C>g;let M=F(f,!0).lab()[0];const j=C+(g-C)*f;let At=M-j,pn=0,Gn=1,Yn=20;for(;Math.abs(At)>.01&&Yn-- >0;)(function(){return L&&(At*=-1),At<0?(pn=f,f+=(Gn-f)*.5):(Gn=f,f+=(pn-f)*.5),M=F(f,!0).lab()[0],At=M-j})();return f}:q=f=>f,S},S.padding=function(h){return h!=null?(T(h)==="number"&&(h=[h,h]),o=h,S):o},S.colors=function(h,f){arguments.length<2&&(f="hex");let C=[];if(arguments.length===0)C=a.slice(0);else if(h===1)C=[S(.5)];else if(h>1){const g=i[0],L=i[1]-g;C=t0(0,h).map(M=>S(g+M/(h-1)*L))}else{n=[];let g=[];if(l&&l.length>2)for(let L=1,M=l.length,j=1<=M;j?L<M:L>M;j?L++:L--)g.push((l[L-1]+l[L])*.5);else g=i;C=g.map(L=>S(L))}return A[f]&&(C=C.map(g=>g[f]())),C},S.cache=function(h){return h!=null?(b=h,S):b},S.gamma=function(h){return h!=null?(y=h,S):y},S.nodata=function(h){return h!=null?(e=A(h),S):e},S}function t0(n,t,e){let s=[],i=n<t,r=t;for(let o=n;i?o<r:o>r;i?o++:o--)s.push(o);return s}const e0=function(n){let t=[1,1];for(let e=1;e<n;e++){let s=[1];for(let i=1;i<=t.length;i++)s[i]=(t[i]||0)+t[i-1];t=s}return t},n0=function(n){let t,e,s,i;if(n=n.map(r=>new m(r)),n.length===2)[e,s]=n.map(r=>r.lab()),t=function(r){const o=[0,1,2].map(l=>e[l]+r*(s[l]-e[l]));return new m(o,"lab")};else if(n.length===3)[e,s,i]=n.map(r=>r.lab()),t=function(r){const o=[0,1,2].map(l=>(1-r)*(1-r)*e[l]+2*(1-r)*r*s[l]+r*r*i[l]);return new m(o,"lab")};else if(n.length===4){let r;[e,s,i,r]=n.map(o=>o.lab()),t=function(o){const l=[0,1,2].map(a=>(1-o)*(1-o)*(1-o)*e[a]+3*(1-o)*(1-o)*o*s[a]+3*(1-o)*o*o*i[a]+o*o*o*r[a]);return new m(l,"lab")}}else if(n.length>=5){let r,o,l;r=n.map(a=>a.lab()),l=n.length-1,o=e0(l),t=function(a){const c=1-a,u=[0,1,2].map(p=>r.reduce((d,v,b)=>d+o[b]*c**(l-b)*a**b*v[p],0));return new m(u,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return t},s0=n=>{const t=n0(n);return t.scale=()=>fs(t),t},{round:Xc}=Math;m.prototype.rgb=function(n=!0){return n===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Xc)};m.prototype.rgba=function(n=!0){return this._rgb.slice(0,4).map((t,e)=>e<3?n===!1?t:Xc(t):t)};const i0=(...n)=>new m(...n,"rgb");Object.assign(A,{rgb:i0});x.format.rgb=(...n)=>{const t=k(n,"rgba");return t[3]===void 0&&(t[3]=1),t};x.autodetect.push({p:3,test:(...n)=>{if(n=k(n,"rgba"),T(n)==="array"&&(n.length===3||n.length===4&&T(n[3])=="number"&&n[3]>=0&&n[3]<=1))return"rgb"}});const St=(n,t,e)=>{if(!St[e])throw new Error("unknown blend mode "+e);return St[e](n,t)},me=n=>(t,e)=>{const s=A(e).rgb(),i=A(t).rgb();return A.rgb(n(s,i))},ve=n=>(t,e)=>{const s=[];return s[0]=n(t[0],e[0]),s[1]=n(t[1],e[1]),s[2]=n(t[2],e[2]),s},r0=n=>n,o0=(n,t)=>n*t/255,l0=(n,t)=>n>t?t:n,a0=(n,t)=>n>t?n:t,c0=(n,t)=>255*(1-(1-n/255)*(1-t/255)),u0=(n,t)=>t<128?2*n*t/255:255*(1-2*(1-n/255)*(1-t/255)),p0=(n,t)=>255*(1-(1-t/255)/(n/255)),h0=(n,t)=>n===255?255:(n=255*(t/255)/(1-n/255),n>255?255:n);St.normal=me(ve(r0));St.multiply=me(ve(o0));St.screen=me(ve(c0));St.overlay=me(ve(u0));St.darken=me(ve(l0));St.lighten=me(ve(a0));St.dodge=me(ve(h0));St.burn=me(ve(p0));const{pow:d0,sin:m0,cos:v0}=Math;function b0(n=300,t=-1.5,e=1,s=1,i=[0,1]){let r=0,o;T(i)==="array"?o=i[1]-i[0]:(o=0,i=[i,i]);const l=function(a){const c=Kt*((n+120)/360+t*a),u=d0(i[0]+o*a,s),d=(r!==0?e[0]+a*r:e)*u*(1-u)/2,v=v0(c),b=m0(c),y=u+d*(-.14861*v+1.78277*b),w=u+d*(-.29227*v-.90649*b),_=u+d*(1.97294*v);return A(Fr([y*255,w*255,_*255,1]))};return l.start=function(a){return a==null?n:(n=a,l)},l.rotations=function(a){return a==null?t:(t=a,l)},l.gamma=function(a){return a==null?s:(s=a,l)},l.hue=function(a){return a==null?e:(e=a,T(e)==="array"?(r=e[1]-e[0],r===0&&(e=e[1])):r=0,l)},l.lightness=function(a){return a==null?i:(T(a)==="array"?(i=a,o=a[1]-a[0]):(i=[a,a],o=0),l)},l.scale=()=>A.scale(l),l.hue(e),l}const f0="0123456789abcdef",{floor:_0,random:w0}=Math,g0=()=>{let n="#";for(let t=0;t<6;t++)n+=f0.charAt(_0(w0()*16));return new m(n,"hex")},{log:ll,pow:C0,floor:y0,abs:x0}=Math;function Wc(n,t=null){const e={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return T(n)==="object"&&(n=Object.values(n)),n.forEach(s=>{t&&T(s)==="object"&&(s=s[t]),s!=null&&!isNaN(s)&&(e.values.push(s),e.sum+=s,s<e.min&&(e.min=s),s>e.max&&(e.max=s),e.count+=1)}),e.domain=[e.min,e.max],e.limits=(s,i)=>Zc(e,s,i),e}function Zc(n,t="equal",e=7){T(n)=="array"&&(n=Wc(n));const{min:s,max:i}=n,r=n.values.sort((l,a)=>l-a);if(e===1)return[s,i];const o=[];if(t.substr(0,1)==="c"&&(o.push(s),o.push(i)),t.substr(0,1)==="e"){o.push(s);for(let l=1;l<e;l++)o.push(s+l/e*(i-s));o.push(i)}else if(t.substr(0,1)==="l"){if(s<=0)throw new Error("Logarithmic scales are only possible for values > 0");const l=Math.LOG10E*ll(s),a=Math.LOG10E*ll(i);o.push(s);for(let c=1;c<e;c++)o.push(C0(10,l+c/e*(a-l)));o.push(i)}else if(t.substr(0,1)==="q"){o.push(s);for(let l=1;l<e;l++){const a=(r.length-1)*l/e,c=y0(a);if(c===a)o.push(r[c]);else{const u=a-c;o.push(r[c]*(1-u)+r[c+1]*u)}}o.push(i)}else if(t.substr(0,1)==="k"){let l;const a=r.length,c=new Array(a),u=new Array(e);let p=!0,d=0,v=null;v=[],v.push(s);for(let w=1;w<e;w++)v.push(s+w/e*(i-s));for(v.push(i);p;){for(let _=0;_<e;_++)u[_]=0;for(let _=0;_<a;_++){const q=r[_];let z=Number.MAX_VALUE,F;for(let $=0;$<e;$++){const S=x0(v[$]-q);S<z&&(z=S,F=$),u[F]++,c[_]=F}}const w=new Array(e);for(let _=0;_<e;_++)w[_]=null;for(let _=0;_<a;_++)l=c[_],w[l]===null?w[l]=r[_]:w[l]+=r[_];for(let _=0;_<e;_++)w[_]*=1/u[_];p=!1;for(let _=0;_<e;_++)if(w[_]!==v[_]){p=!0;break}v=w,d++,d>200&&(p=!1)}const b={};for(let w=0;w<e;w++)b[w]=[];for(let w=0;w<a;w++)l=c[w],b[l].push(r[w]);let y=[];for(let w=0;w<e;w++)y.push(b[w][0]),y.push(b[w][b[w].length-1]);y=y.sort((w,_)=>w-_),o.push(y[0]);for(let w=1;w<y.length;w+=2){const _=y[w];!isNaN(_)&&o.indexOf(_)===-1&&o.push(_)}}return o}const P0=(n,t)=>{n=new m(n),t=new m(t);const e=n.luminance(),s=t.luminance();return e>s?(e+.05)/(s+.05):(s+.05)/(e+.05)};/**
 * @license
 *
 * The APCA contrast prediction algorithm is based of the formulas published
 * in the APCA-1.0.98G specification by Myndex. The specification is available at:
 * https://raw.githubusercontent.com/Myndex/apca-w3/master/images/APCAw3_0.1.17_APCA0.0.98G.svg
 *
 * Note that the APCA implementation is still beta, so please update to
 * future versions of chroma.js when they become available.
 *
 * You can read more about the APCA Readability Criterion at
 * https://readtech.org/ARC/
 */const al=.027,E0=5e-4,k0=.1,cl=1.14,Jn=.022,ul=1.414,V0=(n,t)=>{n=new m(n),t=new m(t),n.alpha()<1&&(n=Je(t,n,n.alpha(),"rgb"));const e=pl(...n.rgb()),s=pl(...t.rgb()),i=e>=Jn?e:e+Math.pow(Jn-e,ul),r=s>=Jn?s:s+Math.pow(Jn-s,ul),o=Math.pow(r,.56)-Math.pow(i,.57),l=Math.pow(r,.65)-Math.pow(i,.62),a=Math.abs(r-i)<E0?0:i<r?o*cl:l*cl;return(Math.abs(a)<k0?0:a>0?a-al:a+al)*100};function pl(n,t,e){return .2126729*Math.pow(n/255,2.4)+.7151522*Math.pow(t/255,2.4)+.072175*Math.pow(e/255,2.4)}const{sqrt:zt,pow:Z,min:$0,max:S0,atan2:hl,abs:dl,cos:Qn,sin:ml,exp:L0,PI:vl}=Math;function M0(n,t,e=1,s=1,i=1){var r=function(Rs){return 360*Rs/(2*vl)},o=function(Rs){return 2*vl*Rs/360};n=new m(n),t=new m(t);const[l,a,c]=Array.from(n.lab()),[u,p,d]=Array.from(t.lab()),v=(l+u)/2,b=zt(Z(a,2)+Z(c,2)),y=zt(Z(p,2)+Z(d,2)),w=(b+y)/2,_=.5*(1-zt(Z(w,7)/(Z(w,7)+Z(25,7)))),q=a*(1+_),z=p*(1+_),F=zt(Z(q,2)+Z(c,2)),$=zt(Z(z,2)+Z(d,2)),S=(F+$)/2,h=r(hl(c,q)),f=r(hl(d,z)),C=h>=0?h:h+360,g=f>=0?f:f+360,L=dl(C-g)>180?(C+g+360)/2:(C+g)/2,M=1-.17*Qn(o(L-30))+.24*Qn(o(2*L))+.32*Qn(o(3*L+6))-.2*Qn(o(4*L-63));let j=g-C;j=dl(j)<=180?j:g<=C?j+360:j-360,j=2*zt(F*$)*ml(o(j)/2);const At=u-l,pn=$-F,Gn=1+.015*Z(v-50,2)/zt(20+Z(v-50,2)),Yn=1+.045*S,Wr=1+.015*S*M,du=30*L0(-Z((L-275)/25,2)),mu=-(2*zt(Z(S,7)/(Z(S,7)+Z(25,7))))*ml(2*o(du)),vu=zt(Z(At/(e*Gn),2)+Z(pn/(s*Yn),2)+Z(j/(i*Wr),2)+mu*(pn/(s*Yn))*(j/(i*Wr)));return S0(0,$0(100,vu))}function A0(n,t,e="lab"){n=new m(n),t=new m(t);const s=n.get(e),i=t.get(e);let r=0;for(let o in s){const l=(s[o]||0)-(i[o]||0);r+=l*l}return Math.sqrt(r)}const T0=(...n)=>{try{return new m(...n),!0}catch{return!1}},O0={cool(){return fs([A.hsl(180,1,.9),A.hsl(250,.7,.4)])},hot(){return fs(["#000","#f00","#ff0","#fff"]).mode("rgb")}},Li={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Jc=Object.keys(Li),bl=new Map(Jc.map(n=>[n.toLowerCase(),n])),R0=typeof Proxy=="function"?new Proxy(Li,{get(n,t){const e=t.toLowerCase();if(bl.has(e))return n[bl.get(e)]},getOwnPropertyNames(){return Object.getOwnPropertyNames(Jc)}}):Li,D0=(...n)=>{n=k(n,"cmyk");const[t,e,s,i]=n,r=n.length>4?n[4]:1;return i===1?[0,0,0,r]:[t>=1?0:255*(1-t)*(1-i),e>=1?0:255*(1-e)*(1-i),s>=1?0:255*(1-s)*(1-i),r]},{max:fl}=Math,B0=(...n)=>{let[t,e,s]=k(n,"rgb");t=t/255,e=e/255,s=s/255;const i=1-fl(t,fl(e,s)),r=i<1?1/(1-i):0,o=(1-t-i)*r,l=(1-e-i)*r,a=(1-s-i)*r;return[o,l,a,i]};m.prototype.cmyk=function(){return B0(this._rgb)};const N0=(...n)=>new m(...n,"cmyk");Object.assign(A,{cmyk:N0});x.format.cmyk=D0;x.autodetect.push({p:2,test:(...n)=>{if(n=k(n,"cmyk"),T(n)==="array"&&n.length===4)return"cmyk"}});const j0=(...n)=>{const t=k(n,"hsla");let e=ln(n)||"lsa";return t[0]=xt(t[0]||0)+"deg",t[1]=xt(t[1]*100)+"%",t[2]=xt(t[2]*100)+"%",e==="hsla"||t.length>3&&t[3]<1?(t[3]="/ "+(t.length>3?t[3]:1),e="hsla"):t.length=3,`${e.substr(0,3)}(${t.join(" ")})`},I0=(...n)=>{const t=k(n,"lab");let e=ln(n)||"lab";return t[0]=xt(t[0])+"%",t[1]=xt(t[1]),t[2]=xt(t[2]),e==="laba"||t.length>3&&t[3]<1?t[3]="/ "+(t.length>3?t[3]:1):t.length=3,`lab(${t.join(" ")})`},F0=(...n)=>{const t=k(n,"lch");let e=ln(n)||"lab";return t[0]=xt(t[0])+"%",t[1]=xt(t[1]),t[2]=isNaN(t[2])?"none":xt(t[2])+"deg",e==="lcha"||t.length>3&&t[3]<1?t[3]="/ "+(t.length>3?t[3]:1):t.length=3,`lch(${t.join(" ")})`},z0=(...n)=>{const t=k(n,"lab");return t[0]=xt(t[0]*100)+"%",t[1]=$i(t[1]),t[2]=$i(t[2]),t.length>3&&t[3]<1?t[3]="/ "+(t.length>3?t[3]:1):t.length=3,`oklab(${t.join(" ")})`},Qc=(...n)=>{const[t,e,s,...i]=k(n,"rgb"),[r,o,l]=Gr(t,e,s),[a,c,u]=Hc(r,o,l);return[a,c,u,...i.length>0&&i[0]<1?[i[0]]:[]]},K0=(...n)=>{const t=k(n,"lch");return t[0]=xt(t[0]*100)+"%",t[1]=$i(t[1]),t[2]=isNaN(t[2])?"none":xt(t[2])+"deg",t.length>3&&t[3]<1?t[3]="/ "+(t.length>3?t[3]:1):t.length=3,`oklch(${t.join(" ")})`},{round:ci}=Math,U0=(...n)=>{const t=k(n,"rgba");let e=ln(n)||"rgb";if(e.substr(0,3)==="hsl")return j0(Yc(t),e);if(e.substr(0,3)==="lab"){const s=An();Ht("d50");const i=I0(Kr(t),e);return Ht(s),i}if(e.substr(0,3)==="lch"){const s=An();Ht("d50");const i=F0(qr(t),e);return Ht(s),i}return e.substr(0,5)==="oklab"?z0(Gr(t)):e.substr(0,5)==="oklch"?K0(Qc(t)):(t[0]=ci(t[0]),t[1]=ci(t[1]),t[2]=ci(t[2]),(e==="rgba"||t.length>3&&t[3]<1)&&(t[3]="/ "+(t.length>3?t[3]:1),e="rgba"),`${e.substr(0,3)}(${t.slice(0,e==="rgb"?3:4).join(" ")})`)},tu=(...n)=>{n=k(n,"lch");const[t,e,s,...i]=n,[r,o,l]=qc(t,e,s),[a,c,u]=Hr(r,o,l);return[a,c,u,...i.length>0&&i[0]<1?[i[0]]:[]]},Yt=/((?:-?\d+)|(?:-?\d+(?:\.\d+)?)%|none)/.source,kt=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)%?)|none)/.source,_s=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)%)|none)/.source,Et=/\s*/.source,cn=/\s+/.source,Yr=/\s*,\s*/.source,Os=/((?:-?(?:\d+(?:\.\d*)?|\.\d+)(?:deg)?)|none)/.source,un=/\s*(?:\/\s*((?:[01]|[01]?\.\d+)|\d+(?:\.\d+)?%))?/.source,eu=new RegExp("^rgba?\\("+Et+[Yt,Yt,Yt].join(cn)+un+"\\)$"),nu=new RegExp("^rgb\\("+Et+[Yt,Yt,Yt].join(Yr)+Et+"\\)$"),su=new RegExp("^rgba\\("+Et+[Yt,Yt,Yt,kt].join(Yr)+Et+"\\)$"),iu=new RegExp("^hsla?\\("+Et+[Os,_s,_s].join(cn)+un+"\\)$"),ru=new RegExp("^hsl?\\("+Et+[Os,_s,_s].join(Yr)+Et+"\\)$"),ou=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,lu=new RegExp("^lab\\("+Et+[kt,kt,kt].join(cn)+un+"\\)$"),au=new RegExp("^lch\\("+Et+[kt,kt,Os].join(cn)+un+"\\)$"),cu=new RegExp("^oklab\\("+Et+[kt,kt,kt].join(cn)+un+"\\)$"),uu=new RegExp("^oklch\\("+Et+[kt,kt,Os].join(cn)+un+"\\)$"),{round:pu}=Math,ze=n=>n.map((t,e)=>e<=2?Ce(pu(t),0,255):t),J=(n,t=0,e=100,s=!1)=>(typeof n=="string"&&n.endsWith("%")&&(n=parseFloat(n.substring(0,n.length-1))/100,s?n=t+(n+1)*.5*(e-t):n=t+n*(e-t)),+n),lt=(n,t)=>n==="none"?t:n,Xr=n=>{if(n=n.toLowerCase().trim(),n==="transparent")return[0,0,0,0];let t;if(x.format.named)try{return x.format.named(n)}catch{}if((t=n.match(eu))||(t=n.match(nu))){let e=t.slice(1,4);for(let i=0;i<3;i++)e[i]=+J(lt(e[i],0),0,255);e=ze(e);const s=t[4]!==void 0?+J(t[4],0,1):1;return e[3]=s,e}if(t=n.match(su)){const e=t.slice(1,5);for(let s=0;s<4;s++)e[s]=+J(e[s],0,255);return e}if((t=n.match(iu))||(t=n.match(ru))){const e=t.slice(1,4);e[0]=+lt(e[0].replace("deg",""),0),e[1]=+J(lt(e[1],0),0,100)*.01,e[2]=+J(lt(e[2],0),0,100)*.01;const s=ze(Si(e)),i=t[4]!==void 0?+J(t[4],0,1):1;return s[3]=i,s}if(t=n.match(ou)){const e=t.slice(1,4);e[1]*=.01,e[2]*=.01;const s=Si(e);for(let i=0;i<3;i++)s[i]=pu(s[i]);return s[3]=+t[4],s}if(t=n.match(lu)){const e=t.slice(1,4);e[0]=J(lt(e[0],0),0,100),e[1]=J(lt(e[1],0),-125,125,!0),e[2]=J(lt(e[2],0),-125,125,!0);const s=An();Ht("d50");const i=ze(zr(e));Ht(s);const r=t[4]!==void 0?+J(t[4],0,1):1;return i[3]=r,i}if(t=n.match(au)){const e=t.slice(1,4);e[0]=J(e[0],0,100),e[1]=J(lt(e[1],0),0,150,!1),e[2]=+lt(e[2].replace("deg",""),0);const s=An();Ht("d50");const i=ze(Ur(e));Ht(s);const r=t[4]!==void 0?+J(t[4],0,1):1;return i[3]=r,i}if(t=n.match(cu)){const e=t.slice(1,4);e[0]=J(lt(e[0],0),0,1),e[1]=J(lt(e[1],0),-.4,.4,!0),e[2]=J(lt(e[2],0),-.4,.4,!0);const s=ze(Hr(e)),i=t[4]!==void 0?+J(t[4],0,1):1;return s[3]=i,s}if(t=n.match(uu)){const e=t.slice(1,4);e[0]=J(lt(e[0],0),0,1),e[1]=J(lt(e[1],0),0,.4,!1),e[2]=+lt(e[2].replace("deg",""),0);const s=ze(tu(e)),i=t[4]!==void 0?+J(t[4],0,1):1;return s[3]=i,s}};Xr.test=n=>eu.test(n)||iu.test(n)||lu.test(n)||au.test(n)||cu.test(n)||uu.test(n)||nu.test(n)||su.test(n)||ru.test(n)||ou.test(n)||n==="transparent";m.prototype.css=function(n){return U0(this._rgb,n)};const q0=(...n)=>new m(...n,"css");A.css=q0;x.format.css=Xr;x.autodetect.push({p:5,test:(n,...t)=>{if(!t.length&&T(n)==="string"&&Xr.test(n))return"css"}});x.format.gl=(...n)=>{const t=k(n,"rgba");return t[0]*=255,t[1]*=255,t[2]*=255,t};const H0=(...n)=>new m(...n,"gl");A.gl=H0;m.prototype.gl=function(){const n=this._rgb;return[n[0]/255,n[1]/255,n[2]/255,n[3]]};m.prototype.hex=function(n){return zc(this._rgb,n)};const G0=(...n)=>new m(...n,"hex");A.hex=G0;x.format.hex=Fc;x.autodetect.push({p:4,test:(n,...t)=>{if(!t.length&&T(n)==="string"&&[3,4,5,6,7,8,9].indexOf(n.length)>=0)return"hex"}});const{log:ts}=Math,hu=n=>{const t=n/100;let e,s,i;return t<66?(e=255,s=t<6?0:-155.25485562709179-.44596950469579133*(s=t-2)+104.49216199393888*ts(s),i=t<20?0:-254.76935184120902+.8274096064007395*(i=t-10)+115.67994401066147*ts(i)):(e=351.97690566805693+.114206453784165*(e=t-55)-40.25366309332127*ts(e),s=325.4494125711974+.07943456536662342*(s=t-50)-28.0852963507957*ts(s),i=255),[e,s,i,1]},{round:Y0}=Math,X0=(...n)=>{const t=k(n,"rgb"),e=t[0],s=t[2];let i=1e3,r=4e4;const o=.4;let l;for(;r-i>o;){l=(r+i)*.5;const a=hu(l);a[2]/a[0]>=s/e?r=l:i=l}return Y0(l)};m.prototype.temp=m.prototype.kelvin=m.prototype.temperature=function(){return X0(this._rgb)};const ui=(...n)=>new m(...n,"temp");Object.assign(A,{temp:ui,kelvin:ui,temperature:ui});x.format.temp=x.format.kelvin=x.format.temperature=hu;m.prototype.oklch=function(){return Qc(this._rgb)};const W0=(...n)=>new m(...n,"oklch");Object.assign(A,{oklch:W0});x.format.oklch=tu;x.autodetect.push({p:2,test:(...n)=>{if(n=k(n,"oklch"),T(n)==="array"&&n.length===3)return"oklch"}});Object.assign(A,{analyze:Wc,average:Zw,bezier:s0,blend:St,brewer:R0,Color:m,colors:Ze,contrast:P0,contrastAPCA:V0,cubehelix:b0,deltaE:M0,distance:A0,input:x,interpolate:Je,limits:Zc,mix:Je,random:g0,scale:fs,scales:O0,valid:T0});const _l=42,Z0=["#30123b","#4145ab","#4675ed","#39a2fc","#1bcfd4","#24eca6","#61fc6c","#a4fc3b","#d1e834","#f3c63a","#fe9b2d","#f36315","#d93806","#b11901","#7a0402"],J0=[0,.071,.143,.214,.286,.357,.429,.5,.571,.643,.714,.786,.857,.929,1],pi=(n,t=0)=>Array.isArray(n)?n:Number.isInteger(n)?Array(n+t).fill(n+t-1).map((e,s)=>s/Math.max(e,1)):(console.warn("expected prop to be 'number[]' or 'int'",n),[]),Mi=(n,t)=>((t?1-n:n)*100).toFixed(2)+"%",hi=(n,t,e=t,s=!1)=>[Mi(t),n(s?1-e:e).hex()],Ot=(n,t=!1)=>{if(n===""||n===!0)return!0;if(!n)return;let e=typeof n=="string"||n instanceof String?n.startsWith("[")?JSON.parse(n):n.split(","):Array.isArray(n)?[...n]:[n];return t&&(e=e==null?void 0:e.map(s=>s==""||isNaN(s)?s:+s)),e.length>1?e:e[0]},Q0=n=>{let{colors:t,labels:e,ticks:s,classes:i,vertical:r,reverse:o,flip:l,before:a,after:c,colorReverse:u,colorMode:p,colorGamma:d,colorCorrectLightness:v,colorPadding:b,colorClass:y,centeredEdgeLabels:w}=n;t=Ot(t),e=Ot(e),s=Ot(s,!0),i=Ot(i,!0),b=Ot(b,!0),r=Ot(r),o=Ot(o),l=Ot(l),u=Ot(u),v=Ot(v),e===!0&&(Array.isArray(s)?e=[...s]:Array.isArray(i)&&(e=[...i])),o^r&&(Array.isArray(s)&&(s=s.reverse().map(h=>1-h)),Array.isArray(i)&&(i=i.reverse().map(h=>1-h)));let _=null,q=null,z=null,F=null;i===!0&&(s?i=Array.isArray(s)?s:s-1:Array.isArray(e)?i=e==null?void 0:e.length:Array.isArray(t)&&(i=t==null?void 0:t.length));let $;if(t===!0?$=A.scale(Z0).domain(J0):t===void 0?t=["#fff","#000"]:Array.isArray(t)||(t=A.brewer[t]||["#fff",t]),t!==!0&&o^r&&(t=[...t].reverse()),$=$||A.scale(t),p&&($=$.mode(p)),d&&($=$.gamma(d)),v&&($=$.correctLightness()),b&&($=$.padding(b)),i)switch(y){case"average":$=$.domain([0,1]);break;case"equal":Array.isArray(i)||(i=pi(i,1)),$=$.classes([0,...i,1]);break;default:$=$.classes(i);break}if(a===""&&(a=$(r?1:0).hex()),c===""&&(c=$(r?0:1).hex()),!i||Number(i)<=1)q=Array(_l).fill(_l-1).map((h,f)=>hi($,f/h,f/h,u));else{let h=pi(i,1);if(Array.isArray(h)){let f=h.length-1;q=h.reduce((C,g,L,M)=>{let j=M[L+1],At=(g+j)/2;return L<f&&L&&C.push(hi($,g,At,u)),L<f-1&&C.push(hi($,j,At,u)),C},[]),_=h}}if(s!==void 0){s===!0&&(Array.isArray(_)?s=_:Array.isArray(e)?s=e.length:s=2);let h=pi(s);Array.isArray(h)&&(z=h.map(f=>Mi(f,r)),_=_||h,o^r&&(z=z.reverse()))}if(e!==void 0){if(e===!0)if(_){let f=_.length-(i?1:0);e=Array(f).fill(Math.max(f-1,1)).map((C,g)=>`${parseFloat((g/C).toFixed(2))}`)}else e=["0","1"];Array.isArray(e)||(e=["0",e]),o^r&&Array.isArray(e)&&(e=e.reverse());let h;switch(_&&e.length-_.length){case 0:h=f=>_[f],w=!1;break;case-1:h=f=>(_[f]+_[f+1])/2,w=!0;break;default:e.length>1?(h=f=>f/(e.length-1),w=!1):(h=()=>.5,w=!0);break}F=e.map((f,C)=>[Mi(r?1-h(C):h(C)),f])}return{stops$:q,ticks$:z,labels$:F,before:a,after:c,vertical:r,klass:`dv-sb${a?" b":""}${c?" a":""}${l?" f":""}${r?" v":" h"}${w?" c":""}`}};let tg=0;const eg=bu({props:{colors:{type:[Boolean,String,Array]},labels:{type:[Boolean,String,Array]},ticks:{type:[Boolean,String,Number,Array]},classes:{type:[Boolean,String,Number,Array]},vertical:{type:Boolean},reverse:{type:Boolean},flip:{type:Boolean},before:{type:String},after:{type:String},colorReverse:{type:Boolean},colorMode:{type:String},colorGamma:{type:Number},colorCorrectLightness:{type:Boolean},colorPadding:{type:[String,Number,Array]},colorClass:{type:String},centeredEdgeLabels:{type:Boolean}},setup(n){const t=tg++;return()=>{const{stops$:e,ticks$:s,labels$:i,before:r,after:o,vertical:l,klass:a}=Q0(n);let c=l?1:0,u=l?0:1,p=l?"translate(-1,1) rotate(-90)":"",d=l?"100%":0,v=l?0:"100%";return Tt("svg",{class:a},[Tt("defs",[Tt("line",{id:`tk${t}`,x1:0,xy:0,x2:c,y2:u}),Tt("linearGradient",{id:`lg${t}`,gradientTransform:p},e==null?void 0:e.map(b=>Tt("stop",{offset:b[0],"stop-color":b[1]})))]),r?Tt("rect",{class:"b",fill:r}):null,Tt("rect",{fill:`url('#lg${t}')`,width:d,height:v}),o?Tt("rect",{class:"a",fill:o,y:d,x:v}):null,s==null?void 0:s.map(b=>Tt("use",{href:`#tk${t}`,x:l?0:b,y:l?b:0})),i==null?void 0:i.map(b=>Tt("text",{x:l?null:b[0],y:l?b[0]:null},b[1]))])}}}),wl=fu(eg,[["__scopeId","data-v-ccf85d9f"]]),gl=[50,25,20,10],ng=(n,t,e=5)=>{if(!Number.isInteger(e)||e<3||Number.isNaN(n)||Number.isNaN(t)||n===t)return[];const s=Math.max(3,e);n>t&&([n,t]=[t,n]);let i=Math.pow(10,-Math.floor(Math.log10(t-n))),r=0,o=0,l=0,a,c,u,p;t:do{i*=10;for(const v of gl){if(a=n*i,c=t*i,u=a%v,p=c%v,a-=u?u>0?+u:v+u:0,c+=p?p<0?-p:v-p:0,s<(c-a)/v+1){v==gl[0]&&(i/=10);break t}l=v,r=a,o=c}}while(!0);if(e<3)return l==20&&(o+=10),[r/i,o/i];let d=[];for(let v=r;v<=o;v+=l)d.push(v/i);return d.length>e?(console.warn("precision"),d.filter((v,b)=>!(b%2)||b==d.length-1)):d},sg={class:"row"},ig={id:"sb"},W1=JSON.parse('{"title":"","description":"","frontmatter":{"layout":"home","hero":{"name":"nicetix","text":"for scalebars and graphs"},"features":[{"title":"Usage","details":"The <strong>nicetix</strong> function returns an array of evenly spaced, \\"nice\\" numbers based on a given minimum, maximum, and an upper limit on the number of values you want."},{"title":"Note","details":"The number of values returned may not exactly match the requested number. In some cases, it may be only half of the specified amount, but it will never exceed the requested limit."}]},"headers":[],"relativePath":"index.md","filePath":"index.md"}'),rg={name:"index.md"},Z1=Object.assign(rg,{setup(n){const t=_u("tp"),e=Zr([]),s=Zr([]),i={range:{min:-1.23,max:12.3},num:7},r=()=>{let{range:l,num:a}=i,{min:c,max:u}=l;c>u&&([c,u]=[u,c]);let p=ng(c,u,a),d,v=p[0],b=p[p.length-1],y=b-v;d=[0,(c-v)/y,1-(b-u)/y,1],e.value=p,s.value=d};r();let o=.1;return wu(()=>{const l=new qm({container:t.value});l.registerPlugin(G_);let a=l.addBinding(i,"range",{label:"min / max"}).on("change",({value:c})=>{c.min==c.max?(i.range.max=c.min+o,a.refresh()):r()});l.addBinding(i,"num",{min:3,max:30,step:1}).on("change",r)}),(l,a)=>(yu(),gu("div",null,[a[0]||(a[0]=Cu(`<div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nicetix</span></span></code></pre></div><div class="language-JS vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">JS</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nicetix </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;nicetix&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// nicetix(min, max, &lt;num = 5&gt;)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ticks </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> nicetix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.23</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//-&gt; [-2.5, 0, 2.5, 5, 7.5, 10, 12.5]</span></span></code></pre></div>`,2)),Oe("div",sg,[Oe("div",{id:"tp",ref_key:"tp",ref:t},null,512),Oe("div",ig,[Jr(Qr(wl),{id:"sb0",colors:"hotpink,#8888,hotpink",classes:s.value,labels:",min,max,",ticks:""},null,8,["classes"]),Jr(Qr(wl),{id:"sb1",colors:"transparent,transparent",labels:e.value,ticks:""},null,8,["labels"])])]),a[1]||(a[1]=Oe("p",null,[Oe("small",null,[to("(The scalebar in this example was created with "),Oe("a",{href:"https://dv-scalebar.js.org/",target:"_blank",rel:"noreferrer"},"dv-scalebar"),to(", a versatile framework-agnostic scalebar component)")])],-1))]))}});export{W1 as __pageData,Z1 as default};
